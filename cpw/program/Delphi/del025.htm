<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="Del_idx.htm">DELPHI</a></b></span></td>    
  </tr>    
</table>    
</center></div><div align="center"><center>    
    
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"    
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">    
  <tr>    
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"    
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"    
    bordercolordark="#FFFFFF">    
      <tr>    
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font    
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"    
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>    
      </tr>    
    </table>    
      <p align="center">如何在Delphi4 BDE中配置Access数据库&nbsp;<br>
      <br>
                              (福建　许晓明)    
      <p><br>
      <br>
      　　在使用Netscape的navigator时不知你有没有注意到:在它的状态栏有一组按钮，这使我们能很方便地打开另一个窗体，更有效地利用时间(要知道网上冲浪时间就是金钱啊!)。<br>
      　　接下来我要讲的是如何在我们的程序中加入此功能，我们可以用DELPHI很轻易地实现，在DELPHI中我们可以指定某个Twincontrol类(如Ttoolbar)的父级为另一个Twincontrol(这里是Tstatusbar)，然后通过动态创建Ttoolbar就可以在Tstarbar上创建TToolbar了，并且为工具条(Toolbar)添加按钮及其事件，通过调用API中的winexec实现对Window的应用程序的调用。下面给出了详细的代码和注释给大家分享。<br>
      　　unit superbar;<br> 
      　　interface<br>
      　　uses<br>
      　　 Windows， Messages， SysUtils， Classes， Graphics， Controls， Forms，&nbsp;<br>
      Dialogs，ComCtrls;<br>
      　　type<br>
      　　 TForm1 = class(TForm)<br> 
      　　 StatusBar1: TStatusBar;{为窗体添加一个状态栏}<br> 
      　　 procedure FormCreate(Sender: TObject);<br> 
      　　 private<br> 
      　　 {声明以下过程}<br> 
      　　 procedure createsuperbar(sender:Tobject;Imagelist:TImagelist);<br> 
      　　 {创建工具条}<br> 
      　　 procedure createbutton(toolbar:TToolbar;Const ButtonCaptions: array of String);<br> 
      　　 {创建工具条的按钮}<br> 
      　　 procedure superbuttonclick(sender:Tobject);<br> 
      　　 {为工具条按钮添加事件}<br> 
      　　 public<br> 
      　　 end;<br> 
      　　var<br>
      　　 Form1: TForm1;<br> 
      　　 toolbar:TToolbar;<br> 
      　　implementation<br>
      　　uses shellapi，commctrl;{注意要加入此句，否则程序运行无法通过}<br> 
      　　{＄R ＊.DFM}<br> 
      　　procedure TForm1.createsuperbar(sender:Tobject;Imagelist:Timagelist);<br> 
      　　begin<br>
      　　 toolbar:=TToolbar.Create(self);{动态创建一个工具条}<br> 
      　　 with toolbar do<br> 
      　　 begin<br> 
      　　 parent:=statusbar1;{定义toolbar的父类为状态栏，这样就可以创建出状态栏的工具条了}<br> 
      　　 top:=1;left:=1;height:=18;<br> 
      　　 buttonheight:=16;buttonwidth:=16;{定出toolbar和toolbutton的宽度长度};<br> 
      　　 flat:=true;autosize:=true; {设置toolbutton为浮动形式}<br> 
      　　 images:=imagelist;{设置toolbutton的图标}<br> 
      　　 {使工具条可以脱离状态栏.注意:如果你用的是DELPHI3.0需删除此两句，即可用}<br> 
      　　 dragkind:=dkdock;<br> 
      　　 dragmode:=dmautomatic;<br> 
      　　 end;<br> 
      　　end;<br>
      　　procedure TForm1.createbutton(Toolbar:TToolbar;Const ButtonCaptions: array of String);<br> 
      　　var<br>
      　　 I，m: Integer;<br> 
      　　begin<br>
      　　 m:=0;<br> 
      　　 for I := 0 to High(ButtonCaptions) do<br> 
      　　 begin<br> 
      　　 with TToolButton.Create(ToolBar) do<br> 
      　　 begin<br> 
      　　 Parent := ToolBar;<br> 
      　　 Caption := ButtonCaptions[I];<br> 
      　　 onclick:=superbuttonclick;{为toolbutton增加鼠标click事件}<br> 
      　　 if (ButtonCaptions[I]=‘|’) then{判断是不是分隔符}<br> 
      　　 begin<br> 
      　　 Style := tbsSeparator;<br> 
      　　 m:=m＋1;<br> 
      　　 end<br> 
      　　 else<br> 
      　　 begin<br> 
      　　 Style := tbsButton;<br> 
      　　 imageindex:=i－m;<br> 
      　　 end;<br> 
      　　 end;<br> 
      　　 end;<br> 
      　　end;<br>
      　　{这里是响应鼠标事件，实现应用程序的打开}<br>
      　　procedure TForm1.superbuttonclick(sender:Tobject);<br> 
      　　begin<br>
      　　winexec(pchar((sender as TToolbutton).caption)，SW_ShowNormal);<br> 
      {打开一个Windows的应用程序}<br> 
      　　end;<br>
      　　procedure TForm1.FormCreate(Sender: TObject);<br> 
      　　const<br>
      　　 ExeList:array[0..2] of String=(<br> 
      　　 ‘winfile.exe’，<br> 
      　　 ‘|’，<br> 
      　　 ‘notepad.exe’);{可以在这里加上其它应用程序的全称，也可以不要分隔符}<br> 
      　　var<br>
      　　 imagelist:Timagelist;<br> 
      　　 i:integer;<br> 
      　　begin<br>
      　　 imagelist:=Timagelist.Create(self);<br> 
      　　 try{加入安全代码，也可不加}<br> 
      　　 for i:=0 to high(exelist) do<br> 
      　　 if exelist[i] &lt;> ‘|’ then<br> 
      　　 begin<br> 
      　　ImageList_AddIcon(ImageList.Handle，ExtractIcon(Handle，PChar(ExeList[i])，0));<br>
      {为imagelist添加图标}<br>
      　　 end;<br> 
      　　 createsuperbar(self，imagelist);<br> 
      　　 createbutton(toolbar，exelist);<br> 
      　　 finally<br> 
      　　 end;<br> 
      　　end;<br>
      　　end.<br>
      　　以上程序已在Pentium－MMX166 32M Windows 98 DELPHI 4.0 通过，小弟反复测试没有问题，才斗胆拿出来与大家分享，如有问题望广大Delphi迷能给小弟多提意见，在下将翘首期待你的来信。     
    </td>     
  </tr>     
</table>     
</center></div>     
 
</body> 
 
</html> 
