<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="Del_idx.htm">DELPHI</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">用DELPHI实现菜单的汉化<br>
      <br>
                        嘉峪关市计算机站  王润德       
      <p><br> 
      ---- 现 在 我 们 经 常 看 到 一 些 软 件 汉 化 包， 例 ‘ 晴 窗 伴 侣’ 
      是PHOTOSHOP 的 汉 化 包， 其 实 我 们 只 要 对WINDOWS 的 编 程 熟 悉， 
      也 可 以 自 己 编 写 某 些软 件 的 汉 化 包。 这 样 不 管 软 件 大 小， 只 要 你 喜 欢 就 可 以&nbsp;<br>
      给 做 一 个 汉 化 包。 下 面 的 程 序 是 一 些 主 要 的 步 骤。 其 实 
      你 还 可 以 用 别 的 方 法 来 实 现， 亲 自 试 试 吧。&nbsp;<br>
      <br>
      ---- 在 运 行 程 序 之 前 首 先 生 成 一 个 中 英 文 菜 单 对 照 表 文件， 产 生 时 可 以 参 照 该 程 序 自 己 编 制 一 个 获 得 系 统 的 原 
      菜 单 内 容 的 程 序， 然 后 在 之 后 输 入 菜 单 的 汉 字 内 容。 其&nbsp;<br>
      格 式 如 下：&nbsp;<br>
      <br>
      SAVE AS 保存到....<br> 
      . .<br> 
      ..<br> 
      EXIT 退出系统<br> 
      // 程序开始<br> 
      unit wrdxt;<br> 
      <br> 
      interface<br> 
      <br> 
      uses<br> 
      Windows, Messages, SysUtils, Classes,<br> 
      Graphics, Controls, Forms, Dialogs,<br> 
      StdCtrls;<br> 
      <br> 
      type<br> 
      TForm1 = class(TForm)<br> 
      Button1: TButton;<br> 
      ListBox1: TListBox;<br> 
      ListBox2: TListBox;<br> 
      procedure Button1Click(Sender: TObject);<br> 
      procedure FormActivate(Sender: TObject);<br> 
      private<br> 
      { Private declarations }<br> 
      public<br> 
      { Public declarations }<br> 
      end;<br> 
      var<br> 
      Form1: TForm1;<br> 
      childmenu,mainmenu,c2menu:hmenu;<br> 
      wndhandle:hwnd;<br> 
      mystr:pchar;<br> 
      mainnum,childNUM,c2num:integer;<br> 
      MYCHAR:STRING;<br> 
      mm3,mm6:string[19];<br> 
      mm4,mm5:string;<br> 
      implementation<br> 
      <br> 
      {$R *.DFM}<br> 
      //我用表单的CLICK事件激活，<br> 
      其实用ACTIVE事件会更好<br> 
      procedure TForm1.Button1Click(Sender: TObject);<br> 
      var<br> 
      start1,start2,start3,start4,start5:integer;<br> 
      <br> 
      begin<br> 
      //通过标题获得窗口句柄<br> 
      wndhandle:=findwindow(nil,mystr);<br> 
      //通过标题获得菜单句柄<br> 
      mainmenu:=getmenu(wndhandle);<br> 
      //取得顶行菜单数<br> 
      mainnum:=getmenuitemcount(mainmenu);<br> 
      //汉化菜单<br> 
      for start1:=0 to mainnum do<br> 
      begin<br> 
      mm5:=``;<br> 
      //取得菜单项的标题<br> 
      getmenustring(mainmenu,start1,PCHAR<br> 
      (myChAR),20,MF_BYPOSITION);<br> 
      mm6:=string(pchar(mychar));<br> 
      for start3:=0 to listbox1.items.count-1 do<br> 
      begin<br> 
      mm4:=listbox1.Items[start3];<br> 
      mm3:= mm4;<br> 
      if (string(mm6)=trim(mm3)) then<br> 
      begin<br> 
      for start4:=21 to length(mm4) do<br> 
      begin<br> 
      mm5:=mm5+mm4[start4];<br> 
      end;<br> 
      end;<br> 
      end;<br> 
      if mm5&lt;>`` then<br> 
      modifymenu(mainmenu,start1,MF_BYPOSITION,<br> 
      getmenuitemid(mainmenu,start1),pchar(mm5));<br> 
      childmenu:=getsubmenu(MAINMENU,start1);<br> 
      childnum:=getmenuitemcount(childmenu);<br> 
      //汉化下拉菜单<br> 
      for start2:=0 to childnum do<br> 
      begin<br> 
      mm5:=``;<br> 
      getmenustring(childmenu,start2,PCHAR<br> 
      (mychar),20,MF_BYPOSITION);<br> 
      mm6:=string(pchar(mychar));<br> 
      for start3:=0 to listbox1.items.count-1 do<br> 
      begin<br> 
      mm4:=listbox1.Items[start3];<br> 
      mm3:= mm4;<br> 
      if (string(mm6)=trim(mm3)) then<br> 
      begin<br> 
      for start4:=21 to length(mm4) do<br> 
      begin<br> 
      mm5:=mm5+mm4[start4];<br> 
      end;<br> 
      end;<br> 
      end;<br> 
      if mm5&lt;>`` then<br> 
      <br> 
      modifymenu(childmenu,start2,MF_BYPOSITION,<br> 
      getmenuitemid(childmenu,start2),pchar(mm5));<br> 
      c2menu:=getsubmenu(childMENU,start2);<br> 
      c2num:=getmenuitemcount(c2menu);<br> 
      for start5:=0 to c2num do<br> 
      begin<br> 
      mm5:=``;<br> 
      getmenustring(c2menu,start5,PCHAR<br> 
      (mychar),20,MF_BYPOSITION);<br> 
      mm6:=string(pchar(mychar));<br> 
      for start3:=0 to listbox1.items.count-1 do<br> 
      begin<br> 
      <br> 
      mm4:=listbox1.Items[start3];<br> 
      mm3:= mm4;<br> 
      if (string(mm6)=trim(mm3)) then<br> 
      begin<br> 
      for start4:=21 to length(mm4) do<br> 
      begin<br> 
      mm5:=mm5+mm4[start4];<br> 
      end;<br> 
      end;<br> 
      end;<br> 
      if mm5&lt;>`` then<br> 
      modifymenu(c2menu,start5,MF_BYPOSITION,<br> 
      getmenuitemid(c2menu,start5),pchar(mm5));<br> 
      END;<br> 
      <br> 
      END;<br> 
      end;<br> 
      <br> 
      end;<br> 
      <br> 
      procedure TForm1.FormActivate(Sender: TObject);<br> 
      begin<br> 
      //要汉化的系统的窗口标题<br> 
      //mystr:=`adobe photoshop`;<br> 
      mystr:=`frontpage explorer`;<br> 
      mychar:=` `;<br> 
      //装入已编辑好的中英文菜单对照文件<br> 
      listbox1.items.loadfromfile(`myfile2.txt`);<br> 
      end;<br> 
      <br> 
      end.      
    </td>      
  </tr>      
</table>      
</center></div>      
<p>　</p> 
 
</body> 
 
</html> 
