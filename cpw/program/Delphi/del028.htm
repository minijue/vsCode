<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="Del_idx.htm">DELPHI</a></b></span></td>     
  </tr>     
</table>     
</center></div><div align="center"><center>     
     
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"     
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">     
  <tr>     
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"     
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"     
    bordercolordark="#FFFFFF">     
      <tr>     
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font     
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"     
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>     
      </tr>     
    </table>     
      <p align="center">自己编程实现对CIH病毒的预防<br>
      <br>
                                 (北京　愚夫)&nbsp;    
      <p><br>
      　　席卷全球的CIH病毒以其巨大的破坏性，使人谈“C”色变。由于该病毒直接威胁到大家爱“鸡”的“人身”（硬件）安全，于是乎有钱的纷纷“出血”购买以前不屑一顾的正版杀毒软件，而没钱的也不敢再相信D版，老老实实地跳过每月的26日，或者干脆停机不用，本人就是属于后者的“停机一族”。可是由于我向来是“只记星期不记日”，以致数次都是与“死亡”擦肩而过。于是就用Delphi写了下面的小程序，以便提醒我更改日期，保护我爱“鸡”的生命安全。<br>
      　　1.启动Delphi，新建一个工程，命名为cih.dpr。在空白窗体上添加三个StaticText标签、一个Label标签和一个按钮(Button)。它们的属性如下表：<br>
      　　对于文本标签可以改变其Font属性，使其色彩醒目。<br>
      　　2.添加一个TTimer控件，用以起到文字闪烁效果（此项可选）。其属性如下：<br>
      　　控件 Name Enabled Interval<br> 
      　　Timer1 Timer1 False 500<br> 
      　　以下是程序实现部分：<br>
      　　unit Unit1;<br> 
      　　interface<br>
      　　uses Windows，Messages，SysUtils，Classes，Graphics，Controls，Forms，<br> 
     Dialogs，StdCtrls， ExtCtrls， ComCtrls;<br> 
      　　type<br>
      　　 TForm1 = class(TForm)<br> 
      　　 laDate: TLabel;<br> 
      　　 Timer1: TTimer;<br> 
      　　 StaticText1: TStaticText;<br> 
      　　 StaticText2: TStaticText;<br> 
      　　 StaticText3: TStaticText;<br> 
      　　 btExit: TButton;<br> 
      　　　procedure FormCreate(Sender: TObject);<br> 
      　　　procedure Timer1Timer(Sender: TObject);<br> 
      　　 procedure FormShow(Sender: TObject);<br> 
      　　　procedure btExitClick(Sender: TObject);<br> 
      　　 private<br> 
      　　 { Private declarations }<br> 
      　　 public<br> 
      　　 { Public declarations }<br> 
      　　 end;<br> 
      　　const<br>
      　　 CIH_PREDATE=25; //定义为CIH病毒发作日期的前一天<br> 
      　　var<br>
      　　 Form1: TForm1;<br> 
      　　 CanSee :Boolean; //“Warning”是否可见<br> 
      　　 CanCloseForm :Boolean; //程序是否可以中止<br> 
      　　implementation<br>
      　　{＄R ＊.DFM}<br> 
      　　procedure Form1.FormCreate(Sender: TObject);<br> 
      　　var<br>
      　　 Today :string;<br> 
      　　 Day :string[2];<br> 
      　　begin<br>
      　　 Today :=DateTimeToStr(Date); //获取当前日期<br> 
      　　 Day :=Copy(Today，Length(Today)－1，2); //提取当前日期中的天数<br> 
      　　 if StrToInt(Day)=CIH_DATE then<br> 
      　　 begin<br> 
      　　 CanCloseForm :=False;<br> 
      　　 CanSee :=True;<br> 
      　　 Timer1.Enabled :=True;<br> 
      　　 laDate.Caption :=Today;<br> 
      　　 end<br> 
      　　 else<br> 
      　　 CanCloseForm :=True;<br> 
      　　end;<br>
      　　procedure TForm1.Timer1Timer(Sender: TObject);<br> 
      　　begin<br>
      　　 if CanSee then<br> 
      　　 begin<br> 
      　　 StaticText3.Visible :=False;<br> 
      　　 CanSee :=False;<br> 
      　　 end else<br> 
      　　 begin<br> 
      　　 StaticText3.Visible :=True;<br> 
      　　 CanSee :=True;<br> 
      　　 end;<br> 
      　　end;<br>
      　　procedure TForm1.FormShow(Sender: TObject);<br> 
      　　begin<br>
      　　 if CanCloseForm then Close; //不是25日，则中止程序运行<br> 
      　　end;<br>
      　　procedure TForm1.btExitClick(Sender: TObject);<br> 
      　　begin Close;<br> 
      　　end;<br>
      　　end.<br>
      　　此程序经过编译之后，生成名为cih.exe的可执行文件。手工将它加入Windows“开始”菜单的启动组，每次开机时程序就自动执行，只要到了每月的25日，就会提醒你更改日期，否则结束运行，并不驻留内存和占用系统资源。有兴趣的朋友也可以再添加一个按钮，直接更改日期，笔者在此就不详细讨论了。欢迎您来信与我交流，我的Email地址是：zhangzhen@263.net。<br>
      　　<br>
      　　控件 Name Caption Left Top　Width Height&nbsp;<br>
      　　Form1 Form1 当心CIH病毒!!!　缺省 缺省　383 254<br> 
      　　StaticText1 StaticText1 今天是： 　80 88　　缺省 缺省<br> 
      　　StaticText2 StaticText2 当心 CIH 病毒!!!　40 120　 缺省 缺省<br> 
      　　StaticText3 StaticText3 Warning!!! 　48 8 缺省 缺省<br> 
      　　Label1 laDate CIH(任意) 　192 82 缺省 缺省<br> 
      　　Button1 btExit 退出 　200 184 缺省 缺省     
    </td>     
  </tr>     
</table>     
</center></div>     
<p><br> 
</p> 
 
</body> 
 
</html> 
