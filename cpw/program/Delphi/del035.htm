<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="Del_idx.htm">DELPHI</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">用Delphi编写打印程序的窍门<br>
      <br>
                                (湖北　杨德军)      
      <p><br>
      &nbsp;&nbsp;&nbsp; 如果你想自己用Delphi编写一个打印程序，那么，下面这些技巧或许对你有所帮助。<br>
      　　1.获取、显示当前打印机的分辨率<br>
      　　Windows下的打印分辨对打印程序有着至关重要的作用，如果你想知道打印机的分辨率，请在程序中加入一行：<br>
      　　ShowMessage(′水平分辨率′＋inttostr(GetDeviceCaps(printer<br>
     Handle,LOGPIXELSX))＋chr(13)＋′垂直分辨率:′＋<br>
     inttostr(GetDeviceCaps(printerHandle,LOGPIXELSY)));<br>
      　　结果就一目了然了。<br>
      　　2.将结果直接送到打印机<br>
      　　Delphi提供了两种打印方式：一是将结果输送到Form，再调用Form的print方法将结果输送到打印机，二是将结果直接输送到打印机。如果你采用第一种方式，则无论你怎样调整Form的PrintScal属性，打印出来的东西也不会让你满意。因此建议采用第二种方式。<br>
      　　3.尽量不要使用AssignPrn<br>
      　　尽管AssignPrn简化了文本打印操作，使输出到打印机像输出到文件一样简单。但简单带来的是一系列的不方便：你无法知道当前打印的行数，无法准确控制行距，无法灵活改变字体字形等等。还是用打印机的Canvas属性进行打印吧。<br>
      　　4.用打印机的点数做度量单位<br>
      　　如果想让打印程序在任何打印机上都能正常地打印，你就必须改变你的度量单位。如果采用固定的度量，不同分辨率的打印效果是不同的。举例来讲：printerCanvasrectangle(0,0,360,720)在360×360的佳能4200SP上能打出一个1英寸宽、2英寸高的矩形，但在600×600的惠普6L上只能打出0.6英寸宽、1.2英寸高的矩形。使用打印机的点数做为度量单位是一个明智的选择。具体做法如下：<br>
      　　Var PointX,PointY:integer;<br> 
      　　PointX:=GetDeviceCaps(printerHandle,LOGPIXELSX);<br>
      　　PointY:=GetDeviceCaps(printerHandle,LOGPIXELSX);<br>
      　　printerCanvasrectangle(0,0,PointX＊1,PointY＊2)<br>
      　　这样，无论你使用什么样的打印机，都能得到一个1英寸宽、2英寸高的矩形。<br>
      　　5.添加打印程序单元<br>
      　　尽管Delphi在生成窗体时会自动在USES部分加入许多程序单元，但打印程序单元(Printers)却不在之列，要想使打印机正常工作和程序不出错，你还是老老实实手工给它加上吧。　　     
    </td>     
  </tr>     
</table>     
</center></div>     
<p>　</p>

</body>

</html>
