<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>用Delphi制作动态菜单</title>
</head>

<body>

<table border="0" width="100%" bgcolor="#E8E8E8" style="font-size: 9pt">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2" bgcolor="#4264B5">
      <tr>
        <td width="100%"><p align="center"><font color="#FFFFFF">资料整理<span class="f">&middot;</span><a
        href="http://fasoft.yeah.net" target="_blank" style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<table border="0" width="100%">
      <tr>
        <td width="100%"></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><strong><span class="title">用Delphi制作动态菜单</span></strong></td>
  </tr>
  <tr>
    <td width="100%"></td>
  </tr>
  <tr>
    <td>　　所谓动态菜单是指菜单项随着程序的操作变化而变化。现在，我们用Delphi来实现这一功能，具体步骤如下：<br>
    　　1．首先，确定动态菜单的数据来源，即要确定动态菜单标题是来自Windows的系统注册表，还是来自一个数据库，或者是来自一个子目录，主要由程序的功能而定。这里假设主窗口名为MainForm，上面已有主菜单，其动态菜单的数据源是一个String（字符串）类型的变量，名称为SubMenuItemSource。<br>
    　　2．确定生成的动态菜单的功能，即定义动态菜单的OnClick()事件，例如，动态菜单标题来自一个磁盘文件名时，那么程序在响应OnClick()事件时，可能的操作是要打开选中的文件。因此，对菜单所在的主窗口模块的单元程序的数，据我们需要定义Type后添加一个自定义的事件MyClick()。 
    <br>
    　　然后，需要编写如下MyClick（）事件的具体内容：<br>
    　　procedure TMainForm.MyClick(Sender: TObject);//动态菜单OnClick事件响应<br>
    　　begin <br>
    　　Show.Message(TMenuItem(Sender).Caption)；//显示选中的动态菜单标题,<br>
    　　end; <br>
    　　这里调用的ShowMessage标准例程(在Dialogs.pas中)显示TMenuItem(Sender).Caption，它就是选择的菜单项的Caption，类似用TMenuItem(Sender).Name则是选择菜单项的Name。<br>
    　　3.编写程序将动态菜单标题添加到指定的菜单顶下，并将其与OnClick()事件联系起来。将以下程序段添加到MainForm的OnCreate事件过程中，可在程序启动时完成动态菜单的动态生成：<br>
    　　procedure TMainForm.FormCreate(Sender: TObject);<br>
    　　var <br>
    　　addSubItem:TMenuItem;<br>
    　　i:Integer;<br>
    　　begin <br>
    　　for i:=0 to N do //N等于要添加的动态菜单数目,需事先定义为数值型变量,并赋值 
    <br>
    　　begin <br>
    　　addSubItem:= TMenuItem.Create(Self); <br>
    　　addSubItem.Name := ′A′＋IntToStr(i); <br>
    　　addSubItem.Caption := SubMenuItemSource; // 步骤1的SubMenuItemSource应先赋值<br>
    　　FileOpenItem.Add(addSubItem); //在名称为FileOpenItem的菜单项下添加子菜单<br>
    　　addSubItem.OnClick:=MyClick; // 步骤2的MyClick(),自定义菜单要响应的事件 
    <br>
    　　end<br>
    　　end；<br>
    <b>(李晓方)</b></td>
  </tr>
  <tr>
    <td width="100%"><hr>
    </td>
  </tr>
  <tr>
    <td width="100%">中国程序员网站版权所有</td>
  </tr>
</table>

<p><br>
</p>
</body>
</html>
