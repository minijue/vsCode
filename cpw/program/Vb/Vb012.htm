<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>VB编程问与答</title>
<link rel="stylesheet" href="my.css"
tppabs="http://person.zj.cninfo.net/~lifu/images/my.css">
</head>

<body bgcolor="#FFFFFF">

<table border="0" cellspacing="2" cellpadding="0" bordercolor="#DED8CD" width="100%">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是：<a href="Vb_idx.htm"
    tppabs="http://person.zj.cninfo.net/~lifu/index.html">Visual Basic</a> <b>&gt;</b> VB编程问与答</span></td>
  </tr>
  <tr>
    <td><span style="font-size: 9pt"></span></td>
  </tr>
</table>

<table border="0" width="100%" bgcolor="#E8E8E8" style="font-size: 9pt">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<table border="0" width="100%">
      <tr>
        <td width="100%"></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><strong><span style="font-size: 9pt">VB编程问与答</span></strong></td>
  </tr>
  <tr>
    <td width="100%"></td>
  </tr>
  <tr>
    <td><span style="font-size: 9pt"><font face="宋体"><strong>1．如何让文本框只接受数字？<br>
    </strong>答：使用如下代码，在文本框的按键事件中加入：<br>
    Private Sub Textl_KeyPress（KeyAscii As Integer）<br>
    If keyAscii&gt;=33 Then<br>
    If KeyAscii<=vbkey9 And KeyAscii>=vbKey0 Then <br>
    Else '把KeyAscii设为0就是取消输 入。 <br>
    KeyAscii=0 <br>
    MsgBox ”不要输入数字！” <br>
    End If <br>
    End If <br>
    End Sub <br>
    注意：KeyAscii键值与KeyCode 相同，我们可以查看KeyCode值，不 过有些KeyCode键值必须在 
    KeyDown和KeyUp中才有效，在 KeyPress的KeyAscii中没用。利用 KeyAscii=0的方式在KeyPress中有 
    用，但在KeyDown中让KeyCode=0 就不行了。 <br>
    <strong>2．VB中的进制转换是怎样的？ <br>
    </strong>答：用函数Oct()将十进制位数 转换为八进制，用Hex（）将十进制位 
    数转换为十六进制，不过值得注意的 
    是转换后数字型变为字符型。如果是 
    一个变量我们可以用如下代码完成十 进制向其他进制转换的目的。 <br>
    dim ANum as long <br>
    ANum＝&amp; 010 '＆0是八进制的 表示符号ANum自行转换为8。 <br>
    ANum＝＆HA '＆H是十六进制的 表示符号ANum自行转换为10。 <br>
    如果我们有一个字符变量Astring 为八进制的或十六进制的，用ANum=” 
    ＆0” ＋ Astring和ANum＝“＆H”＋Astring 能将它转换为十进制。 <br>
    VB中我没有找到二进制的转换函 
    数，用如下代码可以实现十进制到二进 制的转换。 <br>
    Option Explicit <br>
    Ptivate FunctiOn TenturnTwo (ByVal varNum As Long） <br>
    Dim returnString As String，ModNum As Integer <br>
    DO While varNum&gt;0 <br>
    ModNum=varNum Mod 2 <br>
    varNum=varNum\2 <br>
    returnString＝Trim（Str （ModNum））+returnString <br>
    Loop <br>
    TenturnTwo=returnString <br>
    End Function <br>
    Private Function TwoturnTen （ByVal varString As String） <br>
    Dim Slen As Long，I As Long， <br>
    returnNum As Long <br>
    SLen=Len(varString) <br>
    For I=o To SLen-1 <br>
    returmNum＝returnNum ＋Val（Mid (varString，I＋1，1））*（2^（Slen-I-1)) <br>
    Next <br>
    TWoturnTen=returnNum <br>
    End Function <br>
    <strong>3．在VB5.0下，如何用程序改 变中文与英文的输入方式？ <br>
    </strong>答：VB5.0在可以输入文字的地 方（如TextBox，ListBox，ComBox... 
    等）有一个输入法切换属性IMEMode。我 们可以先用ImeStatus函数来检测当前的 
    输入状态，并用IMEMode来控制其输入 状态。 下面是IMEMode的属性值。 <br>
    Text1.IMEMode＝0（预定值） <br>
    Text1.IMEMode＝l（切换为中文输 入） <br>
    Text1.IMEMde＝2（切换为英文输 入、 <br>
    Text1.IMEMde＝3（关闭中文输入 的功能，也就是只能做英文输入。） </font></span></td>
  </tr>
  <tr>
    <td width="100%"><hr>
    </td>
  </tr>
  <tr>
    <td width="100%">中国程序员网站版权所有</td>
  </tr>
</table>

<p><br>
<br>
</p>
</body>
</html>
