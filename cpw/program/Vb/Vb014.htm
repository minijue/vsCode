<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>多姿多彩的进度指示控件</title>
<link rel="stylesheet" href="my.css"
tppabs="http://person.zj.cninfo.net/~lifu/images/my.css">
</head>

<body style="font-size: 9pt" bgcolor="#FFFFFF">

<table border="0" cellspacing="2" cellpadding="0" bordercolor="#DED8CD" width="100%">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是：<a href="Vb_idx.htm"
    tppabs="http://person.zj.cninfo.net/~lifu/index.html">Visual Basic</a> <b>&gt;</b> 
    多姿多彩的进度指示控件</span></td>
  </tr>
  <tr>
    <td><span style="font-size: 9pt"></span></td>
  </tr>
</table>

<table border="0" width="100%" bgcolor="#E8E8E8">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><table border="0" width="100%">
      <tr>
        <td width="100%"></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><strong><span style="font-size: 9pt">多姿多彩的进度指示控件</span></strong></td>
  </tr>
  <tr>
    <td width="100%"></td>
  </tr>
  <tr>
    <td style="font-size: 9pt">在Win95盛行的今天，我们随处可以看见各种进程指示控件的身影，这些进程指示控件被广泛用于各种不同的场合。如果我们能在自己的程序中灵活使用各种进程指示控件，一定会为程序增添许多生机和活力。 
    <br>
    &nbsp;&nbsp; 下面笔者以Visual Basic为例，向大家介绍几种常 
    用的进程指示控件。 <br>
    <strong>一、进度条控件（ProgressBar） </strong><br>
    &nbsp;&nbsp; 进度条控件是一种极其常见的Win95风格的进 
    度指示控件，广泛用于各种Win95程序。它一般用在 
    需要较长处理时间的场合，如在程序加载数据、更新系 
    统、检查硬件时，用本控件提示用户程序正在工作、 <br>
    &nbsp;&nbsp; 进度条控件的重要属性有：Min（最小值）、Max（最 
    大值）、Value（当前值）。 <br>
    <strong>二、滑片控件（Slider） </strong><br>
    &nbsp;&nbsp; 滑片控件最大的特点是可以很方便地进行手工拖 
    动重定位，这种特性决定了它主要用于交互性较强的 
    场合，如著名的软解压软件XingMPEG Player就使用 
    滑片控件来进行播放控制，它一面用来显示播放进度， 
    同时用户还可通过拖动滑片来选择适当的投放位置。 另外，win95本身也大量使用了这种控件，如“控制面 
    板”中的“鼠标”和“键盘”等。 <br>
    &nbsp;&nbsp; 滑片控件的重要属性有：Min（最小值）、Max（最大 值）、SmallChange（最小变化值）、LargeChange（最大变 
    化值）、Orientation（方向）、TickStyle（标尺和滑片风 格）、TickFrequency（标尺间隔）和Value（当前值）等，其 
    中Orientation（取值为0或1）决定了滑片控件是水平 
    显示还是竖直显示，TickStyle（取值从1到4）可以控制 
    滑片的形状、是否显示标尺及标尺的位置。 <br>
    <strong>三、3D面板控件（SSPanel） </strong><br>
    &nbsp;&nbsp; 3D面板控件是另一种常见的进度指示控件，其最 
    大的物点是除了*以用进度条表示进度情况外，还可以 
    准确地显示出进度百分比。由于有了这种特性，3D 
    面板控件经常被用于各种安装程序，使用户可以清楚 
    地了解软件安装的进展情况。 <br>
    &nbsp;&nbsp; 值得一提的是，3D面板控件还有一个非常有趣的 
    特性，即进度条的滚动方向有上--&gt;下、下--&gt;上、左--&gt;右、右--&gt;左四种，甚至可以以同心圆的方式从里向外滚 
    动。 <br>
    &nbsp;&nbsp; 3D面板控件的主要瞩性有：FloodType（滚动类 型）、FloodPercent（进度百分比）、FloodshowPct（是否显示进度百分比）等，其中FloodType（取值从1到5）决 
    定了进度条的滚动方向。 <br>
    <strong>四、程序举例 </strong><br>
    &nbsp;&nbsp; 上面我们简单介绍了三种不同风格的进程指示控 
    件各自的特点，下面我们以一个具体的例子来演示它 们的用法。 <br>
    1．窗体设计 <br>
    新建一个普通窗体，在其中放置一个进度条控件、 
    一个滑片控件、一个3D面板控件和一个Timer控件， 
    主要的属性设置如下：<div align="center"><center><table border="1"
    cellspacing="0" cellpadding="0" bordercolor="#000000" style="font-size: 9pt">
      <tr>
        <td width="33%" align="center"><strong>控件名称</strong></td>
        <td width="33%" align="center"><strong>主要属性</strong></td>
        <td width="34%" align="center"><strong>属性值</strong></td>
      </tr>
      <tr>
        <td width="33%" align="center" style="font-size: 11pt">Slider1</td>
        <td width="33%" align="center" style="font-size: 11pt">TickStyle<br>
        Orientation<br>
        Maz<br>
        Min<br>
        Value</td>
        <td width="34%" align="center" style="font-size: 11pt">0-sldBoth<br>
        0-sldHorizontal<br>
        5<br>
        100<br>
        0<br>
        0</td>
      </tr>
      <tr>
        <td width="33%" align="center" style="font-size: 11pt">ProgressBar1</td>
        <td width="33%" align="center" style="font-size: 11pt">Maz<br>
        Min<br>
        Value</td>
        <td width="34%" align="center" style="font-size: 11pt">100<br>
        0<br>
        0</td>
      </tr>
      <tr>
        <td width="33%" align="center" style="font-size: 11pt">Panel3dl</td>
        <td width="33%" align="center" style="font-size: 11pt">FloodShowPct<br>
        FloodType<br>
        FloodPercent</td>
        <td width="34%" align="center" style="font-size: 11pt">True<br>
        1-LeftToRight<br>
        0</td>
      </tr>
      <tr>
        <td width="33%" align="center" style="font-size: 11pt">Timer1</td>
        <td width="33%" align="center" style="font-size: 11pt">Interval</td>
        <td width="34%" align="center" style="font-size: 11pt">200</td>
      </tr>
    </table>
    </center></div><p>2．代码 <br>
    &nbsp;&nbsp; 在Time1的Timer事件中编写如下代码： <br>
    Private Sub Timer1_Timer() <br>
    If ProgressBar1.Value=100 Then <br>
    &nbsp; '当进度条到最右边后，改变滑片控件与3D面板控件的风格 <br>
    &nbsp; with Sliderl <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '滑片风格从0到3变化<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If .TickStyle &lt;3 then <3 Then <br> <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .TickStyle=.TickStyle+1 <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .TickStyle = 0 <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '当风格变为0时改变水平（竖直）方向 
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Orientation=.Orientation Xor l <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If <br>
    &nbsp; End With <br>
    &nbsp; With Panel3d1 <br>
    &nbsp; '3D面板的风格从1到5变化 <br>
    &nbsp;&nbsp;&nbsp;&nbsp; If .FloodType &lt;5 Then <5 Then <br> <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .FloodType = .FloodType + 1 <br>
    &nbsp;&nbsp;&nbsp;&nbsp; Else <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .FloodType=1 <br>
    &nbsp;&nbsp;&nbsp;&nbsp; End If <br>
    &nbsp; End With <br>
    &nbsp; '设定三种控件的初始值 <br>
    &nbsp; ProgressBar1.Value=0 <br>
    &nbsp; SLider1.Value=0 <br>
    &nbsp; Panel3d1.FloodPercent=0 <br>
    Else <br>
    &nbsp; '设定三种控件每次滑动的值 <br>
    &nbsp;&nbsp; PrpgressBar1.Value=ProgressBar1.Value + 5 <br>
    &nbsp;&nbsp; Slider1.Value=Slider1.Value +5 <br>
    &nbsp;&nbsp; Panel3d1.FloodPcrcent = Panel3d1.FloodPercent + 5 <br>
    End If <br>
    End sub <br>
    3．运行 <br>
    &nbsp;&nbsp; 设计完毕，按F5运行，三种进程指示控件竞相在屏幕上展示自己的风采，不断地变化显示风格。 
    此图是演示过程中的一个画面。 <br>
    &nbsp;&nbsp; 本文介绍了Windows环境下几种进程指示控件的特性和使用， 
    希望读者能在自己的应用程序中灵活地使用。 </td>
  </tr>
  <tr>
    <td width="100%"><hr>
    </td>
  </tr>
  <tr>
    <td width="100%"><span style="font-size: 9pt">中国程序员网站版权所有</span></td>
  </tr>
</table>

<p><br>
<br>
</p>
</body>
</html>
