<html>

<head>
<title>VB 5</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style type="text/css">
<!--
        table{border="0";cellspacing="1";cellpadding="1"}
        td{font-famliy:宋体;font-size:9pt}
        p{font-famliy:宋体;font-size:9pt;line-height:18px}
        big{font-famliy:宋体;font-size:12pt;line-height:18px}
        A:link {text-decoration: underline; font-size:9pt;color: rgb(0,0,0)}
        A:visited {text-decoration: underline;font-size:9pt; color: rgb(10,10,10)}
        A:active {text-decoration: underline;font-size:9pt;color: rgb(0,40,100)}
        A:hover {text-decoration: none;font-size:9pt; color: "#ff0000";background:rgb(220,220,220)}
-->
</style>
</head>

<body leftmargin="3">
<div align="center"><center>

<table border="0" cellspacing="2" cellpadding="0" width="95%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是： <b><font color="#0000FF"><a
    href="Vbidx099.htm">Visual Basic</a></font>&nbsp; &gt;</b> </span>VB 5.0中实现鼠标拖放</td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#E8E8E8"
bordercolor="#C48C59" cellpadding="2">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<p align="center"><strong>VB 5.0中实现鼠标拖放</strong></p>
    <p align="center">屈强</p>
    <p>&nbsp;&nbsp;&nbsp; Windows 3.x 、 Windows 95 和 Widnows 98中，拖放是最常用的操作，VB5.0在程序设计中能非常容易地实现这一操作。<br>
    &nbsp;&nbsp;&nbsp; 与拖放有关的属性<br>
    &nbsp;&nbsp;&nbsp; 1、DragMode 属性<br>
    &nbsp;&nbsp;&nbsp; 该属性用来设置自动或手动拖放模式，缺省值为0（手动方式）。为了让控件自动执行拖放操作，必须把它的属性设为1，该属性即可以在属性窗口中设置，也可以在程序中设置，如：Picture1.DragMode=1一个对象的DragMode属性值为1时，该控件不再接收Click事件和MouseDown事件。<br>
    &nbsp;&nbsp;&nbsp; 2、DragIcon 属性<br>
    &nbsp;&nbsp;&nbsp; 
    在拖动中，并非对象本身在移动，而是代表对象的图标。即一旦拖动某个控件，该控件就变成一个图标，放下后再恢复原来控件。DragIcon属性含有一个图标或图片的文件名，如：Picture1.DragIcon=c:\vb5\icons\computer\disk06.ico 
    当拖动Picture1时，Picture1即变成由disk06.ico 所代表的图标。<br>
    &nbsp;&nbsp;&nbsp; 与拖放有关的事件<br>
    &nbsp;&nbsp;&nbsp; 与拖放有关的事件是DragDrop 和DragOver, 
    把控件拖动，如松开鼠标按钮，则产生DragDrop事件，事件过程格式如下：<br>
    Sub 对象名_DragOver(Source As Control, X As Single , Y As single, State As Integer)<br>
    ......<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 该对象含有三个参数，其中Source 
    为一个对象变量，类型为Control .该参数含有被托动对象的属性，参数X、Y为松开鼠标按钮时光标的位置。<br>
    &nbsp;&nbsp;&nbsp; DragOver 事件用于图标移动，格式如下 <br>
    Sub 对象名_DragOver(Source As Control, X As Single, Y As Single, State As Integer)<br>
    ……<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 该事件含有四个参数，Source 含义同前，X、Y是鼠标托动时光标的位置坐标，State有三个值可取，当为0时，鼠标光标正进入目标对象区域，当为1时，鼠标光标正退出目标对象区域，当为2 
    时，鼠标光标正位于目标对象的区域之内。<br>
    &nbsp;&nbsp;&nbsp; 与拖放有关的方法<br>
    &nbsp;&nbsp;&nbsp; 与拖放有关的方法是Move 和Drag。 Move 
    方法大家已经很熟悉了，下面介绍Drag方法，Drag方法格式为：<br>
    &nbsp;&nbsp;&nbsp; 控件.Drag 整数，整数范围为0，1，2 含义分别为：<br>
    &nbsp;&nbsp;&nbsp; 0 取消托动操作，1 开始拖动操作，2 
    结束操作手动举例在窗体上建立一个图片框，装入一个图标，首先设置图片框的DragIcon 
    属性。<br>
    Sub Form_Load( )<br>
    Picture1.DragIcon=Picture1.Picture1.Picture<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 接着用MouseDown事件过程打开拖拉开关。<br>
    Sub Picture1_MouseDown (Button As Integer, Shift As Integer, X As Single, Y As Single)<br>
    Picture1.Drag 1<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 
    下面过程是当松开鼠标按钮时，关闭拖拉开关，停止拖拉并产生DragDrop事件。<br>
    Sub Picture1_MouseUp (Button As Integer, Shift As Integer, X As Single, Y As Single)<br>
    Picture1.Drag 2<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 最后是DragDrop事件<br>
    Sub Form_DragDrop (Source As Integer, X As Single , Y As Single)<br>
    Source.Move (X－ Source.Width/2),(Y－ Source.Height/2)<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 该程序在VB5.0中文版下运行通过。 
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </p>
    <p>　</td>
  </tr>
</table>
</center></div>
</body>
</html>
