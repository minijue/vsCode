<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>软件完全手册</title>
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="95%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progmenu.htm">编程技巧</a> --&gt; 
      <a href="Vbidx099.htm">Visual Basic</a> --&gt; </b></span>加速Visual 
      Basic For Application(VBA)</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#FFFFFF"
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"
    bordercolordark="#FFFFFF">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">
    <span style="FONT-FAMILY: 宋体; FONT-SIZE: 9pt; LETTER-SPACING: 1px; LINE-HEIGHT: 20px"><p
    align="center" class="ourfont"></span><b><font color="#0000ff"><br>
 </font>加速Visual Basic For Application(VBA)</b> </p>
    <p align="left" class="ourfont"><font color="#000000"><span
    style="FONT-FAMILY: 宋体; FONT-SIZE: 9pt; LETTER-SPACING: 1px; LINE-HEIGHT: 20px">&nbsp;&nbsp;&nbsp;&nbsp;如今的CPU的发展是越来越快，从386、486到今天的Pentium、Pentium  
    Ⅱ，发展速度可谓快矣。然而，在CPU高速发展的同时，应用软件的“体重”也随之猛涨，从我学电脑时的几K、几十K  
    ，到今天的几十兆、几百兆，这变化连我自己都感到吃惊。CPU的进步，使人们工作更加快速，效率大增，同时也养成了人们“不求简”的不良习惯。笔者曾见过一位朋友正在编写一段程序，用的是VBA，程序代码如下：<br> 
    　　With ActiveWindow<br> 
    　　If WindowState = wdWindowStateMaximize Then ’this is the first part! <br> 
    　　MsgBox &quot;This is a Maximize Window&quot;<br> 
    　　End If<br> 
    　　If WindowState = wdWindowStateMinimize Then ’this is the second part!<br> 
    　　MsgBox &quot;Here is a Minimize Window&quot;<br> 
    　　End If<br> 
    　　If WindowState = wdWindowStateNormal Then ’this is the third part!<br> 
    　　MsgBox &quot;Now here, is a Normal Window!&quot;<br> 
    　　End If<br> 
    　　End With<br> 
    　　乍看一下，似乎结构还挺漂亮，是个好程序。但细分析一下，你会发现，这段程序是个败笔。因为这三段程序没有实现应该具有的逻辑结构。我将这个意见告诉了这位朋友，他到很能听进话，马上修改了上述程序，具体程序代码如下：  
    With ActiveWindow<br> 
    　　If WindowState = wdWindowStateMaximize Then ’this is the first part!<br> 
    　　MsgBox &quot;This is a Maximize Window&quot;<br> 
    　　ElseIf WindowState = wdWindowStateMinimize Then ’this is the second part!<br> 
    　　MsgBox &quot;Here is a Minimize Window&quot;<br> 
    　　ElseIf WindowState = wdWindowStateNormal Then ' this is the third part!<br> 
    　　MsgBox &quot;Now here, is a Normal Window!&quot;<br> 
    　　End If<br> 
    　　End with<br> 
    　　我的那位朋友写完这段程序后，冲我笑笑，意思说：“怎麽样？”我看了看这段程序，心想：如果WindowState  
    不等于 wdWindowStateMaximize的话，则要在判断WindowState是否等于  
    wdWindowStateMinimize ，如果还不等于的话呢？则要继续判断是否等于wdWindowStateNormal，这样下来，要闯三个“家门”方可进对，累不累啊？我看着不耐烦了，自己亲自编了一段程序：<br> 
    　　Select Case WindowState<br> 
    　　 Case wdWindowStateMaximize ’this is the first part!<br> 
    　　 MsgBox &quot;This is a Maximize Window&quot;<br> 
    　　 Case wdWindowStateMinimize ’this is the second part!<br> 
    　　 MsgBox &quot;Here is a Minimize Window&quot;<br> 
    　　 Case wdWindowStateNormal ' this is the third part!<br> 
    　　 MsgBox &quot;Now here, is a Normal Window!&quot;<br> 
    　　End Select<br> 
    　　正如你所看到的，这段程序简练、易懂、可读性强，相信会为程序增色不少。而且如果调试起来，你会发现它的其他优点。难怪朋友恍然大悟呢！<br>
    　　其实，使用哪种判断语句，也是有章可循的。比如：如果有两种可能性，那麽可毫不犹豫地选择If/Elseif；对于两种或两种以上的可能性，最好选择Select  
    Case/End Select。多数情况下，如果只有一种唯一选择性的关系，那麽，&quot;if  
    then/endif&quot; 将是最佳选择。</span></font></td> 
  </tr> 
  <tr> 
    <td width="100%">　</td> 
  </tr> 
</table> 
</center></div> 
 
<p align="center">　</p> 
</body> 
</html> 
