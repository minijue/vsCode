<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vbidx099.htm">VB</a></b></span></td>     
  </tr>     
</table>     
</center></div><div align="center"><center>     
     
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"     
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">     
  <tr>     
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"     
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"     
    bordercolordark="#FFFFFF">     
      <tr>     
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font     
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"     
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>     
      </tr>     
    </table>     
      <p align="center">用VB制作下雪的特技景象&nbsp;<br>
      <br>
                            （山东 许振华）     
      <p><br> 
      <br> 
      　　对于下雪的景象大家可能都不陌生，我们还是用VB来制作一个下雪的景象吧。其实制作这样一个下雪的景象并不复杂，它的原理是首先在底色为黑色的屏幕上随机画出许多白点（雪花），然后使这些雪花不断地向下移动（重画），反复循环，就成功地模拟了下雪的景象。下面是这个小程序，你可以修改其中的一些数据调整雪花的密度和雪花落下的快慢。<br>
      　　双击窗体写如下代码：&nbsp;<br>
      　　Dim Snow(1000, 2), Amounty As Integer<br> 
      　　Private Sub Form_Load()<br> 
      　　Form1.Show<br>
      　　DoEvents<br>
      　　Randomize<br>
      　　Amounty = 325<br> 
      　　For J = 1 To Amounty<br> 
      　　Snow(J, 0) = Int(Rnd ＊ Form1.Width)<br> 
      　　Snow(J, 1) = Int(Rnd ＊ Form1.Height)<br> 
      　　Snow(J, 2) = 10 ＋ (Rnd ＊ 20)<br> 
      　　Next J<br> 
      　　Do While Not (DoEvents = 0)<br> 
      　　For LS = 1 To 10<br> 
      　　For I = 1 To Amounty<br> 
      　　OldX = Snow(I, 0): OldY = Snow(I, 1)&nbsp;<br>
      　　Snow(I, 1) = Snow(I, 1) ＋ Snow(I, 2)<br> 
      　　If Snow(I, 1) > Form1.Height Then<br> 
      　　 Snow(I, 1) = 0: Snow(I, 2) = 5 ＋ (Rnd ＊ 30)<br> 
      　　 Snow(I, 0) = Int(Rnd ＊ Form1.Width)<br> 
      　　 OldX = 0: OldY = 0<br> 
      　　End If<br> 
      　　Coloury = 8 ＊ (Snow(I, 2) － 10): Coloury = 60 ＋ Coloury<br> 
      　　PSet (OldX, OldY), QBColor(0)<br> 
      　　PSet (Snow(I, 0), Snow(I, 1)), RGB(Coloury, Coloury, Coloury)<br> 
      　　Next I<br> 
      　　Next LS<br> 
      　　Loop<br>
      　　End<br>
      　　End Sub<br> 
      　　 编写窗体的鼠标按下代码：<br> 
      　　Private Sub Form_MouseDown(Button As Integer,Shift As Integer, X As Single, Y As Single)<br> 
      　　 unload me<br> 
      　　End Sub<br> 
      　　运行上面的小程序，就可以看到漫天的雪花在缓缓落下，地面上还会有积雪！鼠标单击可结束程序。<br>
      　　     
    </td>    
  </tr>    
</table>    
</center></div>    

</body>

</html>
