<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vbidx099.htm">VB</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">一劳永逸让VB自动改变控件大小<br>
      <br>
                  深圳市东门茂业百货11楼  邓勇       
      <p><br> 
      ----当窗体大小改变时，如何动态的改变控件的大小是许多VB程序员头痛的事。有的人设置窗体Resizable但却不改变控件的大小；有的人则根据控件的绝对位置与窗口大小相加减的办法来重新定位控件与改变大小，这种办法比较繁琐，且不可重用；当然也有人则限定窗口干脆不让改变。有没有一种简便易行的办法？答案是肯定的，下面给出一个一劳永逸的办法，源程序如下:<br> 
      Option Explicit<br> 
      Private FormOldWidth As Long<br> 
      `保存窗体的原始宽度<br> 
      Private FormOldHeight As Long<br> 
      `保存窗体的原始高度<br> 
      <br> 
      `在调用ResizeForm前先调用本函数<br> 
      Public Sub ResizeInit(FormName As Form)<br> 
      Dim Obj As Control<br> 
      FormOldWidth = FormName.ScaleWidth<br> 
      FormOldHeight = FormName.ScaleHeight<br> 
      On Error Resume Next<br> 
      For Each Obj In FormName<br> 
      Obj.Tag = Obj.Left &amp; " " &amp; Obj.Top &amp; " "<br> 
      &amp; Obj.Width &amp; " " &amp; Obj.Height &amp; " "<br> 
      Next Obj<br> 
      On Error GoTo 0<br> 
      End Sub<br> 
      <br> 
      `按比例改变表单内各元件的大小，<br> 
      在调用ReSizeForm前先调用ReSizeInit函数<br> 
      Public Sub ResizeForm(FormName As Form)<br> 
      Dim Pos(4) As Double<br> 
      Dim i As Long, TempPos As Long, StartPos As Long<br> 
      Dim Obj As Control<br> 
      Dim ScaleX As Double, ScaleY As Double<br> 
      <br> 
      ScaleX = FormName.ScaleWidth / FormOldWidth<br> 
      `保存窗体宽度缩放比例<br> 
      ScaleY = FormName.ScaleHeight / FormOldHeight<br> 
      `保存窗体高度缩放比例<br> 
      On Error Resume Next<br> 
      For Each Obj In FormName<br> 
      StartPos = 1<br> 
      For i = 0 To 4<br> 
      `读取控件的原始位置与大小<br> 
      <br> 
      TempPos = InStr(StartPos,<br> 
      Obj.Tag, " ", vbTextCompare)<br> 
      If TempPos > 0 Then<br> 
      Pos(i) = Mid(Obj.Tag,&nbsp;<br>
      StartPos, TempPos - StartPos)<br> 
      StartPos = TempPos + 1<br> 
      Else<br> 
      Pos(i) = 0<br> 
      End If<br> 
      `根据控件的原始位置及窗体改变大小<br> 
      的比例对控件重新定位与改变大小<br> 
      Obj.Move Pos(0) * ScaleX, Pos(1)<br> 
      * ScaleY, Pos(2) * ScaleX, Pos(3) * ScaleY<br> 
      Next i<br> 
      Next Obj<br> 
      On Error GoTo 0<br> 
      End Sub<br> 
      <br> 
      Private Sub Form_Load()<br> 
      Call ResizeInit(Me) `在程序装入时必须加入<br> 
      End Sub<br> 
      <br> 
      Private Sub Form_Resize()<br> 
      Call ResizeForm(Me) `确保窗体改变时控件随之改变<br> 
      End Sub<br> 
      <br> 
      ----本例中给出了二个函数:ResizeInit和ResizeForm,在调用ResizeForm之前必须先调用ResizeInit。你可以将本程序拷到窗体代码段里，然后在窗体里加入任意控件即可进行测试      
    </td>      
  </tr>      
</table>      
</center></div>      
<p>　</p> 
 
</body> 
 
</html> 
