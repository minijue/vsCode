<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vbidx099.htm">VB</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">VB中的时间处理问题&nbsp;<br>
      <br>
                           武汉 罗程       
      <p>　　编程中常常会与时间打交道，VB编程自然也不例外。以下就谈谈我在这方面的一点经验。<br>
      　　VB中提供了很多变量类型，Date型就是专门用于存储时间的。<br>
      　　1.Date型变量及其相关函数。<br>
      　　在内部，一个Date占8个字节的内存，你可以方便地用它来存储日期和时间。给Date变量赋值是很容易的。但请保证输入顺序与系统默认的时间表示顺序相同。例如：<br>
      　　 Dim d As Date<br> 
      　　 d = ＃5/23/99 11:45:34 AM＃<br> 
      　　DateSerial函数可以把年、月、日的数字组合成一个Date值。TimeSerial函数可把小时、分、秒的数字组合成一个Date值。且两函数可以叠加。<br>
      　　d = DateSerial(1999, 5, 23) ＋ TimeSerial(11, 45, 34)<br> 
      　　而DateValue 和TimeValue 函数则可将代表日期和时间的字符串转化为Date 型，并且也可以叠加。<br> 
      　　d = DateValue(“1999/ 5/ 23”) ＋ TimeValue(“11: 45: 34”)<br> 
      　　Format函数可按预定的格式显示或打印一个Date变量。如：<br>
      　　Print Format(d, “general date”) `99－5－23 11:45:34<br> 
      　　Print Format(d, “long date”) `1999年5月23日<br> 
      　　Print Format(d, “medium date”) `99－05－23<br> 
      　　Print Format(d, “short date”) `99－5－23<br> 
      　　Print Format(d, “long time”) `11:45:34<br> 
      　　Print Format(d, “medium time”) `11:45 AM<br> 
      　　Print Format(d, “short time”) `11:45<br> 
      　　Format函数也允许你自己规定显示格式。如：<br>
      　　Print Format(d, “mmmm”) `may 产生日期中月份的英文<br> 
      　　以以上日期为例，如想显示其中的一部分信息可使用以下函数：<br>
      　　Print Month(d) `5<br> 
      　　Print Day(d) `23<br> 
      　　Print Year(d) `1999<br> 
      　　Print Hour(d) `11<br> 
      　　Print Minute(d) `45<br> 
      　　Print Second(d) `34<br> 
      　　Print WeekDay(d)`1&nbsp;<br>
      　　Weekday 提供了一组内部常量，vbSunday代表1，直到vbSaturday代表7。<br> 
      　　Now 函数可返回今天的日期及时间。如：<br> 
      　　Private Sub Form_Click()<br> 
      　　Dim d As Date<br> 
      　　d = Now<br> 
      　　Print d<br> 
      　　End Sub<br> 
      　　灵活地应用以上的函数，可以大大地简化你的程序。例如想计算10000<br>
      秒等于几小时几分几秒可写为：<br>
      　　Private Sub Form_Click()<br> 
      　　Dim d As Date<br> 
      　　d = TimeSerial(0, 0, 10000)<br> 
      　　Print d<br> 
      　　End Sub<br> 
      　　结果为2:46:40。<br>
      　　2.与时间相关的常用控件。<br>
      　　Timer控件是一个奇特的控件。Timer 控件会在固定时间间隔中运行Timer事件。此间隔是由Interval属性决定的，其单位为千分之一秒。但不要以为将其值设为0事件就可不间断的地运行了。结果恰恰相反，事件将一次也不运行。同时还要注意变量的声明。如：<br> 
      　　Private Sub Timer1_Timer()<br> 
      　　Dim a As Integer<br> 
      　　a = a ＋ 1<br> 
      　　Print a<br> 
      　　End Sub<br> 
      　　&nbsp;<br>
      　　Dim a As Integer<br> 
      　　Private Sub Timer1_Timer()<br> 
      　　a = a ＋ 1<br> 
      　　Print a<br> 
      　　End Sub<br> 
      　　试试看，其结果是完全不同的。<br>
      　　当需要用户输入时间时，为避免出现错误的时间，可以使用日历控件。它只允许用户在日历表中选择日期，避免了错误的发生。<br>
      　　3.记录时间的API函数。<br>
      　　GetTickCount Windows API函数可返回 Windows 启动以来消逝的毫秒数，其精度高于VB的Timer 函数，且Timer 函数会在午夜清零，而GetTickCount函数只有当机器连续使用49.7天后才返回零，这为我们编程提供了很大的方便。例如想知道你的电脑连续工作多久了，可新建一工程，然后添加以下代码：<br> 
      　　Private Declare Function GetTickCount Lib “kernel32”() As Long<br> 
      　　Private Sub Form_Load()<br> 
      　　Dim d As Date<br> 
      　　Dim t As Integer<br> 
      　　Form1.Show<br>
      　　t = GetTickCount \ 1000<br> 
      　　d = TimeSerial(0, 0, t)<br> 
      　　Print d<br> 
      　　End Sub      
    </td>      
  </tr>      
</table>      
</center></div>      
<p>　</p> 
 
</body> 
 
</html> 
