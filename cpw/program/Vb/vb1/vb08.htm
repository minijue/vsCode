<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vbidx099.htm">VisualBasic</a></b></span></td>    
  </tr>    
</table>    
</center></div><div align="center"><center>    
    
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"    
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">    
  <tr>    
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"    
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"    
    bordercolordark="#FFFFFF">    
      <tr>    
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font    
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"    
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>    
      </tr>    
    </table>    
      <p align="center">开机，自动更换墙纸    
      <p><br>
      　　每次开机都面对同样的墙纸，真让人感到单调乏味。是不是可以在每次开机的时候，都能给你一个意外的惊喜，自动地更换墙纸呢?笔者用VB 5.0编了一个小程序，可以轻松地解决这个问题。而其关键在于一个WINDOWS API函数的使用，该函数的功能是用来设置或询问系统范围参数的，其表达形式如下：<br> 
      　　Declare Function SystemParametersInfo Lib “user32"Alias “SystemParametersInfoA"(ByVal uAction As Long,ByVal uParam As Long, ByVal lpvParam As Any,ByVal fuWinIni As Long) As Long<br> 
      　　1、第一个参数uAction是用来动作设置的，该参数分GET和SET两种行动，有约80种不同的参数设置，其中设置墙纸的参数为SPI_SETDESKWALLPAPER=20。<br>
      　　2、第二个参数uParam的设置是随第一个参数的设置作相应调整的。这里置空值。<br>
      　　3、第三个参数lpvParam是用来设置要更换上去的图片路径。该参数的设置也是随第一个参数作相应调整的。<br>
      　　4、第四个参数fulWIni规定了在设置系统参数的时候，是否应更新用户设置参数。<br>
      　　可以是零(禁止更新)，或下述任何一个参数：<br>
      　　SPIF－UPDATEINIFILE：更新WIN.INI和注册表中的用户配置文件。<br>
      　　SPIF－SENDWININICHANGE：倘若也设置了SPIF－UPDATEINIFILE，将一条WM－WININICHANGE消息发给所有应用程序，否则没有作用。这条消息告诉应用程序已经改变了用户配置设置。<br>
      　　自动更换墙纸的具体实现如下：<br>
      　　1、启动VB，选择STANDARD.EXE创建一个新项目，删除FORM1的同时添加一个模块(MODULE1)。<br>
      　　2、在模块代码窗口填代码如下：(假设墙纸文件都在D：JX目录下按1－20的序号命名，每次开机自动抽取墙纸)<br>
      　　Private Const SPI_SETDESKWALLPAPER　　=20<br>
      　　Private Const SPIF_SENDWININICHANGE　　=＆H2<br>
      　　Private Const SPIF_UPDATEINIFILE=＆H1<br> 
      　　Private Declare FunctionSystemParametersInfo Lib "user32"Alias "SystemParametersInfoA"&nbsp;<br>
      (ByVal uAction As Long, ByVal uParam As Long,ByVal lpvParam As Any, ByValfuWinIni As Long)As Long<br> 
      　　Sub Main()<br> 
      　　Dim myvalue<br> 
      　　SPIFlags％=()<br>
      　　Ramdomize<br>
      　　myvalue=20＊Rnd<br>
      　　bmpfiles=“D:JXx”＋CStr(Int(1＋myvalue))＋“.bmp"<br>
      　　ret＆=SystemParametersInfo(SPI_SETDES<br>
      　　KWALLPAPER,0,ByVal bmpfiles,SPIFlags)<br> 
      　　End Sub<br> 
      　　3、在文件菜单下生成可执行文件，并把该可执行程序移入启动目录，便大功告成。<br>
      (特别注意在WIN98下运行时，活动桌面不能设置为按WEB页查看。)    
    </td>    
  </tr>    
</table>    
</center></div>    
<p>　</p>

</body>

</html>
