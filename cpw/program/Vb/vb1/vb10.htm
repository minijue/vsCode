<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vbidx099.htm">VB</a></b></span></td>    
  </tr>    
</table>    
</center></div><div align="center"><center>    
    
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"    
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">    
  <tr>    
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"    
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"    
    bordercolordark="#FFFFFF">    
      <tr>    
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font    
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"    
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>    
      </tr>    
    </table>    
      <p align="center">在Visual Basic中终止Windows 95<br> 
      <br> 
                              谭翁     
      <p><br> 
      &nbsp;&nbsp;&nbsp; 在Visual Basic程序中，可以使用Windows API函数来重新启动计算机系统，文本介绍如何退出Windows 95并关闭计算机系统。<br> 
      <br> 
      # 关闭计算机系统<br> 
      <br> 
      &nbsp;&nbsp;&nbsp; 可以使用Windows API的ExitWindowsEx函数来从Visual Basic程序中重新启动计算机系统。要使用该函数，需要将如下声明语句包含在窗体的通常声明部分中：<br> 
      <br> 
        Private Declare Function ExitWindowsEx Lib "user32" (ByVal&nbsp;<br>
      uFlags As Long, ByVal dwReserved As Long) As Long&nbsp;<br>
      <br>
    ExitWindowsEx 函数需要2个参数，可以使用一个或多个下面的标识的组合来告诉ExitWindowsEx函数希望进行关机过程。<br> 
      <br> 
    EWX_FORCE所有的进程都被强制终止。<br> 
      <br> 
    EWX_LOGOFF所有的进程被强制终止，并且用户退出登录（logged off）。<br> 
      <br> 
    EWX_POWEROFF计算机系统被关机，并且如果支持节电特性，则计算机被物理关机。<br> 
      <br> 
    EWX_REBOOT计算机系统被关机并重新启动。<br> 
      <br> 
    EWX_SHUTDOWN计算机被物理地安全地关机。<br> 
      <br> 
    下面的样例程序中使用了上面的三个标识的组合。该标识组合（EWX_LOGOFF，EWX_FORCE, 以及EWX_REBOOT）告诉Windows95退出所有正<br> 
      在执行的进程，使用户退出网络登录，使计算机系统处于准备状态以供用户关机。<br> 
      <br> 
      # 样例程序<br> 
      <br> 
    该样例程序显示了如何关闭计算机系统。<br> 
      <br> 
    1.在Visual Basic中开始一个新的项目，采用缺省的方法建立Form1。<br> 
      <br> 
    2.将如下常量和声明语句添加到Form1的通常声明部分中（注意该声明语句需要书写在一行内）：<br> 
      <br> 
        Private Declare Function ExitWindowsEx Lib "user32" (ByVal&nbsp;<br>
      uFlags As Long, ByVal dwReserved As Long) As Long<br> 
      <br> 
        Const EWX_LOGOFF = 0<br> 
      <br> 
        Const EWX_SHUTDOWN = 1<br> 
      <br> 
        Const EWX_REBOOT = 2<br> 
      <br> 
        Const EWX_FORCE = 4<br> 
      <br> 
        Const EWX_POWEROFF = 8<br> 
      <br> 
        Const EWX_RESET = EWX_LOGOFF + EWX_FORCE + EWX_REBOOT<br> 
      <br> 
    3.在Form1上添加一个命令按钮控件，采用缺省的方法建立Comand1。将它的Caption属性设置为“重新启动计算机”。<br> 
      <br> 
    4.将如下代码添加到Command1的单击事件中：&nbsp;<br>
      <br>
        Private Sub Command1_Click()<br> 
      <br> 
        Dim X As Long<br> 
      <br> 
        X = ExitWindowsEx(EWX_RESET, dwReserved)<br> 
      <br> 
        End Sub<br> 
      <br> 
    按下F5来运行上述样例程序，单击命令按钮，即可重新启动计算机系统。     
    </td>     
  </tr>     
</table>     
</center></div>     
<p>　</p> 
 
</body> 
 
</html> 
