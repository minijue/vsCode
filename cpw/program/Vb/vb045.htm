<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>软件完全手册</title>
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
</head>

<body>
<div align="center"><center>

<table border="0" cellPadding="0" cellSpacing="0">
</TBODY>
<TBODY>
</TBODY>
</table>
</center></div>
<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="95%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是：<a href="../progmenu.htm"> 
      <b>编程技巧</b></a><b> --&gt; <a href="Vbidx099.htm">Visual Basic</a> --&gt; 
      </b></span>用VB设计一个定时闹钟程序</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#FFFFFF"
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"
    bordercolordark="#FFFFFF">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">
    <span style="FONT-FAMILY: 宋体; FONT-SIZE: 9pt; LETTER-SPACING: 1px; LINE-HEIGHT: 20px"><p
    align="center" class="ourfont"></span><b>用VB设计一个定时闹钟程序 
    </b></p>
    <p align="left" class="ourfont"><font color="#000000"><span
    style="FONT-FAMILY: 宋体; FONT-SIZE: 9pt; LETTER-SPACING: 1px; LINE-HEIGHT: 20px">&nbsp;&nbsp;&nbsp;&nbsp;使用win98的人一定知道其中有一个“计划任务&quot;的应用程序,它能够到指定时间便开始工作。不要认为它很神秘,其实用VB来设计这样一个程序是非常容易的事,以下是一个简单的VB闹钟程序,可供各位使用VB的朋友参考,如有何不适之处,请多指点! 
    <br>
    　　首先在form1上建立三个命令按钮,分别为command1(打开预启动的文件);command2(设定时间的按钮);第三个command3(即可启动)按钮可有可无;一个label1用来显示你预打开的文件名的路径；一个lbltime用来显示现在的时间；还有一个common  
    dialog,它在工程菜单的部件中，你可把它加到工具箱中再开始使用;关于对话框你不必自己建，只要从应用程序向导中添加即可;一个timer,它的interval=500。  
    <br> 
    　　其次在form1的属性中设置为:startupposition=2－centerscreen和maxbutton=false;label1的属性中设置为：alignment=2－center。 
    <br>
    　　外观大致是如图所示： <br>
    　　下面我们开始编程： <br>
    　　Option Explicit <br> 
    　　Dim AlarmTime <br> 
    　　'申明变量 <br>
    　　－－－－－－－－－ <br>
    　　Private Sub Command1_Click() <br> 
    　　Call dialog <br> 
    　　'调用dialog子程序 <br>
    　　End Sub <br> 
    　　－－－－－－－－ <br>
    　　Private Sub Command2_Click() <br> 
    　　 AlarmTime = InputBox(“请输入你想设定的时间,例如(19:12:00)&quot;, “小闹钟&quot;)  
    <br> 
    　　 If AlarmTime = “&quot; Then Exit Sub <br> 
    　　If Not IsDate(AlarmTime) Then <br> 
    　　MsgBox “你所输入的不是时间格式,请重试!&quot;, ,“Wrong&quot; <br> 
    　　Else <br>
    　　AlarmTime = CDate(AlarmTime) <br> 
    　　End If <br> 
    　　'判断输入的是否可转换成time格式 <br>
    　　'isdate函数是判断输入的是否可转换成date格式 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－－ <br>
    　　Private Sub Command3_Click() <br> 
    　　Call deng <br> 
    　　'调用deng子程序 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－－－ <br>
    　　Private Sub Form_Click() <br> 
    　　frmAbout.Show <br>
    　　'显示关于对话框 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－ <br>
    　　Private Sub Form_Load() <br> 
    　　 Command3.Enabled = 0 <br> 
    　　 AlarmTime = “&quot; <br> 
    　　'初始化时command3为不可用的 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－－－ <br>
    　　Private Sub Form_Resize() <br> 
    　　 If WindowState = 1 Then <br> 
    　　 mintime <br> 
    　　 else <br> 
    　　 caption=“小闹钟&quot; <br> 
    　　 End If <br> 
    　　'如果窗口被最小化,则调用mintime程序 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－－－ <br>
    　　Private Sub mintime() <br> 
    　　Caption = Format(Time, “long Time&quot;) <br> 
    　　'使用长时间格式来显示时间 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－－－ <br>
    　　Private Sub Timer1_Timer() <br> 
    　　If lblTime.Caption &lt;&gt; CStr(Time) Then <br> 
    　　lblTime.Caption = Time <br> 
    　　End If <br> 
    　　'显示时间每秒钟的变化 <br>
    　　If Time &gt;= AlarmTime Then <br> 
    　　Call deng <br> 
    　　End If <br> 
    　　'判断如果现在的时间超过了设定的时间,则调用deng子程序 <br>
    　　If WindowState = 1 Then <br> 
    　　If Minute(CDate(Caption)) &lt;&gt; Minute(Time) Then <br> 
    　　mintime <br>
    　　End If <br> 
    　　End If <br> 
    　　'最小化时显示时间每分钟的变化 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－ <br>
    　　Sub dialog() <br> 
    　　CommonDialog1.Flags = cdlCFBoth <br> 
    　　CommonDialog1.ShowOpen <br>
    　　Label1.Caption = CommonDialog1.filename <br> 
    　　If Label1 &lt;&gt; “&quot; Then <br> 
    　　Command3.Enabled = －1 <br> 
    　　Else <br>
    　　Exit Sub <br> 
    　　End If <br> 
    　　'把打开的文件名给于label1 <br>
    　　'如果label1不为空时,则command3即可用 <br>
    　　End Sub <br> 
    　　－－－－－－－－－－－－－－ <br>
    　　Sub deng() <br> 
    　　Dim ss <br> 
    　　ss = Shell(Label1.Caption, 1) <br> 
    　　End <br>
    　　'启动指定的文件,并且结束小闹钟程序 <br>
    　　End Sub <br> 
    　　最后在about对话框中要提的是：在form_load中app.title表示你的应用程序的名字；app.major、minor、revision是关于应用程序的版本信息；lblDescription.Caption  
    用于对本程序的一些说明描述之类的话；lblDisclaimer.Caption用于版权信息或警告等。  
    <br> 
    　　好了，至此我们已完成了一个简单的VB程序的编写，希望你能设计出更好的闹钟程序来！ 
    <br>
    　　以上在windows98,中文VB5.0企业版中通过。(上海 季昭君) </span></font> 
      <p>　</p> 
    </td> 
  </tr> 
</table> 
</center></div> 
<p>　</p> 
</body> 
</html> 
