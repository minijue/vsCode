<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://www.cfan.cn.net/zine/qikan/bbg/9901bb07.html -->
<HTML><HEAD><TITLE></TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META content="Microsoft FrontPage 4.0" name=GENERATOR></HEAD>
<BODY>
<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      Visual Basic</b></span></td>  
  </tr>  
</table>  
</center></div><div align="center"><center>  
  
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"  
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">  
  <tr>  
    <td width="15%" align="center" valign="top"><!--webbot bot="Include"  
      U-Include="../../menu.htm" TAG="BODY" startspan -->

<table border="1" width="101" style="font-size: 9pt" cellspacing="0" cellpadding="2" bordercolorlight="#000000" bordercolordark="#FFFFFF">
  <tr>
    <td width="99" bgcolor="#FFCC66" valign="top" align="left">
      <p align="center">编程技巧</td>
  </tr>
  <tr>
    <td width="97" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15"> 
      <a href="../VisualC/Vcidx098.htm">Visual C</a></td>   
  </tr>   
  <tr>   
    <td width="97" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">   
      <a href="Vbidx099.htm">VB</a></td>  
  </tr>  
  <tr>  
    <td width="97" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      <a href="../Vfp/Vfp_idx.htm">VFoxpro</a></td>  
  </tr>  
  <tr>  
    <td width="97" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      <a href="../Delphi/Del_idx.htm">Delphi</a></td>  
  </tr>  
  <tr>  
    <td width="97" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      <a href="../powerbuild/pow_idx.htm">PB</a></td> 
  </tr> 
  <tr> 
    <td width="97" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      <a href="../linux/linuxidx.htm">Linux</a></td> 
  </tr> 
  <tr> 
    <td width="97" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      <a href="../other/oth_idx.htm">其它</a></td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"></td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left" bgcolor="#FFCC66"> 
      <p align="center">网站建设</td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      网站评说</td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      ASP</td>
  </tr>
  <tr>
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15"> 
      CGI</td>
  </tr>
  <tr>
    <td width="99" valign="top" align="left"></td>
  </tr>
  <tr>
    <td width="99" valign="top" align="left" bgcolor="#FFCC66">
      <p align="center">源代码</td>
  </tr>
  <tr>
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15"> 
      ASP</td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      CGI</td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      系统工具</td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      游戏软件</td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"><img border="0" src="../../res/dir.gif" width="32" height="15">  
      其它</td> 
  </tr> 
  <tr> 
    <td width="99" valign="top" align="left"></td> 
  </tr> 
</table> 
 
<!--webbot bot="Include" endspan i-checksum="1468" -->

    </td>  
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"  
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"  
    bordercolordark="#FFFFFF">  
      <tr>  
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font  
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"  
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>  
      </tr>  
    </table>  
      <p align="center"><STRONG>用VB5.0编写自己的MP3播放器</STRONG>
      <p>
&nbsp;&nbsp;&nbsp;&nbsp; □ 湖北　杨山河 
<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>M</B>P3播放器大家用得应该不少，不过，您是否厌倦了播放器的老面孔，是否尝试编写一个自己的MP3播放器呢？什么，太复杂!你会VB吗？会就得了！  
&nbsp;&nbsp;&nbsp;&nbsp;<B>首</B>先，得了解一下我从朋友处得来的一个ActiveX控件――Mp3Play.ocx。所谓ActiveX控件就是高手早已编好的专门化功能软件部件。以前在16位VB中是以vbx作为扩展名，Win95中扩展名改为ocx。大家只要知道Mp3Play.ocx是一个专门播放MP3音乐文件的VB控件就行。我们编写自己的播放器，使用该控件，并适当设置其属性，就可以获得专业级的MP3音乐效果。要想使用该控件，最好将它放到Windows\system目录,并且在注册表中注册。利用该控件，还可以将一个MP3文件解码为一个WAV文件。  
&nbsp;&nbsp;&nbsp;&nbsp;Mp3Play.ocx的主要属性有：<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>B</B>itRate  
：MP3流比特率；FrameCount：MP3流帧记数；TotalTime： 总计已播放的时间；FrameNotifyCount( RW  
)：发送一次通告的帧数，缺省为32；IsCopyrighted、IsOriginal、HasChecksums：  
从MP3流获得的发行信息；SampleFrequency：采样率；Layer：取值可以为1、2、3，分别代表Layer1、Layer2、Layer3的标准，缺省为3，这意味着MPx的文件都可以播放；MPEGVersion：取值代表MPEG－1或MPEG－2。  
&nbsp;&nbsp;&nbsp;&nbsp;常用的方法有：<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;AboutBox (  
)：显示About框。<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>A</B>uthorize ( Name, Password  
)：验证许可证（注册码），Name即注册名，Password为注册码，由控件的提供商在用户注册后提供，返回值为0则通过，否则为5。  
&nbsp;&nbsp;&nbsp;&nbsp;<B>O</B>pen ( Inputfile, Outputfile  
)：打开MPEG音频文件并解码播放，若在声卡上播放则Outputfile应为空串，返回非0值表示解码有误。如果Outputfile为文件名则解码至WAV文件。也就是说，可以利用此方法编写MP3－WAV转换器。  
&nbsp;&nbsp;&nbsp;&nbsp;Close：关闭当前MPEG流解码。<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>G</B>etVolumeLeft,GetVolumeRight：获取左右声道的音量，返回Long型值。  
&nbsp;&nbsp;&nbsp;&nbsp;<B>S</B>etVolume ( left channel, right channel  
)：设置系统左右声道音量。 &nbsp;&nbsp;&nbsp;&nbsp;Pause(  
)：暂停，奇次声音暂停，偶次开启。<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>P</B>lay (  
)：开始解码，并播放当前MPEG文件，返回0表示解码无误。 &nbsp;&nbsp;&nbsp;&nbsp;Stop(  
)：停止当前解码工作，返回非0表示有误。<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;下面，我们一步一步地完成：<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;1．  
添加Mp3Play.ocx控件<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>启</B>动VB5,选择Standard  
EXE。此时，左边的控件面板中只是一些Win95标准控件。我们选Project（工程）菜单下的Components...(组件)项，在弹出的对话框中选中Dialog－Medien  
Mp3Play ActiveX Control  
Module项。这“宝贝”即我们所需的MP3控件。确定后在控件面板中会增添一个蓝色的喇叭图标，表示该控件已经添加到控件面板中。  
&nbsp;&nbsp;&nbsp;&nbsp;2．  
设置属性<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>点</B>中蓝色喇叭，在窗体中拖动一个矩形框，松开后在窗体中出现MP3控件图标。为了在播放时隐去喇叭，在MP3Play1的属性表中将Visible设为False。一般就这么多，剩下的就是使用它的方法(Methods)了。  
&nbsp;&nbsp;&nbsp;&nbsp;3．  
添加按钮<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>点</B>中“Command”按钮，在窗体中建立三个名字分别为Command1、Command2、Command3的命令按钮，将它们的Caption分别设为“选择MP3文件”、“播放”、“暂停”。  
&nbsp;&nbsp;&nbsp;&nbsp;4．  
添加CommonDialog控件<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>为</B>能方便地选择MP3  
文件，还需文件打开对话框。如果控件面板中没有此控件，如1中所述选中Components菜单项，在Microsoft Common Dialog Control  
5.0前的复选框中打勾，确认后即可在控件面板中看到此控件图标。在窗体中建立一个名为CommonDialog1的对象，为使能快速找到MP3的文件，需要设置它的Filter属性为“.MP3|.MP3”。  
&nbsp;&nbsp;&nbsp;&nbsp;5．  
在按钮中编写相应的代码<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>双</B>击Command1，在Private Sub  
Command1_Click()中输入以下代码：  
&nbsp;&nbsp;&nbsp;&nbsp;CommonDialog1.ShowOpen<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>  
</B>双击Command2，在Private Sub Command2_Click()中输入： &nbsp;&nbsp;&nbsp;&nbsp;<B>  
</B>Err = Mp3Play1.Open(CommonDialog1.filename, ″″) &nbsp;&nbsp;&nbsp;&nbsp;  
Mp3Play1.Play<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B> </B>双击Command3，在Private Sub  
Command3_Click()中输入： &nbsp;&nbsp;&nbsp;&nbsp;  
Mp3Play1.Pause<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;6．调整窗口大小，运行播放器<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>适</B>当调整窗体的外观，如大小、颜色等，怎么舒服您就怎么设置。好了，开始按F5运行，选择MP3文件――播放！感受一下您自个儿的MP3播放器吧！  
&nbsp;&nbsp;&nbsp;&nbsp;<B>此</B>外，您还可以用Photoshop等软件制作一些漂亮的界面，贴在窗体上，增强其艺术性。还可以仿照Winamp的“Plug_ins”，利用Timer控件完成一些特殊的动画效果。当然，一切都靠您自个的天才去设计了。顺便在此请教诸位大侠，哪儿有未加时间限制的Mp3Play.ocx，或者您有注册号，请告诉在下。我因没有注册码，每首歌曲只能播放30秒。   
      <p>　   
    </td>   
  </tr>   
  <tr>   
    <td width="100%" colspan="2" align="center" valign="top">　</td>   
  </tr>   
</table>   
</center></div>   
</BODY></HTML> 
