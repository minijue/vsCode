<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style type="text/css">
<!--
        table{border="0";cellspacing="1";cellpadding="1"}
        td{font-famliy:宋体;font-size:9pt}
        p{font-famliy:宋体;font-size:9pt;line-height:18px}
        big{font-famliy:宋体;font-size:12pt;line-height:18px}
        A:link {text-decoration: underline; font-size:9pt;color: rgb(0,0,0)}
        A:visited {text-decoration: underline;font-size:9pt; color: rgb(10,10,10)}
        A:active {text-decoration: underline;font-size:9pt;color: rgb(0,40,100)}
        A:hover {text-decoration: none;font-size:9pt; color: "#ff0000";background:rgb(220,220,220)}
-->
</style>
<title>VB实现按钮浮动效果</title>
</head>

<body leftmargin="3"
style="color: rgb(0,128,128); font-family: 宋体; font-size: 9pt; line-height: 17px">
<div align="center"><center>

<table border="0" cellspacing="2" cellpadding="0" width="95%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt"><font color="#000000">现在的位置是： </font><b><font
    color="#0000FF"><a href="Vbidx099.htm">Visual Basic</a></font><font color="#000000"> &gt;</b> 
    </span>VB实现按钮浮动效果</font></td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#E8E8E8"
bordercolor="#C48C59" cellpadding="2">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<p align="center"><strong><font color="#000000">VB实现按钮浮动效果</font></strong></p>
    <p align="center"><font color="#000000">王建跃</font></p>
    <p align="left"><font color="#000000">&nbsp;&nbsp;&nbsp; 微软的Visual Basic确实是个好东东，编写应用程序快捷高效。但是入门容易，想玩转它可不简单。我个人学VB就深有体会：一个人在VB的殿堂里摸索是何等的辛苦啊！有时为了一个特技、一句代码甚至一个变量要反复调试运行几十遍，也未必能通过，真恨不得一枪崩了VB。所以，我连这一点点小技巧都不敢独品，拿出来与大家共享，也算抛砖引玉，引出更多、更精彩的奇思妙文，以“飨”读者。<br>
    &nbsp;&nbsp;&nbsp; 
    关于浮动按钮的实现思路不少，多是采取多图片重叠显示来实现。这种方法代码量多，实现起来较繁琐。因为，一个按钮还好，如果有十个按钮呢？一个按钮三个图片，十个就要三十个图片，可不是闹着玩的。<br>
    &nbsp;&nbsp;&nbsp; 我的思路是：<br>
    &nbsp;&nbsp;&nbsp; 舍弃CommandButton控件，每个按钮用4条Line控件和一个Label控件替代。4条Line围住Label的边缘，调入窗体时，置显示属性为False，并将左、上直线的颜色设为白色，右、下直线的颜色设为黑色。当鼠标移到Label上时，4条Line的显示属性置True；当鼠标离开按钮时，将4条Line的显示属性设置为False。这样在视觉上就完全得到立体浮动的效果。另外，VB的Line控件还支持直线倾斜，以此类推，完全可以做出更加美观的倾斜按钮。篇幅所限，下面仅给出一个按钮实现浮动效果的源代码。<br>
    Option Explicit<br>
    Private Sub Form_Load()<br>
    '初始Form与Label<br>
    Form1.Caption = “浮动按钮&quot;<br>
    Form1.KeyPreview = False<br>
    label1.Caption = “确定&quot;<br>
    '初始4条Line的显示属性为False<br>
    Line1.Visible = False<br>
    Line2.Visible = False<br>
    Line3.Visible = False<br>
    Line4.Visible = False<br>
    '初始4条Line的颜色<br>
    Line1.BorderColor = ＆HE0E0E0<br>
    Line2.BorderColor = ＆HE0E0E0<br>
    Line3.BorderColor = ＆H808080<br>
    Line4.BorderColor = ＆H808080<br>
    End Sub<br>
    Private Sub Form_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)<br>
    '鼠标指针在窗体上(不在按钮上)时，置4条Line的显示属性为False<br>
    Line1.Visible = False<br>
    Line2.Visible = False<br>
    Line3.Visible = False<br>
    Line4.Visible = False<br>
    End Sub<br>
    Private Sub label1_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As 
    Single)<br>
    '鼠标指针在按钮上时，置4条Line的显示属性为True<br>
    Line1.Visible = True<br>
    Line2.Visible = True<br>
    Line3.Visible = True<br>
    Line4.Visible = True<br>
    End Sub</font></p>
    <p align="right">　</td>
  </tr>
</table>
</center></div>
</body>
</html>
