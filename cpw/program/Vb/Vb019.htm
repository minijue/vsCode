<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>VB编程的好帮手--资源文件</title>
<link rel="stylesheet" href="my.css"
tppabs="http://person.zj.cninfo.net/~lifu/images/my.css">
</head>

<body style="font-size: 9pt" bgcolor="#FFFFFF">

<table border="0" cellspacing="2" cellpadding="0" bordercolor="#DED8CD" width="100%">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是： <a href="Vb_idx.htm"
    tppabs="http://person.zj.cninfo.net/~lifu/index.html">Visual Basic</a><b>&gt;</b> VB编程的好帮手--资源文件</span></td>
  </tr>
  <tr>
    <td><span style="font-size: 9pt"></span></td>
  </tr>
</table>

<table border="0" width="100%" bgcolor="#E8E8E8">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" bgcolor="#4264B5"
    height="30" cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%"><font color="#FFFFFF">资料整理<span class="f">&middot;</span><a
        href="http://fasoft.yeah.net" target="_blank" style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<table border="0" width="100%">
      <tr>
        <td width="100%"></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><strong><span style="font-size: 9pt">VB编程的好帮手--资源文件</span></strong></td>
  </tr>
  <tr>
    <td style="font-size: 9pt">各位VB高手，你一定也常常因苦于无法组织自己程序中大量的picture，而头痛不已，那就让小生为各位介绍一下VB编程的好帮手--资源文件。<br>
    &nbsp;&nbsp; 
    所谓资源文件，就是指将在程序运行时用到的资源集中在一起的一个文件。一个资源文件可以包括文字（TEXT）、位图（BITMAP）。图标（ICON）等。并且在程序中调用时不用指明路径，这就简化了程序的编写并减少了发生错误的可能。现在我就以一个小程序为例讲述资源文件的一些使用方法。<br>
    &nbsp;&nbsp; 
    这个工程运行后，当点击【未来】按钮时中间图像将依次变换为夏、秋、冬、春……点击【从前】按钮则以相反顺序转动图片（源程序附后）。<br>
    &nbsp;&nbsp; 首先建立春、夏、秋、冬四幅位图，均以.BMP格式保存在C:\TEST\下。然后打开记事本编写资源文件，<br>
    内容如下：<br>
    100 bitmap spring.bmp<br>
    200 bitmap summer.bmp<br>
    300 bitmap autumn.bmp<br>
    400 bitmap winter.bmp<br>
    其中数字表示此项的ID号码，此号码很重要，它直接影响调用！BITMAP表示以位图方式保存而最后的部分为文件名。将此文件保存为TEST.RC。<br>
    &nbsp;&nbsp; 接下来编译此资源文件。在C:\Visual Basic\Wizards目录下找到RC.EXE文件。在MS-DOS方式下键人C:\rc 
    /r c:\test.test.rc（键入rc /?将会得到帮助），在编译成功后在C:\TEST\中将发现增加了一个名为TEST.RES的文件。<br>
    &nbsp;&nbsp; 
    完成了上面的工作，接下来就可以编写工程了。首先建立一个image控件img和两个Command控件cmdc、cmdw。然后建立一个时钟控件，设其Interval属性为1000。最后在[通用]中声明一个名为iid的整形变量：<br>
    Dim iid As Integer<br>
    并初始化img和iid：<br>
    img.Picture=LoadResPicture(100,vbResBitmap)<br>
    iid=100<br>
    其中LoadResPicture(id,model)为从资源文件中调用图像的函数，100表示ID号为100的项，vbResBitmap为一常量，值为0，表示以位图方式打开。然后在两个Command控件中加入源程序代码。<br>
    &nbsp;&nbsp; 最后在工程资源管理器中用鼠标右键单击选择【添加】--&gt;【添加文件】，加入TEST.RES。<br>
    &nbsp;&nbsp; 至此工程可谓大功告成，按F5运行一下，希望你会喜欢。还有一点要强调的是一个工程只能有一个工程文件！附源程序：<br>
    Option Explicit<br>
    Dim iid As Integer<br>
    Private Sub comc_Click()<br>
    &nbsp;&nbsp;&nbsp; iid = iid - 100<br>
    &nbsp;&nbsp;&nbsp; If iid &lt; 100 Then iid = 400<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; img.Picture = LoadRespicture(iid.vbResBitmap)<br>
    &nbsp;&nbsp;&nbsp; End If<br>
    End Sub<br>
    Private Sub comw_Click()<br>
    &nbsp;&nbsp;&nbsp; iid = 100 + iid<br>
    &nbsp;&nbsp;&nbsp; If iid &gt; 400 Then iid = 100<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; img.Picture = LoadResPicture(iid,vbResBitmap)<br>
    &nbsp;&nbsp;&nbsp; End If<br>
    End Sub<br>
    Private Sub Form_Load()<br>
    &nbsp;&nbsp;&nbsp; img.Picture = LoadResPicture(10O,vbResBitmap)<br>
    &nbsp;&nbsp;&nbsp; iid = 100 <br>
    End Sub<br>
    Private Sub Timer1_Timer()<br>
    &nbsp;&nbsp;&nbsp; iid = 100 + iid<br>
    &nbsp;&nbsp;&nbsp; If iid &gt; 400 Then iid = 100<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; img.Picture = LoadResPicture(iid,vbResBitmap)<br>
    &nbsp;&nbsp;&nbsp; End If<br>
    End Sub</td>
  </tr>
  <tr>
    <td width="100%"></td>
  </tr>
</table>

<p><br>
</p>
</body>
</html>
