<html>

<head>
<title>操作考试评卷程序</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style type="text/css">
<!--
        table{border="0";cellspacing="1";cellpadding="1"}
        td{font-famliy:宋体;font-size:9pt}
        p{font-famliy:宋体;font-size:9pt;line-height:18px}
        big{font-famliy:宋体;font-size:12pt;line-height:18px}
        A:link {text-decoration: underline; font-size:9pt;color: rgb(0,0,0)}
        A:visited {text-decoration: underline;font-size:9pt; color: rgb(10,10,10)}
        A:active {text-decoration: underline;font-size:9pt;color: rgb(0,40,100)}
        A:hover {text-decoration: none;font-size:9pt; color: "#ff0000";background:rgb(220,220,220)}
-->
</style>
</head>

<body leftmargin="3">
<div align="center"><center>

<table border="0" cellspacing="2" cellpadding="0" width="95%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是： <font color="#0000FF"><a
    href="Vbidx099.htm" tppabs="http://person.zj.cninfo.net/~lifu/index.html">Visual Basic</a></font><b>&gt;</b> 
    操作考试评卷程序</span></td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#E8E8E8"
bordercolor="#C48C59" cellpadding="2">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><strong><big><span style="font-size: 9pt">操作考试评卷程序</span></big></strong></p>
    <p align="center">黄小成</p>
    <p align="left">在中、英文录入、字表处理和数据库等操作考试中，评卷是一项繁重的工作；笔者使用QBASIC编写了如下程序，让您从繁重的评卷工作中摆脱出来。<br>
    &nbsp;&nbsp;&nbsp; 一、基本原理：使用QBASIC语言，将待评文本文件的内容与标准文本文件的内容，逐字进行比较，通过计算正确率得出评定结果。评定的结果(即为得分)保留了两位小数，并且即在屏幕上显示评定结果，又将结果写入PJ.DOC文件中，供查阅和打印输出。<br>
    &nbsp;&nbsp;&nbsp; 
    二、操作说明：①程序的运行──先启动汉字系统，再在QBASIC环境下运行本程序，然后根据程序提示，依次输入评定类别、标准文本文件名和待评文本文件名，即完成一次评定。②程序中的标准文本文件是指按照操作考试试题所做的标准答案文件，待评文本文件是指考生所做的答案文件；原则上都要求以文本方式存盘(在出题时事先加以考虑)，对于WPS文书文件，可使用WPS的文件服务功能将其转换成文本文件。<br>
    &nbsp;&nbsp;&nbsp; 三、程序清单：<br>
    SCREEN 12:CLS:num = 1<br>
    KEY OFF:KEY(6) ON:KEY(7) ON<br>
    ON ERROR GOTO anyerror<br>
    ON KEY(6) GOSUB begin<br>
    ON KEY(7) GOSUB endd<br>
    begin:<br>
    PLAY “MBMNT150L4O3CDECCDECEFG2EFG2&quot;<br>
    VIEW (1, 1)－(636, 476), 1, 4<br>
    VIEW (25, 9)－(615, 42), 0, 2<br>
    LINE (9, 29)－(582, 30), 8, B<br>
    LINE (581, 3)－(582, 28), 8, B<br>
    LINE (9, 3)－(581, 3), 15, B<br>
    LINE (9, 3)－(9, 28), 15, B<br>
    VIEW (25, 424)－(615, 452), 0, 7<br>
    VIEW (40, 88)－(570, 113), 0, 7<br>
    PALETTE 0, 256 ＊ 36:PALETTE 8, 0<br>
    LOCATE 2, 22:COLOR 14<br>
    PRINT “计 算 机 操 作 考 试 评 卷 程序&quot;<br>
    LOCATE 25, 16<br>
    PRINT “F6:重新开始 F7(N):结束评定回车或任意键:继续评定&quot;<br>
    LOCATE 6, 8:COLOR 15<br>
    INPUT “请输入评定类别(E:英文录入或数据库回车:汉字录入或字表处理)&quot;; 
    e＄<br>
    VIEW (100, 123)－(480, 148), 0, 7<br>
    LOCATE 8, 15<br>
    INPUT “请输入标准文本文件名&quot;; bzname＄<br>
    VIEW (100, 158)－(480, 183), 0, 7<br>
    LOCATE 10, 15<br>
    INPUT “请输入待评文本文件名&quot;; tyname＄<br>
    OPEN bzname＄ FOR INPUT AS ＃1<br>
    OPEN tyname＄ FOR INPUT AS ＃2<br>
    OPEN “pj.doc&quot; FOR APPEND AS ＃3<br>
    k = 0:m = 0<br>
    qt1 = LOF(1):qt2 = LOF(2)<br>
    a＄ = “&quot;:b＄ = “&quot;<br>
    DO WHILE NOT EOF(1)<br>
    LINE INPUT ＃1, a1＄<br>
    a＄ = a＄ ＋ a1＄<br>
    LOOP<br>
    DO WHILE NOT EOF(2)<br>
    LINE INPUT ＃2, b1＄<br>
    b＄ = b＄ ＋ b1＄<br>
    LOOP<br>
    l = LEN(a＄)<br>
    IF qt1 &lt; qt2 THEN b＄ = MID＄(b＄, 1, l)<br>
    IF e＄ = “e&quot; OR e＄ =“E&quot; THEN<br>
    FOR k = 1 TO l<br>
    aa＄ = MID＄(a＄, k, 1)<br>
    bb＄ = MID＄(b＄, k, 1)<br>
    IF bb＄ &lt;&gt; aa＄ THEN m = m ＋ 1<br>
    NEXT k<br>
    f = INT((qt1 － m) / qt1 ＊ 100 ＊ 100) / 100<br>
    ELSE<br>
    FOR k = 1 TO l STEP 2<br>
    aa＄ = MID＄(a＄, k, 2)<br>
    bb＄ = MID＄(b＄, k, 2)<br>
    IF bb＄ &lt;&gt; aa＄ THEN m = m ＋ 1<br>
    NEXT k<br>
    f = INT((qt1 / 2 － m) / (qt1 / 2) ＊ 100 ＊ 100) / 100<br>
    END IF<br>
    PRINT ＃3,“第&quot;; num; “个考生&quot;, “错误数为=&quot;; m, “分数(正确率)=&quot;; 
    f; “(％)&quot;<br>
    VIEW (100, 193)－(480, 218), 0, 7<br>
    VIEW (100, 231)－(480, 255), 0, 7<br>
    VIEW (100, 265)－(480, 290), 0, 7<br>
    VIEW (100, 300)－(480, 325), 0, 7<br>
    LOCATE 12, 15:COLOR 14<br>
    IF e＄ = “e&quot; OR e＄ = “E&quot; THEN<br>
    PRINT “错误数和两文件相差字数为:&quot;, m; “,&quot;; ABS(qt1 － qt2)<br>
    ELSE<br>
    PRINT “错误数和两文件相差字数为:&quot;, m; “,&quot;; INT(ABS(qt1 － qt2) 
    / 2)<br>
    END IF<br>
    LOCATE 14, 15<br>
    IF e＄ = “e&quot; OR e＄ = “E&quot; THEN<br>
    PRINT“标准文件和待阅文件长度为:&quot;; qt1;“,&quot;; qt2<br>
    ELSE<br>
    PRINT “标准文件和待阅文件长度为:&quot;; INT(qt1 / 2); “,&quot;; INT(qt2 / 
    2)<br>
    END IF<br>
    LOCATE 16, 15<br>
    PRINT “分 数 ?正 确 率 ） 为 :&quot;; f; “分(％)&quot;<br>
    num = num ＋ 1<br>
    CLOSE ＃1, ＃2, ＃3<br>
    LOCATE 18, 15<br>
    COLOR 15<br>
    INPUT “是 否 继 续 评 卷 (Y/N) &quot;; m＄<br>
    IF m＄ = “n&quot; OR m＄ = “N&quot; THEN<br>
    END<br>
    ELSE<br>
    GOTO begin<br>
    END IF<br>
    endd:<br>
    END<br>
    anyerror:<br>
    VIEW (102, 342)－(479, 409), 0, 4<br>
    LOCATE 21, 18<br>
    INPUT “ 文件名出错或没有找到!回车继续&quot;; n＄<br>
    CLOSE ＃1, ＃2, ＃3<br>
    RESUME begin <br>
    </td>
  </tr>
</table>
</center></div>
</body>
</html>
