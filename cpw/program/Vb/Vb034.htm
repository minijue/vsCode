<html>

<head>
<title>VB中播放WAV文件</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style type="text/css">
<!--
        table{border="0";cellspacing="1";cellpadding="1"}
        td{font-famliy:宋体;font-size:9pt}
        p{font-famliy:宋体;font-size:9pt;line-height:18px}
        big{font-famliy:宋体;font-size:12pt;line-height:18px}
        A:link {text-decoration: underline; font-size:9pt;color: rgb(0,0,0)}
        A:visited {text-decoration: underline;font-size:9pt; color: rgb(10,10,10)}
        A:active {text-decoration: underline;font-size:9pt;color: rgb(0,40,100)}
        A:hover {text-decoration: none;font-size:9pt; color: "#ff0000";background:rgb(220,220,220)}
-->
</style>
</head>

<body leftmargin="3">
<div align="center"><center>

<table border="0" cellspacing="2" cellpadding="0" width="95%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是： <strong><a href="Vbidx099.htm"
    tppabs="http://person.zj.cninfo.net/~lifu/index.html">Visual Basic</a></strong><b> 
    &nbsp; &gt;</b> VB中播放WAV文件</span></td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#E8E8E8"
bordercolor="#C48C59" cellpadding="2">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<p align="center"><strong><font size="1"><span style="font-size: 9pt">VB中播放WAV文件</span></font></strong></p>
    <p align="center"> 赵鹏</p>
    <p align="left">&nbsp;&nbsp;&nbsp; 
    在多媒体软件的开发设计中，声音是一个相当重要的多媒体元素，优秀的声音设计会为多媒体软件增色不少。而WAV格式的声音文件是一种最常用的声音文件格式，也最容易得到，比如通过Win 
    95中的“录音机”程序，利用麦克风就可以非常简单地录制WAV文件。VB是一个相当经典的多媒体开发的工具，在VB中播放WAV文件的方法主要有这样几种。<br>
    </p>
    <p align="left">&nbsp;&nbsp;&nbsp; 一、利用OLE控件<br>
    &nbsp;&nbsp;&nbsp; 建一窗体，用鼠标选择OLE控件，在窗体上拖出OLE区域，在图一的窗口中选择新建和声音然后按确定键就完成了在窗口中添加OLE控件，如图二。<br>
    &nbsp;&nbsp;&nbsp; 这样就可以在OLE控件的ResourceDoc属性中选择所要播放的文件，程序运行时双击OLE控件即可。<br>
    在实际的程序设计当中，往往需要单击某个图标或按钮来控制声音的播放，其实现方法是这样的：首先将OLE控件的VISIBLE属性设置为FALSE,然后在图标或按钮的单击事件中编写如下的程序：<br>
    Private Sub Contol_Click()<br>
    OLE1.Action = 7<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 二、利用MMControl控件<br>
    &nbsp;&nbsp;&nbsp; VB5.0提供了许多设计多媒体的控件，在PROJECT/COMPENENTS/CONTROLS中选择MMControls 
    控件，窗体上就出现了多媒体控件对象，在这个对象上有不同的图形功能标识，其名称从左到右分别是Pre、Next、Play、Pause、Back、Step、Stop、Record 
    、Eject 如图三。<br>
    &nbsp;&nbsp;&nbsp; 这个多媒体控件可以播放多种格式的声音，播放WAV格式声音文件的程序代码<br>
    Private Sub form_load()<br>
    MMControl1.DeviceType = &quot;waveaudio&quot;<br>
    MMControl1.filename = &quot;c:\win95\media\ding.wav&quot;<br>
    MMControl1.Command = &quot;open&quot;<br>
    End Sub<br>
    '以下是为图形标识Play事件编写的代码<br>
    Private Sub MMControl_playclick(cancel As Integer)<br>
    MMControl1.Command = &quot;play&quot;<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 当运行这个程序时，MMControl控件中的Play键被激活，点取此按钮即可播放ding.wav文件。<br>
    在实际的软件设计当中，更多的情况是鼠标点击按钮或图标来控制声音的播放, 
    其实现方法是这样的：首先将MMControl控件的VISIBLE属性设置为FALSE,然后在图标或按钮的单击事件中编写如下的程序：<br>
    Private Sub Control1_Click()<br>
    MMControl1.Command = &quot;play&quot;<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 运行程序时单击相用的按钮或图标，WAV文件照样可以播放。用自行设计的按钮或图标取代多媒体控件中的固定按钮，可设计出更加灵活方便的用户界面。<br>
    &nbsp;&nbsp;&nbsp; 三、利用VB的API函数<br>
    &nbsp;&nbsp;&nbsp; 在窗体的DECLARATIONS(声明)中输入如下代码：<br>
    Private Declare Function sndPlaySound Lib &quot;winmm.dll&quot; Alias 
    &quot;sndPlaySoundA&quot; (ByVal_lpszSoundName As String, ByVal uFlags As Long) As Long<br>
    'lpszSoundName是一个字符串变量，表示一个WAV格式的文件名。<br>
    'uFlags 用于设定播放状态的各种选项。参数值为0X00时，实现同步播放，参数值为0X01时实现非同步播放。<br>
    在命令按钮的单击事件中输入如下代码：<br>
    Private Sub Command1_Click()<br>
    Dim plays As Long<br>
    plays = sndPlaySound(“E:\WINDOWS\MEDIA\DING.WAV&quot;, ＆H0)<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 运行时单击命令按钮即可播放WAV文件。</p>
    <p align="left">　</td>
  </tr>
</table>
</center></div>
</body>
</html>
