<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style>
<!--
        A:link {text-decoration: none; font-size:9pt;color: "#008080"}
        A:visited {text-decoration: none;font-size:9pt; color: "#008080"}
        A:active {text-decoration: none;font-size:9pt;color: "#00ffff"}
        A:hover {text-decoration: underline;font-size:9pt; color: "#ff0000"}
-->
</style>
<title>QB运用递归法一例</title>
</head>

<body leftmargin="3"
style="color: rgb(0,128,128); font-family: 宋体; font-size: 9pt; line-height: 17px">
<div align="center"><center>

<table border="0" cellspacing="2" cellpadding="0" width="95%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt"><font color="#000000">现在的位置是： </font><b><font
    color="#0000FF"><a href="Vbidx099.htm">Visual Basic</a></font><font color="#000000"> 
    &nbsp; &gt;</font></b> </span><font color="#000000">QB运用递归法一例</font></td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#E8E8E8"
bordercolor="#C48C59" cellpadding="2">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<p align="center"><strong><font color="#000000">QB运用递归法一例</font></strong></p>
    <p align="center"><font color="#000000">苗辉</font></p>
    <p align="left"><font color="#000000">&nbsp;&nbsp;&nbsp; 
    递归法是程序设计中的一个难点，对BASIC语言来讲更是如此。实际上QuickBASIC和VB都已经支持了程序的递归调用，编写递归程序也方便多了。<br>
    &nbsp;&nbsp;&nbsp; 
    下面就举一个画树的例子，编程的目的是用递归法画一棵三叉树，树枝、树叶采用不同颜色，以下QBASIC程序直接执行即可动态地画出一棵很真实的树。<br>
    源程序如下：<br>
    DECLARE SUB JIAO (JAO!)：DECLARE SUB tree(C!)<br>
    SCREEN 12<br>
    DIM SHARED J<br>
    DRAW “BM320，460”：CALL tree(440)<br>
    PLAY “T255L 16Xcdefgab”<br>
    END<br>
    SUB JIAO (JAO)'此程序用来将画笔转一定角度。<br>
    J=J＋JAO<br>
    IF J&gt;360 THEN J=J360<br>
    IF J&lt;－360 THEN J=J＋360<br>
    DRAW “TA=”＋VARPTR＄(J)<br>
    PLAY “T255P64”’此句仅为放慢速度。<br>
    END SUB<br>
    SUB tree(C) ’画树子程序。<br>
    IF C&lt;18 THEN DRAW“C2NU=”＋VARPTR＄(C):EXIT SUB ’画完树叶后返回。<br>
    C3=C／3<br>
    DRAW “C4U=”＋VARPTR＄(C3)<br>
    CALL JIAO(45):CALL tree(C／2) ’逆时针转45度后画左子树。<br>
    CALL JIAO(－45):CALL tree(2＊C／3) ’顺时针转45度后画中子树。<br>
    CALL JIAO(－45):CALL tree(C／2) ’顺时针转45度后画右子树。<br>
    CALL JIAO(45) ’逆时针转45度后回到原方向。<br>
    DRAW “C7D=”＋VARPTR＄(C3)<br>
    END SUB<br>
    </font><br>
    </td>
  </tr>
</table>
</center></div>
</body>
</html>
