<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0035)http://kiticli.163.net/vb/zhuce.htm -->
<HTML><HEAD><TITLE>怎样存取注册表信息</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META content="Microsoft FrontPage 4.0" name=GENERATOR></HEAD>
<BODY background=vb3.files/404.htm leftMargin=0 topMargin=0>
<DIV align=center>
<CENTER>
<TABLE border=0 cellPadding=0 cellSpacing=0></TBODY>
  <TBODY></TBODY></TABLE></CENTER></DIV>
<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="95%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progmenu.htm">编程技巧</a> --&gt; 
      <a href="Vbidx099.htm">Visual Basic</a> --&gt;</b></span><B>  
      </B>怎样存取注册表信息</td> 
  </tr> 
</table> 
</center></div><div align="center"><center> 
 
<table border="1" width="95%" style="font-size: 9pt" bgcolor="#FFFFFF" 
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF"> 
  <tr> 
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30" 
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000" 
    bordercolordark="#FFFFFF"> 
      <tr> 
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font 
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank" 
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td> 
      </tr> 
    </table> 
    </td> 
  </tr> 
  <tr> 
    <td width="100%"><SPAN  
      style="FONT-FAMILY: 宋体; FONT-SIZE: 9pt; LETTER-SPACING: 1px; LINE-HEIGHT: 20px"> 
      <P align=center class=ourfont></SPAN><B>怎样存取注册表信息  
      </B><SPAN  
      style="FONT-FAMILY: 宋体; FONT-SIZE: 9pt; LETTER-SPACING: 1px; LINE-HEIGHT: 20px"></P></SPAN> 
      <P align=left class=ourfont><FONT color=#000000><SPAN  
      style="FONT-FAMILY: 宋体; FONT-SIZE: 9pt; LETTER-SPACING: 1px; LINE-HEIGHT: 20px">&nbsp;&nbsp;&nbsp;&nbsp;应用程序在启动和运行时需要将一些重要的信息保存起来，以便在下次启动和运行时使用。在Windows16位操作系统中，使用系统初始化文件(INI)来存取重要参数。在微软WIN95及最新的WIN98系统中，却是采用注册表来存放应用程序的启动及运行所需的重要参数。  
      <BR>　　注册表的存取方法一般有以下两种： 
      <BR>　　一、使用WIN95提供的注册表编辑器。使用方法为：点“开始”，选“运行”，打开“regedit”，回车即可进入注册表编辑器。使用它提供的新建、删除及修改等功能来完成对注册表的存取操作。但一定要注意预先备份注册表。 
      <BR>　　二、编程实现。可以采用WIN95  
      API中有关注册表编辑的几个函数来读写注册表，但是技巧性很强，万一操作不当，则可能破坏注册表，造成系统下次启动或某些程序运行故障。  
      <BR>　　下面我利用VB5.0提供的两个语句和两个函数来读写注册表，它们的使用方法十分简单，而且很实用。 
      <BR>　　1、SaveSetting语句 <BR>　　语法：SaveSetting appname,section,key,setting  
      <BR>　　2、GetAllSettings函数 <BR>　　语法：GetAllSettings (appname,section)  
      <BR>　　3、GetSetting函数 <BR>　　语法：GetSetting(appname,scetion,key[,default]) 
      <BR>　　4、DeleteSetting语句 <BR>　　语法：DeleteSetting appname,section,[key]  
      <BR>　　参数含义： <BR>　　appname：字符串表达式，应用程序名 <BR>　　section：字符串表达式，小节名 <BR>　　key：  
      字符串表达式，关键字名 <BR>　　setting：表达式，关键字设定值 
      <BR>　　下面通过实例来说明它们的用法：应用程序名为jld_app，小节名为startup，关键字为left。 
      <BR>　　在注册表中建立应用程序的注册项： <BR>　　SaveSetting “jld_app”,“startup”,“left”,100  
      <BR>　　从应用程序注册表项中读取所有关键字及其对应的值： <BR>　　Dim mysettings(10,10)As Variant  
      <BR>　　Dim settingindex As Integer <BR>　　GetAllSettings “jld_app”,“startup”  
      <BR>　　 For settingindex=LBound(mysettings,1)To UBound(mysettins,1) <BR>　　  
      Debug.Print mysettings(settingindex,0);“=”;mysettings(settingindex,1)  
      <BR>　　 Next settingindex <BR>　　End Sub <BR>　　从应用程序注册表项中读取关键字“left”的设置： 
      <BR>　　Debug.Print GetSetting(“jld_app”，“startup” ，“left”，“not ok”)  
      <BR>　　从WIN95注册表中删除小节“startup” <BR>　　DeleteSetting“jld_app”，“startup” 
      <BR>　　(西安  
蒋立冬)</SPAN></FONT></P>　</td> 
  </tr> 
</table> 
</center></div> 
  <p>　</p> 
</BODY></HTML> 
