<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style>
<!--
        A:link {text-decoration: none; font-size:9pt;color: "#008080"}
        A:visited {text-decoration: none;font-size:9pt; color: "#008080"}
        A:active {text-decoration: none;font-size:9pt;color: "#00ffff"}
        A:hover {text-decoration: underline;font-size:9pt; color: "#ff0000"}
-->
</style>
<title>一组VB实用小程序</title>
</head>

<body leftmargin="3"
style="color: rgb(0,128,128); font-family: 宋体; font-size: 9pt; line-height: 17px">
<div align="center"><center>

<table border="0" cellspacing="2" cellpadding="0" width="95%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt"><font color="#000000">现在的位置是： </font><a
    href="Vbidx099.htm" tppabs="http://person.zj.cninfo.net/~lifu/index.html"><font
    color="#0000FF">Visual Basic</font></a><font color="#000000"><b>&nbsp; &gt;</b></font> <font
    color="#000000">一组VB实用小程序</font></span></td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#E8E8E8"
bordercolor="#C48C59" cellpadding="2">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<p align="center"><font size="1" color="#000000"><span
    style="font-size: 9pt">一组VB实用小程序</span></font></p>
    <p align="center"><font color="#000000">顾伟义</font></p>
    <p><font color="#000000">&nbsp;&nbsp;&nbsp; 用VB实现编程离不开函数调用及Windows 
    API函数的调用，以下是笔者收集的一些实用的小例程，它们可以直接用在你的实际编程中，也可以根据实际应用加以扩充完善。其中涉及Windows 
    API函数调用的代码你可以从VB5.0系统的API函数查看器中复制函数定义内容，以避免出错。<br>
    &nbsp;&nbsp;&nbsp; 1.系统型表单<br>
    &nbsp;&nbsp;&nbsp; 
    系统型意味着用户完成当前表单操作之前无法进行其它操作，这对于编制系统口令保护界面尤为重要。如果你希望当前表单系统型表单，需如下定义API函数：<br>
    Declare Function SetSysModalWindow Lib &quot;User&quot; (ByVal hWnd As Integer) As Integer<br>
    然后调用：oldSysModal = SetSysModalWindow([Form].hWnd)<br>
    &nbsp;&nbsp;&nbsp; 2.获取驱动器类型<br>
    代码如后：<br>
    Declare Function GetDriveType Lib “Kernel&quot; (ByVal nDrive As Integer) As Integer<br>
    Global Const DRIVE_REMOVEABLE％ = 2, DRIVE_FIXED％ = 3<br>
    Global Const DRIVE_REMOTE％ = 4<br>
    &nbsp;&nbsp;&nbsp; 3.表单在对中<br>
    &nbsp;&nbsp;&nbsp; 
    本子程序功能使表单定位在屏幕中央，在表单中任何需要表单对中的地方只需加入一行代码：<br>
    “centerwindow.me”即可成功调用。<br>
    Public Sub CenterWindow(f As Form)<br>
    f.Top = (Screen.Height ＊ .5) － (f.Height ＊ .5)<br>
    f.Left = (Screen.Width ＊ .5) － (f.Width ＊ .5)<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 4. 定义变量 <br>
    许多的程序员习惯于如下定义变量：<br>
    Dim iNum, iNextNum, iLastNum as Integer <br>
    &nbsp;&nbsp;&nbsp; 
    实际上只有最后一个变量被设为了整型，前两个变量则是系统的缺省的Variant 
    数据类型，而Variant 
    数据类型可用来替换任何数据类型，显然对于精练的程序设计是不利的。 
    正确的方法如下： <br>
    Dim iNum as Integer <br>
    Dim iNextNum as Integer <br>
    Dim iLastNum as Integer <br>
    &nbsp;&nbsp;&nbsp; 5. 使文本高亮<br>
    &nbsp;&nbsp;&nbsp; 
    本子程序使被触发的诸如文本，标签等控件的文本被选中<br>
    Public Sub SetSelected()<br>
    Screen.ActiveControl.SelStart = 0<br>
    Screen.ActiveControl.SelLength = Len(Screen.ActiveControl.Text)<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 6. 关闭其它程序<br>
    下面的代码可关闭内存中的其它程序<br>
    title = &quot;MyAPP&quot; '定义你需关闭的程序窗口的标题<br>
    ihWnd = findWindow(0＆, Title)<br>
    ihTask = GetWindowTask (ihWnd)<br>
    iRet = PostAppMessage(ihTask, WM_QUIT, 0, 0＆)<br>
    &nbsp;&nbsp;&nbsp; 7. 文件存在否?<br>
    &nbsp;&nbsp;&nbsp; 本函数返回查找的文件是否存在。<br>
    Function FileExist(Filename as string) as Boolean<br>
    FileExist = IIf(Dir(Filename) &lt;&gt; &quot;&quot;, True, False)<br>
    End Function<br>
    &nbsp;&nbsp;&nbsp; 8. 主程序唯一<br>
    &nbsp;&nbsp;&nbsp; 
    用下面提供的代码作你的主程序可防止应用程序的多重执行，你应当将它放在确信需要它的代码模块内。<br>
    Public Sub Main()<br>
    If App.PrevInstance Then<br>
    BringWindowToTop frmMain.hwnd <br>
    Else<br>
    Load frmMain<br>
    End If<br>
    End Sub<br>
    &nbsp;&nbsp;&nbsp; 
    上面这些精悍的代码对于专业程序员来说非常有实用价值，希望你能从中获得启发。<br>
    </font></p>
    <p>　</td>
  </tr>
</table>
</center></div>
</body>
</html>
