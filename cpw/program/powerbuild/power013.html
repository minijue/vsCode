<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="pow_idx.htm">        
    PowerBuilder</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">PB中数据窗口的两点应用技巧<br>
      <br>
                   人民银行咸宁地区中心支行   陈苇       
      <p>----PowerBuilder是大家公认的、最佳的数据库前端开发工具之一，数据窗口（Datawindow）是PowerBuilder中的关键技术，它能够灵活的组织数据库中的各种数据，用户能用一个简单的查询窗口就可以得到丰富的查询结果，并且能够对查询结果集通过程序控制，得出各种用户想得到最终结果。如果能够熟练的运用数据窗口这一专利技术，这无疑会给开发人员和用户带来巨大的方便。我们用PowerBuilder开发过一些应用系统，在开发过程中也积累了一些数据窗口的应用技巧，现提供给各位，希望能够在您的开发过程中提供一定的帮助。<br> 
      <br> 
      ----在开发应用系统的时候，数据窗口中用户焦点要从一个字段转移到另外一个字段的时候，只能用Tab键来实现，而用户通常是用回车键来改变焦点，为了保持用户的习惯，在系统中实现良好的用户操作界面，我们就必须实现在数据窗口中用Enter代替Tab在字段间移动。实现方法：<br> 
      <br> 
      ----1）您需要创建一个可视的用户对象（UserObject），在标准（Standard）对象中选择DataWindow。<br> 
      <br> 
      ----2）选择Declare菜单项中的User Events子菜单，定义一个用户事件，取用户事件名为pb_enter（事件名可任意指定），事件号（EventID）选择pbm_dwnprocessenter（此事件号不能任意指定）。点OK按纽退回。<br> 
      <br> 
      ----3）在创建的用户对象上单击鼠标右键，选择弹出菜单上的Scripts项来编写程序，在select event上选择你刚才定义的pb_enter事件，在编辑窗中输入以下两条语句后退出：<br> 
      Send(Handle(this),256,9,Long(0,0))&nbsp;<br>
      return 1&nbsp;<br>
      <br>
      ----4）给你的用户对象取一个名字后保存即可。<br>
      <br>
      ----在你新建窗口需要用到数据窗口对象时，你就可以把你所定义的用户对象放入你的窗口中来代替PB提供的数据窗口对象，它就可以实现用Enter代替Tab在字段间移动。<br>
      <br>
      ----我们在PowerBuilder应用程序的开发过程中,使用数据窗口时,经常会遇到某列的数据太长,不能同时全部显示的情况.若采用自动水平滚动,操作起来又不够简便.下面介绍一种方法,实现列数据多行显示,即实现列数据的自动折行.<br>
      具体步骤如下:<br>
      ----1)打开一个数据窗口。<br>
      <br>
      ----2)在需设定自动折行的列上双击鼠标,弹开此列的属性窗口。<br>
      <br>
      ----3)选择Position标签,选中Autosize Height复选框。&nbsp;<br>
      <br>
      ----4)选择Edit标签, 不选中Auto Horz Scroll复选框。&nbsp;<br>
      <br>
      ----5)单击OK按钮,保存所做的修改。<br>
      <br>
      ----6)点中Detail带(写有Detail的灰色长带),单击鼠标右键,选择Properties<br>
      菜单项。<br>
      <br>
      ----7)选中Autosize Height复选框。<br> 
      <br> 
      ----8)单击OK按钮,保存所做的修改。<br> 
      <br> 
      ----9)保存此数据窗口。<br> 
      <br> 
      ----注意:连在一起的汉字(中间没有标点或空格分隔),系统将认为是一个单词,不会自动进行折行。      
    </td>      
  </tr>      
</table>      
</center></div>      
 
</body> 
 
</html> 
