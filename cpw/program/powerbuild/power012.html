<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="pow_idx.htm">        
    PowerBuilder</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">在PowerBuilder中利用动态链接库控制鼠标的移动<br>
      <br>
                  长沙左家垅省计量局   傅胜</p> 
      <p>---- PowerBuilder 为 程 序 员 提 供 了 改 变 鼠 标 形 状的 方 法， 
      却 没 有 提 供 控 制 鼠 标 移 动 位 置 的 方法。 其 实 在Windows 95 
      系 统 中， 已 经 为 程 序 员 提供 了 控 制 鼠 标 位 置 的 方 法， 
      利 用USER32.DLL 动 态链 接 库 中 的SetCursorPos() 函 数 就 可 以 
      灵 活 控 制鼠 标 的 位 置。&nbsp;<br>
      <br>
      ---- 动 态 链 接 库(dynamic link library, DLL ) 是Windows中 最 重 
      要 的 部 分 之 一, Windows 中 的 运 行 程 序 可以 共 享DLL 中 的 
      函 数 和 子 例 程, 从 而 使 应 用 程 序可 以 共 享 代 码, 减 少 
      内 存 占 用。&nbsp;<br>
      <br>
      ---- 要 在PowerBuilder 中 调 用 外 部 函 数， 必 须 先 声明 它。 
      有 两 种 类 型 的 外 部 函 数： 全 局 外 部 函 数和 局 部 外 部 
      函 数。 全 局 外 部 函 数 可 以 在 应 用程 序 的 任 何 地 方 声 
      明 使 用。 它 们 在 应 用 程 序中 与 其 他 全 局 变 量 一 起 保 
      存。 局 部 外 部 函 数可 以 为 窗 口， 菜 单， 用 户 对 象 定 义， 
      它 们 是 对象 定 义 的 一 部 分。<br> 
      <br> 
      ---- 定 义 外 部 函 数 的 语 法 如 下 所 示：&nbsp;<br>
      <br>
      {Access} Function ReturndataType Name({REF}{DataType]Arg],...<br> 
      DataTypeN ArgN}] Library LibName<br> 
      参数 描述<br> 
      Access （只有在定义局部外部函数时使用）<br> 
      可定义为Public, Protected或者<br> 
      Private。缺省情况为Public。<br> 
      ReturnDataType 函数的返回类型。<br> 
      Name 函数名。<br> 
      DataType1到 参数类型。<br> 
      DataTypeN 如果是传值，可直接将参数写上。<br> 
      如果是传参数，要在参数类型前加<br> 
      上一个关健字REF。<br> 
      Arg1到 参数名。<br> 
      ArgN<br> 
      LibName 动态链接库名。<br> 
      <br> 
      在PowerBuilder的主菜单上选取<br> 
      "Declare"的菜单项，然后选择子菜单项<br> 
      "Global External Function"，<br> 
      在定义全局外部函数对话框中，输入：<br> 
      FUNCTION long SetCursorPos(long x,long y) LIBRARY "USER32.dll"<br> 
      <br> 
      ---- 注 意： 对 于 关 键 字"SetCursorPos" 中 的 大 小 写 字 母 必 
      须 严 格 区 分。&nbsp;<br>
      <br>
      ---- 这 样， 程 序 员 就 可 以 在 应 用 程 序 的 任 何 位 置 使 
      用 该 函 数 了， 例 如 要 将 鼠 标 定 位 到 屏 幕 中 央， 则 在 
      程 序 中 加 入SetCursorPos(320,240)， 这 里 假 设 当 前 屏 幕 的 
      分 辨 率 为640*480。&nbsp;<br>
      <br>
      ---- 当 然， 我 们 还 可 做 更 复 杂 的 控 制。 例 如 要 使 用 户 
      在 单 行 编 辑 器 中 输 入 完 后， 鼠 标 定 位 到"OK" 按 钮 上， 
      则 在 单 行 编 辑 器 的losefocus 事 件中 输 入：&nbsp;<br>
      <br>
      long x1,y1<br> 
      x1=(w_genapp_about.x+cb_ok.x+cb_ok.width/2)<br> 
      x1=UnitsToPixels(x1, XUnitsToPixels!)<br> 
      // 获 取"OK" 按 钮 的X 坐 标;<br> 
      y1=(w_genapp_about.y+cb_ok.y+cb_ok.height/2+100)<br> 
      y1=UnitsToPixels(y1, YUnitsToPixels!)<br> 
      // 获 取"OK" 按 钮 的Y 坐 标;<br> 
      SetCursorPos(x1,y1)<br> 
      <br> 
      ---- 如 果 要 使 鼠 标 从 坐 标(100,200) 移 到 坐 标(500,200)， 
      并 产 生 动 画 效 果， 则 编 程 如 下：&nbsp;<br>
      <br>
      long i,j<br> 
      for i=100 to 500<br> 
      SetCursorPos(i,200)<br> 
      for j=1 to 999 //起延时作用，可根据实际情况调整；<br> 
      next<br> 
      next<br> 
      <br> 
      ---- 灵 活 地 控 制 鼠 标 位 置， 能 使 程 序 更 加 有 趣， 对 用 
      户 也 更 友 好。      
    </td>     
  </tr>     
</table>     
</center></div>     

</body>

</html>
