<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title></title>
</head>

<body background="../../res/back.JPG">
<div align="center"><center>

<table border="0" width="560" height="4" cellspacing="0" cellpadding="0">
  <tr>
    <td width="570" height="8"><span style="font-size: 9pt"><font face="宋体" size="2"><p
    align="center"></font><strong>Foxpro中实现光学符号阅读器阅卷结果的评分处理</strong></span></td>
  </tr>
  <tr>
    <td width="570" height="9"><span style="font-size: 9pt"><p align="center">(广东: 
    朱铮涛 李 扬)</span></td>
  </tr>
  <tr>
    <td width="570" height="8"><span style="font-size: 9pt"><p align="center">录入:江湖小子</span></td>
  </tr>
</table>
</center></div>

<p><span style="font-size: 9pt">在标准化考试中，光学符号阅读器是通过阅读考生填涂的答题卡将考生答题结果自动录入计算机的一种硬件设备，配以相应的软件，就可组成标准化考试的阅卷及评分统计处理系统。该系统具有高速、高可靠性、高准确度的&quot;三高&quot;特点，因而在标准化考试中得到了广泛的引用。<br>
考生的答题信息进入计算机后，需要用接口软件作相应处理才能得出考分的多少，下面给出用Foxpro语言编制评分接口软件的步骤和原程序。<br>
<br>
1.建立标准答案库(da.dbf),<br>
包括题号、答案、多项选择标志、多项选择转换答案、每题得分, 
数据结构为:<br>
<br>
题号： X1 C 3<br>
答案： X2 C 4<br>
得分： X3 N 3.1<br>
多项选择标志： X4 C 1<br>
多项选择转换答案： X5 C 5<br>
<br>
2.建立学生得分库(df.dbf), 包括答卷信息、考号、得分, 数据结构为:<br>
答卷信息： TT C 254<br>
考生考号： KH C 8<br>
考生得分： FEN N 5.2<br>
由于选择题的类型不外乎两种:1)单项选择, 2)多项选择,<br>
对于第一种情况, 可直接用FOXPRO提供的命令作出正确与否的评判。为了使多项选择的题目也能用FOXPRO命令处理, 
需要对标准答案作一点技术上的变动。<br>
1)多项答案为两个, 如ab, 则答到ab的给全分, 而答了a或b应该给一半分,可用这样的语句实现:<br>
设AA为学生答卷内容, BB为标准答案, CC为该题占分, DD为最终得分。<br>
if at(AA,BB)&lt;&gt;0<br>
DD=len(AA)/len(BB)*CC<br>
endi <br>
2)多项答案为三个, 如abc, 则答到abc的给全分,<br>
答到ab、bc或ac的得到三分之二分,<br>
答到a、b或c的给三分之一分。但由于用上述语句对于答到ac的情况将得不到分，因而对于多项选择题, 
除了在答案库中给出多项选择标志外,程序运行后还应自动将标准答案变为多项选择转换答案,以便与第一种情况一样记分。方法为, 
二个答案的选择转换答案不变,三个答案的则多项选择转换答案为原答案加上头尾两个, 
即若标准答案为abc, 多项选择转换答案为abcac,评分方法见源程序。<br>
3)程序清单<br>
private i,j,k,len,n,all,allrec<br>
dim bb(110) *数组bb用于存放考生的考号和每题的实际答题信息*<br>
if !file(&quot;first1.res&quot;) *假设阅卷结果的文本文件名为first1.res*<br>
wait wind &quot;请把阅卷结果文件first1.res拷入当前子目录!&quot; nowait<br>
return <br>
endi<br>
if !used(&quot;da&quot;)<br>
use da in 0<br>
endi<br>
sele da *完成多项选择的答案转换*<br>
scan<br>
if x4==&quot;*&quot; and len(x2)=3<br>
replace x5 with x2+substr(x2,1,1)+substr(x2,3,1)<br>
endif<br>
if x4==&quot;*&quot; and len(x2)=2<br>
replace x5 with x2<br>
endif<br>
ends<br>
if !used(&quot;df&quot;)<br>
use df in 0<br>
endif<br>
sele df<br>
*清除df库的记录，并将阅卷结果文件中各考生的答题结果作为记录放入df<br>
库的答卷信息字段TT中*<br>
zap<br>
append fields tt from first1.res sdf<br>
*从TT中分解出考号，每题答案并计分，文本文件中考生的考号、每题答案之间<br>
用&quot;,&quot;间隔，最后，考号和得分分别放于kh和fen字段。*<br>
scan<br>
len=len(df.tt)<br>
i=1<br>
j=1<br>
n=0<br>
all=0<br>
for k=1 to len<br>
n=n+1<br>
if substr(df.tt,k,1)==&quot;,&quot;<br>
bb(j)=substr(df.tt,i,n-1)<br>
i=k+1<br>
j=j+1<br>
n=0<br>
endif<br>
endf<br>
sele da<br>
scan<br>
if da.x4=space(1) <br>
jj=recno()+1<br>
if alltrim(da.x2)==alltrim(bb(jj))<br>
all=all+da.x3<br>
endi<br>
else<br>
if at(alltrim(bb(jj),da.x5)&lt;&gt;0<br>
all=all+len(bb(jj))/len(da.x2)*da.x3 <br>
endif<br>
endi<br>
ends<br>
sele df<br>
repl kh with bb(1)<br>
repl fen with all<br>
ends<br>
sele df<br>
acti scre<br>
brow fields kh:R:8:h=&quot; 考号&quot;,;<br>
fen:R:5:h=&quot;分数&quot;;<br>
title &quot;学生成绩&quot;<br>
close all<br>
return<br>
运行完上述程序后, 学生的答题信息在TT字段,<br>
考号在KH字段,得分情况在FEN 字<br>
段。上述数据库结构是针对目前常用的标准化考试最多有100题而设定，如有更多的<br>
考题可自行加大相应内容。<br>
<br>
4. 对DBFDBF进行处理，能够非常方便地统计和分析考试结果的各种信息。<br>
</span></p>
</body>
</html>
