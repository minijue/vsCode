<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="Vfp_idx.htm">VFP</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">小小点歌台&nbsp;<br>
      <br>
                               (重庆 张毅)&nbsp;      
      <p><br>
      　　MP3作为一种高压缩比的音频文件，能够让你仅在一张光盘中就拥有多达上百首的歌曲。面对如此众多的曲目，你是否希望能够快速地选择自己喜爱的歌曲播放。现在利用Visual FoxPro 5.0强大的程序设计功能，这一设想很容易就成为了现实。&nbsp;<br>
      　　首先进入VF5.0，为你的曲目创建自由表格（假设文件名为wf1.dbf），字段必须包括歌名、顺序、专辑，你也可以增添歌词、作词、作曲等。现在开始输入记录，也许你会觉得这是件苦差事，幸好VF向我们提供了添加数据的简单途径。一般来说，MP3光盘的每个专辑各为一子目录，其下的＊.txt文件即包括了各曲目的名称、顺序。打开任一文本编辑器，将各个txt文件合并为wf.txt，去掉多余部分，给每一项加上专辑名，形成如下格式：&nbsp;<br>
      　　　　　 　顺序　歌名　专辑目录名&nbsp;<br>
      　　　　　　　　　 ．&nbsp;<br>
      　　　　　　　　 　．&nbsp;<br>
      　　　　　　　 ．&nbsp;<br>
      　　在FoxPro菜单中，选择Table－>Append Record, 在type框中选择源文件格式为Delimited，间隔符为{space},在From框输入源文件名(wf.txt),完成选择OK。&nbsp;<br>
      　　打开菜单File－>New－>Project，选择code－>program,单击Modify，输入下面程序：&nbsp;<br>
      　　dimension gaMylistarray(10)&nbsp;<br>
      　　for gncount = 1 to 10&nbsp;<br>
      　　store replicate(` `,10) to gaMylistarray(gncount)&nbsp;<br>
      　　endfor&nbsp;<br>
      　　frm = createobject(`frmmyform`)&nbsp;<br>
      　　frm.visible=.t.&nbsp;<br>
      　　frm.cmd1.Visible =.t.&nbsp;<br>
      　　frm.cmd2.Visible=.t.&nbsp;<br>
      　　frm.cmdcmndBtn1.Visible =.t.&nbsp;<br>
      　　frm.cmdcmndBtn2.Visible =.t.&nbsp;<br>
      　　frm.cmdcmndBtn3.Visible =.t.&nbsp;<br>
      　　frm.caption=″点歌台″&nbsp;<br>
      　　_screen.visible=.f.&nbsp;<br>
      　　public st6,st7&nbsp;<br>
      　　use wf1.dbf shared＆＆打开歌曲数据表格&nbsp;<br>
      　　frm.show&nbsp;<br>
      　　read events&nbsp;<br>
      　　define class frmmyform as form&nbsp;<br>
      　　width=350&nbsp;<br>
      　　height=190&nbsp;<br>
      　　maxheight=200&nbsp;<br>
      　　maxwidth=350&nbsp;<br>
      　　minheight=200&nbsp;<br>
      　　minwidth=350&nbsp;<br>
      　　maxbutton=.f.&nbsp;<br>
      　　autocenter=.t.&nbsp;<br>
      　　 desktop=.t.&nbsp;<br>
      　　showwindow=2&nbsp;<br>
      　　add object cmd1 as cmd1&nbsp;<br>
      　　add object cmd2 as cmd2&nbsp;<br>
      　　add object cmdcmndBtn1 as cmdMycmndBtn1&nbsp;<br>
      　　add object cmdcmndBtn3 as cmdMycmndBtn3&nbsp;<br>
      　　add object cmdcmndBtn2 as cmdMycmndBtn2&nbsp;<br>
      　　add object lbl as label with;&nbsp;<br>
      　　 backstyle=0,;&nbsp;<br>
      　　 caption=“请输入歌名:",;&nbsp;<br>
      　　 left=25,;&nbsp;<br>
      　　 top=115&nbsp;<br>
      　　procedure unload&nbsp;<br>
      　　close all&nbsp;<br>
      　　clear events&nbsp;<br>
      　　endpro&nbsp;<br>
      　　procedure find&nbsp;<br>
      　　 parameter st1&nbsp;<br>
      　　 do while not eof()&nbsp;<br>
      　　 skip＋1&nbsp;<br>
      　　 st2=歌名&nbsp;<br>
      　　 true=this.compare(st1,st2)&nbsp;<br>
      　　 if(true=.t.)&nbsp;<br>
      　　 st6=专辑&nbsp;<br>
      　　 st7=顺序&nbsp;<br>
      　　 st3=`专辑名:`＋专辑名&nbsp;<br>
      　　 st8=`(`＋st7＋` `＋st6＋`)`&nbsp;<br>
      　　 st4=`歌名:`＋歌名&nbsp;<br>
      　　 frm.cmdcmndBtn1.enabled =.t.&nbsp;<br>
      　　 this.cmd2.value=st3＋chr(13)＋st4＋chr(13)＋st8&nbsp;<br>
      　　 return&nbsp;<br>
      　　 endif&nbsp;<br>
      　　 enddo&nbsp;<br>
      　　 go top&nbsp;<br>
      　　 this.cmd2.value=chr(13)＋` 对不起，没有这首歌`&nbsp;<br>
      　　 frm.cmdcmndBtn1.enabled =.F.&nbsp;<br>
      　　endpro&nbsp;<br>
      　　procedure compare&nbsp;<br>
      　　parameter source,tar&nbsp;<br>
      　　long1=len(source)&nbsp;<br>
      　　len1=long1/2&nbsp;<br>
      　　real=.f.&nbsp;<br>
      　　ka=0&nbsp;<br>
      　　for i=1 to long1 step 2&nbsp;<br>
      　　 sub=substr(source,i,2)&nbsp;<br>
      　　 if(sub＄tar)&nbsp;<br>
      　　 ka=ka＋1&nbsp;<br>
      　　 endif&nbsp;<br>
      　　 if(ka>0.6＊len1)&nbsp;<br>
      　　 real=.t.&nbsp;<br>
      　　 exit&nbsp;<br>
      　　 endif&nbsp;<br>
      　　next&nbsp;<br>
      　　return real&nbsp;<br>
      　　endpro&nbsp;<br>
      　　enddefine&nbsp;<br>
      　　define class cmd1 as combobox&nbsp;<br>
      　　 left=90&nbsp;<br>
      　　 top=110&nbsp;<br>
      　　 width=150&nbsp;<br>
      　　 height=20&nbsp;<br>
      　　 MultiSelect = .t.&nbsp;<br>
      　　 autosize=.t.&nbsp;<br>
      　　 RowSourcetype = 5&nbsp;<br>
      　　 RowSource = `gaMylistarray`&nbsp;<br>
      　　 proce click&nbsp;<br>
      　　 activate screen&nbsp;<br>
      　　 clear&nbsp;<br>
      　　 for ncnt = 1 to thisform.cmd1.listcount&nbsp;<br>
      　　 if thisform.cmd1.Selected(ncnt)&nbsp;<br>
      　　 text=thisform.cmd1.list(ncnt)&nbsp;<br>
      　　 endif&nbsp;<br>
      　　 endfor&nbsp;<br>
      　　 endpro&nbsp;<br>
      　　 procedure interactivechange&nbsp;<br>
      　　 go top&nbsp;<br>
      　　 frm.find(trim(frm.cmd1.text))&nbsp;<br>
      　　 endpro&nbsp;<br>
      　　enddefine&nbsp;<br>
      　　define class cmd2 as textbox&nbsp;<br>
      　　 left=55&nbsp;<br>
      　　 top=30&nbsp;<br>
      　　 width=210&nbsp;<br>
      　　 height=65&nbsp;<br>
      　　 enabled=.F.&nbsp;<br>
      　　 fontsize=12&nbsp;<br>
      　　 disabledforecolor=0&nbsp;<br>
      　　enddefine&nbsp;<br>
      　　define class cmdMycmndBtn1 as commandButton&nbsp;<br>
      　　 caption = `播放　　 left = 20&nbsp;<br>
      　　 top = 150&nbsp;<br>
      　　 height = 25&nbsp;<br>
      　　 enabled=.F.&nbsp;<br>
      　　 num1=1&nbsp;<br>
      　　 procedure click&nbsp;<br>
      　　 if(this.num1=11)&nbsp;<br>
      　　 this.num1=1&nbsp;<br>
      　　 endif&nbsp;<br>
      　　 gaMylistarray(this.num1)=歌名&nbsp;<br>
      　　 this.num1=this.num1＋1&nbsp;<br>
      　　 ＊运行你的MP3播放器,包括盘符、路径。（这里采用mp2win5）。&nbsp;<br>
      　　 ＊假设i盘为光驱，(track)是文件名公用部分。&nbsp;<br>
      　　run/n d:maplaymp2win5 i:list7	rack＆st6..mp3&nbsp;<br>
      　　endpro&nbsp;<br>
      　　enddefine&nbsp;<br>
      　　define class cmdMycmndBtn2 as commandButton&nbsp;<br>
      　　 caption = `查找　　 left = 230&nbsp;<br>
      　　 top=150&nbsp;<br>
      　　 height = 25&nbsp;<br>
      　　 procedure click&nbsp;<br>
      　　 frm.find(trim(frm.cmd1.text))&nbsp;<br>
      　　 endpro&nbsp;<br>
      　　enddefine&nbsp;<br>
      　　define class cmdMycmndBtn3 as commandButton&nbsp;<br>
      　　 caption=`结束(《Q)`&nbsp;<br>
      　　 cancel = .t.&nbsp;<br>
      　　 left = 125&nbsp;<br>
      　　 top = 150&nbsp;<br>
      　　 height = 25&nbsp;<br>
      　　 procedure click&nbsp;<br>
      　　 close all&nbsp;<br>
      　　 clear events&nbsp;<br>
      　　 endpro&nbsp;<br>
      　　enddefine&nbsp;<br>
      　　选择program－>compile,编译成功的一个‘小小点歌台’就做成了。程序运行后，输入你所需的歌曲，计算机会进行动态查找。如果没有找到，单击查找，继续搜索。一旦找到，单击播放按钮，所点歌曲即被播放。并且每次播放的歌曲都会被收入列表菜单中（可多达10首），以便下次重放。怎么样，赶快去试试吧！ 
    </td>     
  </tr>     
</table>     
</center></div>     
<p>　</p>

</body>

</html>
