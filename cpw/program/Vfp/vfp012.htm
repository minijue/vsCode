<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body stylesrc="../../index1.htm" background="../../res/back.gif">

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="95%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      Visual Foxpro --&gt; </b> </span>提高FoxPro应用程序的智商</td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#FFFFFF"
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">
  <tr>
    <td width="15%" align="center" valign="top"><!--webbot bot="Include"
      U-Include="../progmenu.htm" TAG="BODY" startspan -->

<table border="1" width="13%" bordercolor="#000000" cellspacing="3" cellpadding="3" style="font-size: 9pt; border-style: solid; border-color: #FFFFFF">
  <tr>
    <td width="100%" align="center"><a href="../VisualC/Vcidx098.htm" target="_self"><strong>Visual 
      C</strong></a></td> 
  </tr> 
  <tr> 
    <td width="100%" align="center"><a href="../Vb/Vbidx099.htm" target="_self"><strong>VBasic</strong></a></td>
  </tr>
  <tr>
    <td width="100%" align="center"><strong><a href="Vfp_idx.htm" target="_self">VFoxpro</a></strong></td>
  </tr>
  <tr>
    <td width="100%" align="center"><strong><a href="../Delphi/Del_idx.htm" target="_self">Delphi</a></strong></td>
  </tr>
  <tr>
    <td width="100%" align="center"><a href="../powerbuild/pow_idx.htm" target="_self"><b>PowerBuilder</b></a></td>
  </tr>
  <tr>
    <td width="100%" align="center"><a href="../linux/linuxidx.htm" target="_self"><b>Linux</b></a></td>
  </tr>
  <tr>
    <td width="100%" align="center"><strong><a href="../other/oth_idx.htm" target="_self">其它</a></strong></td>
  </tr>
</table>
<!--webbot bot="Include" endspan i-checksum="38391" -->

    </td>
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"
    bordercolordark="#FFFFFF">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>
      </tr>
    </table>
      <p align="center"><b>提高FoxPro应用程序的智商&nbsp;</b></p>
      <p><br>
      　　你是否有这样的感受：编好一个应用程序之后，分发时还得带上一大堆DBF、IDX、MEM文件，十分麻烦。而且这些文件还很娇气，如果用户误删了其中一个，程序马上罢工。我这里告诉大家一个办法，就是提高FoxPro应用程序的IQ值，让它自己检测工作目录中是否存在所需要的DBF、IDX等文件，若有就可万事大吉，顺利工作；若没有则利用FoxPro仅能支持的几条SQL语句(CREATE TABLE、INSERT INTO)，自动创建数据库、添加数据和建立索引。这样，你的应用程序分发时就可以精简到一个EXE文件，因为这个EXE文件在第一次运行时，会自动帮助你建立所需的数据库、索引和添加数据库记录。而且，当用户误删了这些文件时，应用程序也会重建它们，不会导致程序不能运行。当然，有些数据还须重新输入。<br> 
      　　<br>
      　　本文以一个文书档案管理系统为例加以说明：这个系统需要三个数据库文件：卷内文件目录库jlwjml.dbf(按案卷号＋顺序号建立索引)、单位库dwk.dbf、保管期限库bgqxk.dbf(含有永久、长期、短期三条记录)，在主程序的初始化部分加入如下程序即可：<br>
      <br>
      　　CLOSE DATABASE&nbsp;<br>
      　　IF !FILE(`jlwjml.dbf`)&nbsp;<br>
      　　CREATE TABLE jlwjml ;&nbsp;<br>
      　　(案卷号N(4),顺序号N(3),文号C(30),;&nbsp;<br>
      　　责任者C(20),题名C(90),日期D,保管期限C(4),页号N(3),备注C(20))&nbsp;<br>
      　　INDEX ON str(案卷号,4)＋str(顺序号,3) to jlwjmlsy&nbsp;<br>
      　　ENDIF&nbsp;<br>
      　　IF !FILE(`jlwjmlsy.idx`)&nbsp;<br>
      　　INDEX ON str(案卷号,4)＋str(顺序号,3) to jlwjmlsy&nbsp;<br>
      　　ENDIF&nbsp;<br>
      　　IF !FILE(`dwk.dbf`)&nbsp;<br>
      　　CREATE TABLE dwk (单位名C(30))&nbsp;<br>
      　　ENDIF&nbsp;<br>
      　　IF !FILE(`bgqxk.dbf`)&nbsp;<br>
      　　CREATE TABLE bgqxk (保管期限C(4))&nbsp;<br>
      　　INSERT INTO bgqxk (保管期限) VALUES (`永久`)&nbsp;<br>
      　　INSERT INTO bgqxk (保管期限) VALUES (`长期`)&nbsp;<br>
      　　INSERT INTO bgqxk (保管期限) VALUES (`短期`)&nbsp;<br>
      　　ENDIF&nbsp;<br>
      　　CLOSE DATABASE</p> 
      <p>　 
    </td> 
  </tr> 
  <tr> 
    <td width="100%" colspan="2" align="center" valign="top">　</td> 
  </tr> 
</table> 
</center></div> 
 
</body> 
 
</html> 
