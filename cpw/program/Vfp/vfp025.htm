<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="Vfp_idx.htm">VFP</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">Visual FoxPro多媒体表单设计<br> 
      <br> 
           中国地质大学资源学院信息系统研究所   韩志军&nbsp;<br>
           山西省地矿局地质矿产处               李效广       
      <p>---- 世 界 进 入 信 息 时 代 以 来， 人 们 不 得 不 对越 来 越 多 的 
      信 息 进 行 处 理 与 管 理。 其 中 既 有大 量 的 文 字 信 息， 也 包 
      括 各 式 各 样 的 静 态 图形、 动 态 图 象 和 声 音 等 多 媒 体 信 息。 
      传 统 的只 能 处 理 文 本 信 息 的 数 据 库 管 理 系 统 已 不 能适 应 
      社 会 发 展。 当 今 的 时 代 越 来 越 需 要 能 够处 理 多 媒 体 信 息 
      的 数 据 库 管 理 系 统。 而MicroSoft 推 出 的Visual FoxPro 系 统， 
      能 充 分 利 用Windows 的 设 备 无 关 性 等 优 势， 在 多 媒 体 信 息管 理 和 处 理 能 力 上 有 了 很 大 提 高。 它 的 出 现为 开 发 多 媒 
      体 程 序 提 供 了 很 大 方 便。&nbsp;<br>
      <br>
      ---- 但 从 多 媒 体 数 据 管 理 性 能 看，Visual FoxPro命 令 集 中 只 
      有 静 态 图 形 的 直 接 显 示 功 能， 动态 图 象 和 声 音 的 播 放 或 
      编 辑， 则 需 要 外 部 功能 的 支 持。 因 此， 为 了 完 成 多 媒 体 数 
      据 管 理，Visual FoxPro 提 供 了 调 用DLL （ 动 态 链 接 库） 的功 能， 
      允 许 在 应 用 程 序 中 充 分 发 挥Windows 中DLL资 源 的 优 势。 它 还 
      可 利 用Windows 提 供 的MCI(Media Control Interface) 多 媒 体 控 制 接 
      口 功 能，使 用 户 能 够 控 制 各 种 媒 体 设 备。 除 此 之 外，<br> 
      Visual FoxPro 还 支 持OLE （ 对 象 的 链 接 与 嵌 入）功 能， 用 户 可 
      利 用 各 种OLE 控 件 进 行 多 媒 体 程序 设 计。 本 文 即 以OLE 控 件 
      为 例， 简 要 介 绍Visual FoxPro 中 多 媒 体 声 音 表 单 的 设 计 方 法。&nbsp;<br>
      <br>
      一、 声 音 控 件 创 建<br> 
      <br> 
      ---- Visual FoxPro 中 有 两 种OLE 控 件， 一 种 是OLEControl（OLE 容 
      器 控 件）， 一 种 是 OLEBoundControl（OLE 绑 定 型 容 器 控 件） 。OLEBoundControl 主 要 用于 对Visual FoxPro 表 中General（ 通 用 型） 
      字 段 的 控制。 而 利 用OLEControl 控 件 创 建 的 嵌 入 式OLE 对 象， 
      可 与 表 单 构 成 一 体。 用OLEControl 控 件 创 建有 声 表 单 的 过 
      程 如 下：&nbsp;<br>
      <br>
      ---- 1. 选 择OLE 容 器 控 件&nbsp;<br>
      <br>
      ---- 首 先 在“ 表 单 设 计 器” 中 打 开 需 要 填 加 声音 对 象 的 
      表 单， 进 而 用 鼠 标 左 键 单 击“ 表 单控 件 工 具 栏” 的 按 钮， 
      选 择 添 加 该 控 件。&nbsp;<br>
      <br>
      ---- 2. 选 择 添 加 的 对 象 类 型&nbsp;<br>
      <br>
      ---- 在 表 单 上， 用 鼠 标 左 键 选 择 适 当 的 区 域，建 立OLE 控 件。 
      进 而 在 随 后 出 现 的“Insert Object” 对 话 框 中， 选 择 要 添 加 
      的 对 象 类 型（Object Type） 为“ 声 音”（ 添 加 其 它 类 型 的 多媒 体 对 象 则 应 选 择 相 应 类 别）。&nbsp;<br>
      <br>
      ---- 3. 从 现 存 文 件 添 加 对 象&nbsp;<br>
      <br>
      ---- 添 加 对 象 可 以 以“Create New” 方 式 或“CreateFrom File” 
      方 式 进 行。 如 果 选 择 以“Create FromFile” 方 式 添 加 对 象， 
      单 击“Browse” 按 钮 后， 则 出 现 “ 插入 文 件” 画 面。 选 择 相 
      应 声 音 文 件 后， 按“ 打开” 按 钮， 即 可 完 成 从 现 存 文 件 
      添 加 声 音 对象 过 程。&nbsp;<br>
      <br>
      ---- 4. 创 建 新 对 象&nbsp;<br>
      <br>
      ---- 如 果 选 择 以“Create New” 方 式 添 加 对 象， 应单 击“Insert Object” 对 话 框 的“Ok” 按 钮。 它 将启 动 声 音 编 辑 
      程 序， 对 新 文 件 进 行 录 音 或 编辑。 如 果 在“ 编 辑” 菜 单 
      上 执 行“ 插 入 文 件”项， 也 将 出 现 “ 插 入 文 件” 画面。 
      选 择 相 应 声 音 文 件 后， 按“ 打 开” 按 钮，即 可 插 入 现 存 
      文 件 进 行 编 辑。 完 成 文 件 编 辑后， 选 择 执 行“ 文 件” 菜 
      单 上“ 退 出” 功 能， 即完 成 创 建 新 声 音 对 象 的 过 程。&nbsp;<br>
      <br>
      二、 声 音 控 件 执 行 方 法<br> 
      <br> 
      ---- 1. 执 行 方 法 说 明&nbsp;<br>
      <br>
      ---- 建 立 的OLE 对 象 的 一 般 可 用DoVerb 方 法 来 执行。 该 方 
      法 应 用 于OLE 绑 定 型 容 器 控 件 和OLE 容器 控 件， 它 可 在 指 
      定 的 对 象 上 执 行 一 个 相 应动 作。 其 执 行 语 法 为：&nbsp;<br>
      <br>
      ObjectName. DoVerb([nVerb])<br> 
      <br> 
      ---- 其 中 的 ObjectName 为OLE 容 器 控 件 对 象 名 称。参 数 nVerb 
      指 定 在 OLE 容 器 控 件 中 对 象 要 执 行的 动 作 值。 如 果 没 有 
      指 定， 就 执 行 默 认 的 动作。 各 值 对 应 的 对 象 执 行 动 作 
      如 下：&nbsp;<br>
      <br>
      ---- 0 － 对 象 的 默 认 动 作。 一 般 为“ 播 放”&nbsp;<br>
      <br>
      ---- 1 － 激 活 要 编 辑 的 对 象。 如 果 创 建 对 象 的应 用 程 序 
      支 持 现 场 激 活， 就 在 OLE 容 器 控 件 中激 活 对 象。&nbsp;<br>
      <br>
      ---- 2 － 在 一 个 独 立 的 应 用 程 序 窗 口 中 打 开对 象。 如 果<br> 
      所 创 建 对 象 的 应 用 程 序 支 持 现 场激 活， 就 在 对 象 自 身&nbsp;<br>
      的 窗 口 中 激 活 对 象。&nbsp;<br>
      <br>
      ---- 3 － 对 于 嵌 入 的 对 象， 隐 藏 创 建 对 象 的 应用 程 序。&nbsp;<br>
      <br>
      ---- 4 － 如 果 对 象 支 持 现 场 激 活， 就 以 现 场 激活 方 式 激&nbsp;<br>
      活 对 象 并 显 示 任 何 用 户 界 面 工 具。如 果 对 象 不 支 持 现&nbsp;<br>
      场 激 活， 对 象 就 不 激 活 并产 生 错 误。&nbsp;<br>
      <br>
      ---- 5 － 如 果 用 户 将 焦 点 移 到 OLE 容 器 控 件 中， 就 创 建&nbsp;<br>
      一 个 窗 口， 并 准 备 要 编 辑 的 对 象。如 果 对 象 不 支 持 以&nbsp;<br>
      鼠 标 单 击 的 方 式 激 活， 就产 生 错 误。&nbsp;<br>
      <br>
      ---- 6 － 当 激 活 要 编 辑 的 对 象 时， 用 来 放 弃 所有 记 录 的&nbsp;<br>
      更 改， 对 象 的 应 用 程 序 可 以 撤 消 这些 更 改。&nbsp;<br>
      <br>
      ---- 2. 命 令 按 钮 创 建 与 设 置&nbsp;<br>
      <br>
      ---- 一 般 而 言，DoVerb（0） 用 来 播 放OLE 对 象，DoVerb（1） 用&nbsp;<br>
      来 编 辑。 为 了 能 让 用 户 在 表 单 运行 时 操 作OLE 对 象， 首&nbsp;<br>
      先 需 在 该 表 单 上 创 建 相应 的“ 播 放” 与“ 编 辑” 命 令 按&nbsp;<br>
      钮.&nbsp;<br>
      <br>
      ---- 为 了 各 按 钮 能 执 行 相 应 功 能， 应 设 置 其CLICK 事 件&nbsp;<br>
      代 码。 如 果 需 要 操 作 的OLE 对 象 名为Olecontrol1， 则“ 播 放”&nbsp;<br>
      按 钮 的CLICK 事 件 代 码应 设 为：&nbsp;<br>
      <br>
      ThisForm. OleControl1. DoVerb(0)&nbsp;<br>
      <br>
      ---- “ 编 辑” 按 钮 的CLICK 事 件 代 码 应 设 为：&nbsp;<br>
      <br>
      ThisForm. OleControl1. DoVerb(1)&nbsp;<br>
      <br>
      ---- 设 置 完 成 后， 即 可 在 表 单 运 行 时 单 击 按钮 进 行 声&nbsp;<br>
      音“ 播 放” 或“ 编 辑”。 另 外， 如 果 将OLE 对 象 的 AutoActivate&nbsp;<br>
      属 性 设 置 为 2（ 双 击），那 么 当 用 户 双 击 该OLE 容 器 控 件 时，&nbsp;<br>
      也 可 自 动激 活 该 对 象， 进 行 默 认 的 播 放 动 作。&nbsp;<br>
      <br>
      ---- 有 时 用 户 希 望 表 单 在 启 动 和 退 出 时 能 够发 出 提 示&nbsp;<br>
      声 音。 这 项 功 能 其 实 也 很 容 易 实 现－ 只 要 在 表 单 的<br> 
      Activate Event 和Dstroy Event 事 件中， 加 入 声 音 播 放 代 码：<br> 
      ThisForm. OleControl1.DoVerb(0)， 即 可 达 到 相 应 效 果。&nbsp;<br>
      <br>
      ---- 在Visual FoxPro 中 用OLE 控 件 进 行 多 媒 体 程 序设 计， 操 作&nbsp;<br>
      简 单 方 便， 但 也 有 缺 点： 它 不 能 灵活 控 制OLE 对 象， 只 能&nbsp;<br>
      进 行 简 单 的 播 放 与 编 辑功 能， 而 且 执 行 速 度 较 慢。 为 了&nbsp;<br>
      解 决 上 述 问题， 能 够 实 现 快 捷 与 多 功 能 的 多 媒 体 操 作，<br> 
      则 需 要 利 用Windows 的DLL 资 源， 用MCI 进 行 多 媒 体程 序 设 计。&nbsp;<br>
      这 种 方 法 本 文 不 再 介 绍， 各 位 读者 不 妨 自 己 设 计， 亲 自&nbsp;<br>
      体 验 其 用 法 与 功 能。      
    </td>      
  </tr>      
</table>      
</center></div>      
<p>　</p> 
 
</body> 
 
</html> 
