<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../progidx.htm">编程技巧</a> --&gt; 
      <a href="Vfp_idx.htm">VFP</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">Visual Foxpro 3.0 应用程序封面、背景及封底的制作<br> 
      <br> 
                                李湘江</p> 
      <p><br> 
      使用VFP3.0编写应用程序时，我们利用系统本身的性能可以制作出类似于WORD、EXCEL启动时的软件封面、漂亮的窗口背景和带背景音乐、移动字幕的动感封底，使我们编写的VFP3.0应用程序更具有专业性。<br> 
      <br> 
      一.封面、背景的制作<br> 
      1. 用画笔或其它绘图工具软件绘制一幅BMP位图格式的封面图片文件Face.bmp。也可从其它现有的图片文件中截取剪切一幅比较合适的图片，再用图片转换软件将其转换为BMP位图格式文件，作为封面图片。<br> 
      <br> 
      2. 以同样方法再作一幅背景图片Back.bmp，尺寸为屏幕大小，以全部覆盖主菜单窗口空白区为准。如果屏幕分辩率为640×480，则背景图片尺寸大概为640×450象素左右。<br> 
      <br> 
      3. 进入Visual Foxpro 3.0系统环境，打开应用程序所在的项目，在命令行窗口中键入Create Form或在“文件”菜单中选择“新建”、“表单”，建立一个文件名为 Fack.scx 的新表单FORM1。<br> 
      <br> 
      4. 设置表单FORM1的Picture属性，选取刚才作好的Face.bmp文件，调整表单FORM1的窗口大小，使其恰好被封面图片全部覆盖；然后再设置表单FORM1的其它属性：AutoCenter=.T.，Borderstyle= 0-无边框，MaxButton=.F.，MinButton=.F.，Movlable=.F. 等。<br> 
      <br> 
      5. 鼠标点击“表单控制栏”中的“标签”，并在表单FORM1上拉出一个矩形框Lable1，设置Lable1的Caption属性为“人事管理系统”。<br> 
      <br> 
      6. 鼠标点击“表单控制栏”中的“计时器”，在表单FORM1中加入两个计时器对象Timer1和Timer2，设置Timer1的Interval属性为了3000（3秒），Timer2的Interval属性为了4000（4秒），在Timer1的Time过程中加入语句：<br> 
      _screen.picture="Back.bmp" &amp;&amp;打开屏幕背景图片<br> 
      在Timer2的Time过程中加入语句：<br> 
      release thisform &amp;&amp;释放封面表单<br> 
      <br> 
      7.在主文件程序的最前面加入语句：<br> 
      ZOOM WINDOWS SCREEN Max &amp;&amp;菜单主窗口最大化<br> 
      DO FORM Face.scx &amp;&amp;执行封面表单<br> 
      <br> 
      8. 实现效果：执行编译后的应用程序，菜单主窗口出现并扩大到最大化时，弹出封面，封面停留3秒钟后打出背景图案，再经过1秒钟封面消失，程序进入带有背景图案的主窗口界面。<br> 
      <br> 
      二、带背景音乐、移动字幕封底的制作<br> 
      <br> 
      1. 用背景图片的作法及标准制作一幅封底图片Over.bmp，尺寸为屏幕大小，以全部覆盖主菜单窗口空白区为准。如果屏幕分辩率为640×480，则封底图片大概为640×440象素左右。<br> 
      <br> 
      2. 建立一个文件名为 Over.scx 的新表单 FORM2。设置表单FORM2的Picture属性为 Over.bmp，再设置属性AutoCenter=.T.，Borderstyle= 2-双线边框，MaxButton=.F.，MinButton=.F.，Movlable=.F.，Height=440,Width=640等。<br> 
      <br> 
      3. 在表单FORM2中加入两个标签对象Lable1和Lable2，按实际情况调整好<br> 
      Lable1和Lable2的位置，设置Lable1和Lable2 的属性AutoSize=.T.，<br> 
      BackStyle =0-透明，Caption=""，FontName=隶书，设置Lable1属性FontSize=36，<br> 
      设置Lable2 的属性FontSize=24。<br> 
      <br> 
      4. 鼠标点击“表单控制栏”中的“OLE容器控制”，拖动到表单FORM2中建立Olecontrol1对象，在弹出的“插入对象”窗口中选择“媒体剪辑”对象类型，选中“以图标显示”框，将其隐藏。在打开的“媒体播放机”窗口中，从文件列表中选择一.wav文件或.MID文作为封底背景音乐，选择“编辑”菜单下“选项”中的“自动重复”，将其设为循还播放，并去掉“重放的控制条”的选中标记，让音乐播放时不出现“媒体播放机”界面，确认后退出。然后设置Olecontrol1的属性Visible=.F.，AutoSize=.T.。<br> 
      <br> 
      5. 在表单FORM2的Avtivate过程中加入语句：<br> 
      Public t &amp;&amp;定义全局变量t<br> 
      t=0<br> 
      a="人事管理系统"+chr(13)+chr(13)<br> 
      b=" 项目策划：李湘江"+chr(13)+chr(13)<br> 
      c=" 软件设计：李湘江"+chr(13)+chr(13)<br> 
      d="矩菱机电工作室出品"+chr(13)<br> 
      e=" 一九九八年二月"<br> 
      thisform.label2.caption=a<br> 
      thisform.label1.caption=b+c +d +e<br> 
      thisform.olecontrol1.doverb(0) &amp;&amp;打开Olecontrol1对象<br> 
      <br> 
      6. 在表单FORM2中加入一个计时器对象Timer1，设置Timer1的Interval属性<br> 
      为了30（0.03秒）,在Timer1的Time过程加入程序语句：<br> 
      If t&lt;3000 then &amp;&amp;时间控制&nbsp;<br>
      t=t+4<br>
      if t&lt;=255 then<br> 
      thisform.label1.forecolor=RGB(t,0,0) &amp;&amp;颜色渐变，黑→红<br> 
      else<br> 
      if t&lt;=510 then<br> 
      thisform.label1.forecolor=RGB(255,t-255,0) &amp;&amp;颜色渐变，红→黄<br> 
      else&nbsp;<br>
      thisform.label2.top=thisform.label2.top-1 &amp;&amp;字幕label2上移<br> 
      thisform.label1.top=thisform.label1.top-1 &amp;&amp;字幕label1上移<br> 
      endif<br> 
      endif<br> 
      endif<br> 
      <br> 
      7. 在表单 FORM2 的 Click 过程中加入语句：<br> 
      release t &amp;&amp;释放全局变量t<br> 
      release thisform &amp;&amp;释放封底表单<br> 
      <br> 
      8. 在主文件程序的最后面加入语句：<br> 
      DO FORM Over.scx &amp;&amp;执行封底表单&nbsp;<br>
      <br>
      9. 实现效果：执行应用程序后，在退出应用程序时，出现动态封底，同时响起优美的音乐。鼠标单击封底画面，封底关闭，返回Windows桌面。</p> 
      <p>　      
    </td>      
  </tr>      
</table>      
</center></div>      
 
</body> 
 
</html> 
