<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0056)http://person.zj.cninfo.net/~yao/document/bcb/bcb000.htm -->
<HTML><HEAD><TITLE>C++ Builder 经验小技巧</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<STYLE>A:link {
	COLOR: blue; TEXT-DECORATION: none
}
A:visited {
	COLOR: purple; TEXT-DECORATION: none
}
A:active {
	
}
A:hover {
	COLOR: red; TEXT-DECORATION: underline
}
TD {
	FONT-FAMILY: Times New Roman; FONT-SIZE: 10.5pt
}
</STYLE>

<META content="Microsoft FrontPage 4.0" name=GENERATOR></HEAD>
<BODY>
<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vcidx098.htm">Visual C</a></b></span></td>  
  </tr>  
</table>  
</center></div><div align="center"><center>  
  
<table border="1" width=&#4130;100%" style="font-size: 9pt" bgcolor="#FFFFFF"  
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">  
  <tr>  
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"  
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"  
    bordercolordark="#FFFFFF">  
      <tr>  
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font  
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"  
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>  
      </tr>  
    </table>  
<P align=center><FONT color=#ff0000><STRONG>C++ Builder 
经验小技巧<BR></STRONG></FONT></P>
<DIV align=center>
<TABLE border=0 cellPadding=0 cellSpacing=0 width=100%>
  <TBODY>
  <TR>
    <TD align=middle width=177><STRONG><A 
      href="http://person.zj.cninfo.net/~yao/document/bcb/bcb000.htm#读写注册表">读写注册表</A></STRONG></TD>
    <TD align=middle width=177><STRONG><A 
      href="http://person.zj.cninfo.net/~yao/document/bcb/bcb000.htm#模仿超级链接">模仿超级链接</A></STRONG></TD>
    <TD align=middle width=177><STRONG><A 
      href="http://person.zj.cninfo.net/~yao/document/bcb/bcb000.htm#取得Memo的行和列">取得Memo的行和列</A></STRONG></TD></TR>
  <TR>
    <TD align=middle width=177><STRONG><A 
      href="http://person.zj.cninfo.net/~yao/document/bcb/bcb000.htm#全编译的问题">全编译的问题</A></STRONG></TD>
    <TD align=middle width=177><STRONG><A 
      href="http://person.zj.cninfo.net/~yao/document/bcb/bcb000.htm#在线帮助的制作">在线帮助的制作</A></STRONG></TD>
    <TD align=middle width=177><STRONG><A 
      href="http://person.zj.cninfo.net/~yao/document/bcb/bcb000.htm#安装组件">安装组件</A></STRONG></TD></TR>
  <TR>
    <TD colSpan=3 width=531>
      <P align=center>　</P>
      <P><A name=读写注册表><FONT 
      color=#ff0000><STRONG>读写注册表</STRONG></FONT></A><BR>　　现在的Windows程序大都使用了注册表来存储软件的配置信息。C＋＋Builder  
      3.0中给我们提供了一个TRegistry类帮助我们管理注册表，它有以下几个常用的方法：<BR>　　OpenKey　　  
      打开一个键值<BR>　　ReadBool　从注册表中读取布尔值<BR>　　ReadInteger　从注册表中读取整型值<BR>　　ReadString　  
      从注册表中读取字符串值<BR>　　WriteBool　  
      向注册表中写入布尔值<BR>　　WriteInteger　向注册表中写入整型值<BR>　　WriteString　  
      向注册表中写入字符串值<BR>　　代码演示：<BR>　　TRegistry ＆regkey=＊new  
      TRegistry();<BR>　　regkey.OpenKey(“software\myapp”,true);<BR>　　regkey.WriteInteger(“Max”,100);<BR>　　int  
      x=regkey.ReadInteger(“Max”);<BR>　　delete  
      ＆regkey;<BR>　　注意：使用TRegistry类时应包含头文件。</P>
      <P><BR><A name=模仿超级链接><FONT 
      color=#ff0000><STRONG>模仿超级链接</STRONG></FONT></A><BR>　　用过Winamp的朋友知道Winamp的界面中有一些模仿的超级链接，可以把你直接带到它的相关网站中去。下面这个例子就实现了这种功能，当鼠标点击其中的仿超级链接时，你就会直接到达《电脑商情报》的网址：<BR>　　新建一个应用，在窗体Form1上添加一个名为Label1的TLabel组件，然后<BR>在代码编辑器中添加以下代码：<BR>　　void  
      __fastcall TForm1::FormCreate(TObject ＊Sender)<BR>　　{<BR>　　  
      Label1→Cursor=crHandPoint;<BR>　　 Label1→Font→Color=clBlue;<BR>　　  
      Label1→Font→Style=Label1→Font→Style&lt;  
      Label1→Caption=“http://www.cbinews.com”;<BR>　　}<BR>　　<BR>　　void __fastcall  
      TForm1::Label1Click(TObject ＊Sender)<BR>　　{<BR>　　  
      ShellExecute(Handle,NULL,Label1→Caption.c_str(),NULL,NULL,SW_SHOWNORMAL);<BR>　　}<BR>　　<BR>　　void  
      __fastcall TForm1::Label1MouseMove(TObject ＊Sender, TShiftState  
      Shift,<BR>　　 int X, int Y)<BR>　　{<BR>　　  
      Label1→Font→Color=clRed;<BR>　　}<BR>　　<BR>　　void __fastcall  
      TForm1::FormMouseMove(TObject ＊Sender, TShiftState Shift,<BR>　　 int X, int  
      Y)<BR>　　{<BR>　　 Label1→Font→Color=clBlue;<BR>　　}<BR>　　注意：本示例应该包含头文件。</P>
      <P><BR><A name=取得Memo的行和列><FONT 
      color=#ff0000><STRONG>取得Memo的行和列</STRONG></FONT></A><BR>　　新建一个应用，在窗体Form1上添加两个TLabel组件名为Label1，Label2；添加两个TButton组件名为Button1，Button2；添加一个TMemo组件名为Memo1。<BR>然后在代码编辑器中添加以下代码。<BR>　　void  
      __fastcall TForm1::Button1Click(TObject  
      ＊Sender)<BR>　　{<BR>　　Label1→Caption=SendMessage(Memo1→Handle,EM_LINEFROMCHAR,－1,0)＋1;<BR>　　}<BR>　　<BR>　　void  
      __fastcall TForm1::Button2Click(TObject  
      ＊Sender)<BR>　　{<BR>　　Label2→Caption=Memo1→SelStart－SendMessage(Memo1→Handle,EM_LINEINDEX,－1,0)＋1;<BR>　　}<BR>　　这种方法同样适用于RichEdit。</P>
      <P><A name=全编译的问题><FONT 
      color=#ff0000><STRONG>全编译的问题</STRONG></FONT></A><BR>&nbsp;&nbsp;&nbsp; 
      在C＋＋ Builder  
      3.0下,如果不进行设置,那么程序是<BR>不完全编译的,运行时要用到Windows的System目录下的一些文件，如将这样编<BR>译所得的可执行文件拷到其它未装C＋＋  
      Builder  
      的机子里将无法运行。如果<BR>想全编译可以通过设置完成。设置方法如下：按“Project”下“Option”，<BR>选中“Packages”页下角的“Build  
      with runtime packages”即可。</P> 
      <P><FONT color=#ff0000><STRONG><A name=在线帮助的制作>在线帮助的制作</A><A  
      name=安装组件>安装组件</A></STRONG></FONT><BR>&nbsp;&nbsp;&nbsp; 一个完整的程序应该有在线帮助。制作在线帮助并不<BR>难,主要工作在制作帮助文件上，这需要一个帮助文件编译器，在C＋＋  
      Builder<BR>的“CBuilder3\Help\Tools"  
      目录下就有一个帮助文件编译器HCW。实际上帮助<BR>编译器的作用就是将.rtf文件编译成.hlp文件。让我们来看一个最简单的例子，<BR>用Word随便写一个.rtf文件,启动HCW,先建一个项目；按窗体右边的“Files”<BR>按钮，把刚才做的.rtf文件添加进去；最后按右下角的“Save  
      and  
      Compile”<BR>按钮，这样在你的项目的目录下，将会出现一个和项目同名的.hlp文件。在程<BR>序中使用帮助文件如下：<BR>　　Application－&gt;HelpFile=″myhelp.hlp″  
      ;／／指定帮助文件<BR>　　Application－&gt;HelpCommand(HELP_Contents,0); ／／打开帮助窗体</P> 
      <P><BR><A name=安装组件><FONT  
      color=#ff0000><STRONG>安装组件</STRONG></FONT></A><BR>&nbsp;&nbsp;&nbsp; C＋＋  
      Builder一个很吸引人的地方，就是它的组件。你不但<BR>可以利用系统中提供的丰富的组件，而且可以利用第三方提供的组件。安装组件<BR>的操作很简单，打开“Compoment”菜单下的“Install  
      Compoment”，然后选中<BR>要安装的组件的文件就行了。<BR></P></TD></TR></TBODY></TABLE></DIV>   
      <p>　   
    </td>   
  </tr>   
</table>   
</center></div>   
</BODY></HTML> 
