<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vcidx098.htm">VC</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center">C语言口令保护程序      
      <p>　　本程序可加到用户的源程序之前，起到加锁的作用。本程序的特点是：口令保密性强(保存于文件KLK.CFG中，此文件名也可由用户重新命名)，而且用户可随时修改口令。在程序中当用户输入口令后，系统首先测试口令文件KLK.CFG是否存在(只有用户运行了修改口令子函数后才会生成口令文件，否则系统只认默认口令88888888)，若存在则从中取出口令字，否则系统用默认口令与用户输入的口令进行较验。另<br>
              外，修改口令子函数changkl()，可在用户程序中调用，以修改口令文件中的口令字。<br>
      　　本程序涉及到C语言函数getpass(＊char)，该函数从键盘读取8位字符并返回，且不在屏幕上显示。我们正好利用这一函数功能进行输入口令。<br>
      　　 程序清单如下：<br> 
      　　＃include<br>
      　　＃include<br>
      　　void main()<br> 
      　　{char＊password;<br>
      　　 char kl[9]=“88888888”;<br> 
      　　 inti=0;<br> 
      　　 FILE＊fpl;<br> 
      　　 window(1,1,80,25); /＊屏幕背景清屏成蓝色＊/<br> 
      　　 textbackground(1);<br> 
      　　 clrscr();<br> 
      　　 window(17,10,58,13);/＊开阴影窗口＊/<br> 
      　　 textbackground(0);<br> 
      　　 clrscr();<br> 
      　　 for(i=0;i&lt;=2;i＋＋)<br> 
      　　{ window(16,9,56,12);<br> 
      　　 textattr(142&lt;&lt;4);<br> 
      　　 clrscr();<br> 
      　　 gotoxy(13,2);<br> 
      　　 password=(char＊)getpass("请输入系统口令：");<br> 
      　　 textcolor(4);<br> 
      　　 /＊若口令文件KLK.CFG存在，则从中取出口令字＊/<br> 
      　　 if((fp=fopen("KLK.CFG","rb＋"))!＋NULL)<br> 
      　　 { fseek(fp,O,SEEK_SET);<br> 
      　　 fgets(kl,9,fp);<br> 
      　　 fclose(fp);}<br> 
      　　 if(i==2＆＆strcmp(password,kl)!＋0)/＊三次口令无<br> 
              效退出＊/<br> 
      　　 { gotoxy(13,2);<br> 
      　　 cputs("口令错误，退出!!");<br> 
      　　 getch();exit(0);}<br> 
      　　 if(stcmp(password,kl)!=0,<br> 
      　　 { gotoxy(13,2);<br> 
      　　 cputs("口令错误，重输!!");<br> 
      　　 getch();}<br> 
      　　 else<br> 
      　　 break;<br> 
      　　 }<br> 
      　　 /＊进入主程序体＊/<br> 
      　　 textbackground(1);<br> 
      　　 window(1,1,80,25);<br> 
      　　 clrscr();<br> 
      　　 gotoxy(10,10);<br> 
      　　 cputs("执行用户主体程序……按任意键进行更改口<br> 
              令!");<br> 
      　　 getch();<br> 
      　　 changkl();/＊用户程序中调用修改口令函数＊/<br> 
      　　}<br>
      　　 changkl() /＊修改口令子函数＊/<br> 
      　　{char＊klk;<br>
      　　 char buf[1];<br> 
      　　 FILE＊fp;<br> 
      　　 window(17,16,58,19);/＊开阴影窗口＊/<br> 
      　　 textbackground(0);<br> 
      　　 clrscr();<br> 
      　　 window(16,15,56,18);<br> 
      　　 textattr(144&lt;&lt;4);<br> 
      　　 clrscr();<br> 
      　　 gotoxy(8,4);<br> 
      　　 cputs("请修改口令字，必须为八位字符");<br> 
      　　 gotoxy(14,2);<br> 
      　　 klk=(char＊)getpass("请输入新口令:");<br> 
      　　 gotoxy(14,2);<br> 
      　　 textcolor(2);<br> 
      　　 if(srlen(klk)!=8<br> 
      　　 {cputs("口令字无效，返回!!");<br> 
      　　 getxh();<br> 
      　　 return;}<br> 
      　　 cputs("口令修改成功!!");<br> 
      　　 if((fp=fopen("KLK,CFG"."w"))!=null)/＊保存口令到<br> 
              文件KLK.CFG＊/<br> 
      　　 {fputs(klk,fp);<br> 
      　　 buf[0]=0xia;<br> 
      　　 fwrite(＆buf[0],1,1,fp);<br> 
      　　 fclose(fp); }<br> 
      　　 getch();<br> 
      　　 returm;<br> 
      　　 }<br> 
      　　 本程序在COMPAQ486/33微机上，DOS5.0操作系统、UCDOS3.1汉字系统及Turbo C2.0语言下运行通过。<br> 
      　　(山西 焦赞康)<br> 
    </td>      
  </tr>      
</table>      
</center></div>      
 
</body> 
 
</html> 
