<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>您现在的位置是</title>
</head>

<body>

<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="100%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="../../progidx.htm">编程技巧</a> --&gt; 
      <a href="../Vcidx098.htm">VC</a></b></span></td>      
  </tr>      
</table>      
</center></div><div align="center"><center>      
      
<table border="1" width="100%" style="font-size: 9pt" bgcolor="#FFFFFF"      
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">      
  <tr>      
    <td width="85%" align="left" valign="top"><table border="1" width="32%" style="font-size: 9pt" height="30"      
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"      
    bordercolordark="#FFFFFF">      
      <tr>      
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font      
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"      
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>      
      </tr>      
    </table>      
      <p align="center"> C++ Builder 中园形、三角形按钮的实现<br> 
      <br> 
                    合肥电子工程学院计算中心  李 强       
      <p><br> 
      ---- 由于Window 95增加了对窗口区域概念的支持，使得窗口区域就是所定义的窗口看上去的形状，窗口区域作为窗口的实际边界区域，这样窗口区域不仅定义了窗口的可画区域，而且定义了窗口下隐含区域和响应鼠标击键事件的响应窗口区域。&nbsp;<br>
      <br>
      ---- 按钮的各种形状是在运行时设置的而不是在设计时设置。设计时按钮的形状仍然是长方形或正方形。&nbsp;<br>
      <br>
      ---- 按钮形状的设计分成两个步骤。&nbsp;<br>
      <br>
      ---- 第一步创建按钮的外形，即定义窗口区域。使用API的区域创建函数就可达到目的。区域创建函数很多，主要有CreateEllipticRgn 、CreatePolygonRgn、 
      CreateRectRgn、 CreateRoundRectRgn，用于创建不同类型的区域显示。如果需要一个复杂区域形状，那么可以分别使用不同的区域函数创建不同的区域，然后调用CombineRgn API函数把它们组合起来。所以说，不仅可以创建出园形、三角形的按钮，而且还可以创建出其它各种形状的按钮。&nbsp;<br>
      <br>
      ---- 第二步将区域显示应用到窗口上。一旦使用区域函数创建了一个新的区域显示，就可以使用SetWindowsRgn函数将这个区域应用到窗口上。&nbsp;<br>
      <br>
      ---- 下面给出园形、三角形按钮实现的具体代码。为了直观显示效果，将窗体的背景色设置为了黑色(Color设置为clBtnText)，并将两个按钮的Cursor设置crCross。在窗体放置两个Button按钮，分别定义为RButton、TButton。实现窗口区域的最佳时机是在窗体首次创建时，所以将处理程序放在OnCreate事件<br> 
      中。&nbsp;<br>
      <br>
      void __fastcall TForm1::FormCreate(TObject *Sender)<br> 
      {<br> 
    //创建园形按钮<br> 
      HRGN hRgnR = CreateEllipticRgn(0,0,RButton-><br> 
      Width,RButton->Height);<br> 
      SetWindowRgn(RButton->Handle,hRgnR,TRUE);<br> 
      <br> 
        //创建三角形按钮<br> 
      TrPoint[0].x=TButton->Width/2;<br> 
      TrPoint[0].y=0;<br> 
      <br> 
      TrPoint[1].x=0;<br> 
      TrPoint[1].y=TButton->Height;<br> 
      <br> 
      TrPoint[2].x=TButton->Width;<br> 
      TrPoint[2].y=TButton->Height;<br> 
      <br> 
      HRGN hRgnT = CreatePolygonRgn(TrPoint,3,ALTERNATE);<br> 
      SetWindowRgn(TButton->Handle,hRgnT,TRUE);<br> 
      }<br> 
      其中TrPoint在Unit.h头文件中定义如下：<br> 
      private:    // User declarations<br> 
      POINT TrPoint[3];<br> 
      ---- 上面的代码在按钮的边界内分别创建了一个园形区域和一个三角形区域，然后作为新的窗口区域把它赋给各自的按钮。在创建园形按钮时使用了椭园形区域创建函数，要使按钮为园形在设计时该按钮应设计为正方形。另外区域是以按钮坐标的形式定义的，而不是用屏幕坐标。（0，0）点是按钮的最左上角，而（宽，高）点是按钮的最右下角。&nbsp;<br>
      <br>
      ---- 
      应该注意的是，一旦将区域句柄赋给按钮，就不能再对区域句柄作任何操作。如果将区域句柄赋给按钮后，修改或删除这个句柄将导致程序崩溃。&nbsp;<br>
      <br>
      ---- 光标只在园形和三角形区域内变为crCross形状。为了使按钮美观可以使用BitBtn或SpeedButton按钮，在按钮上附上位图。有关API区域函数的使用请参看Win32SDK.hlp帮助文件。      
    </td>      
  </tr>      
</table>      
</center></div>      
<p>　</p> 
 
</body> 
 
</html> 
