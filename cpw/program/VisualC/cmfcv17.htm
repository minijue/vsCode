<html>

<head>
<title></title>
</head>

<body>

<table border="0" cellspacing="2" cellpadding="0" width="100%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是： <b><a href="Vc_idx.htm">Visual 
    C++/C++</a> &gt;</b> </span><font color="#000000">MFC邮递表的中文翻译-第十七期</font></td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>

<table border="0" width="100%" style="font-size: 9pt" bgcolor="#E8E8E8">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<table border="0" width="100%" bgcolor="#E8E8E8">
      <tr>
        <td width="100%"></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><font color="#000000"><strong>MFC邮递表的中文翻译-第十七期</strong></font></td>
  </tr>
  <tr>
    <td width="100%"></td>
  </tr>
  <tr>
    <td width="100%">　<h3><font COLOR="#FF0000">第十七期目录</font> <font SIZE="-1">杨晓东 
    1998.12.4</font></h3>
    <ol>
      <li><a HREF="#vol17q1">动画控件</a> </li>
      <li><a HREF="#vol17q2">错误声明的消息</a> </li>
      <li><a HREF="#vol17q3">怎样模拟鼠标动作?</a> </li>
      <li><a HREF="#vol17q4">改变对话框标题字体?</a> </li>
    </ol>
    <p><a NAME="vol17q1"></a></p>
    <p><br>
    </p>
    <h3><font COLOR="#FF0000">问：动画控件?</font></h3>
    <p><br>
    问:我在对话框中使用一个动画控件,通常我都是用CAnimated的open成员函数,并加上avi的 
    文件名来使用动画控件,怎样在资源文件加入一个avi文件,作为资源使用? 
    </p>
    <p>答:1).简单,将avi文件引入资源,按你的喜欢来决定是属于那一种类型的,通过ID来代替文件 
    的名字,这样你就可以使用了.<br>
    2).在资源窗口中单击右键,在弹出的菜单中选择&quot;Import&quot;.这时会打开文件选择框,选择 
    所要的文件,这时系统将会询问自定义资源类型,输入avi.一个AVIS的资源组将会创立,你所 
    选的avi文件将会出现在该组中并拥有一个ID.<br>
    3).手动在资源文件中加入一个AVI资源说明,比如:<br>
    //在这手工编辑资源文件<br>
    IDR_ANIMATION AVI res\animate.avi<br>
    </p>
    <p><a NAME="vol17q2"></a><br>
    </p>
    <h3><font COLOR="#FF0000">问:错误声明的消息?</font></h3>
    <p><br>
    问:我给一个视发送一条消息<br>
    pView-&gt;SendMessage (MY_MESSAGE, wparam, lparam);<br>
    消息声明被认为是不正确的<br>
    afx_msg void OnMyMessage();<br>
    高手一看就知道这是一条命令错误的声明对象,正确的声明应该为:<br>
    afx_msg LERSULT OnMyMessage (WPAPRAM wparam, LPARAM lparam);<br>
    <br>
    因为我不使用参数,程序工作也很好,所以我不知道为什么会有这种错误,该过程 
    处理完之后也没有任何错误的信息出现.<br>
    <br>
    但现在release版本中有一个奇怪的现象(debug版本中没有)程序会非正常终止，通常<br>
    这现象发生在SendMessage()返回之后。为什么？<br>
    </p>
    <p>答：1.相信问题是出在错误的堆栈上,&quot;thiscall&quot;调用后就应该清除堆栈,调用者调用时 
    将两个参数压入堆栈,但参数却没有被清除.<br>
    如果你真的不需要WPARAM,LPARAM,也不需要返回值的话,你可以使用ON_MESSAGE_VOID 
    消息声明.在afxpriv.h中定义,是非文档的,意思就是它不会有什么提示或可能中断程序, 
    另外,需要注意一下线程消息,注意线程消息是可变的,它们将返回void,没有LRESULT,同样 
    的声明.<br>
    2.如果你不使用WParam和LParam,为什么不在视中定义一个用户函数来处理自己想做的?<br>
    </p>
    <p><a NAME="vol17q3"></a><br>
    </p>
    <h3><font COLOR="#FF0000">问:怎样模拟鼠标动作?</font></h3>
    <p><br>
    问:这是困扰我多时的一个问题,怎样才能实现模拟鼠标的动作,就是说要使一个程序实现 
    鼠标的单击,双击,拖放等功能.我认为必须要实现相应的消息传递,但每次都不成功.<br>
    比如说,我想关闭记事本窗口,可以传送WM_lBUTTONDOWN和WM_LBUTTONUP(X,Y值为记事 
    本的右上角关闭按钮的位置)给记事本窗口,但窗口并没有关闭.当然,我也知道关闭一个窗 
    口可以通过传送WM_QUIT或WM_CLOSE来实现,但鼠标的消息为什么会丢失?<br>
    请教各位大师,怎样模式模拟实现鼠标的动作,或者给我一些怎样发送消息来关闭窗口的 
    建议(不是WM_CLOSE或WM_QUIT)<br>
    </p>
    <p>答:1).试一下window hooks,你可以使用SetWindowsHookEx和JournalPlayback来处理鼠标事件.<br>
    2).你可以使用文档中的SendInput(),它能实现模拟键盘或鼠标事件.如果你使用NT,那也可 
    以用老的函数像mouse_event(),keyb_event等,在Win98中,SendInput()一样可以使用.<br>
    3).抱歉不能给你一个满意的回答,你可以在网站<a
    HREF="http://www.microsoft.com/enable/dev/tooldev.htm">http://www.microsoft.com/enable/dev/tooldev.htm</a> 
    中找到一篇关于模拟输入的文章.<br>
    4).在NT中可以使用mouse_event()传递事件,文档上说这种方法已经过时了,那么你可以用 
    SendInput()替换,但找不到关于此函数的使用说明,所以我依然使用mouse_event,没有任何问题.<br>
    </p>
    <p><a NAME="vol17q4"></a><br>
    </p>
    <h3><font COLOR="#FF0000">问:改变对话框标题字体?</font></h3>
    <p><br>
    问:怎样改变对话框标题文件的字体,改变资源中对话框属性中的字体,将改变所有的控件的字体, 
    却没有改变标题,但我只想改变标题字体,不改基余控件的属性.是不是我错过一些明显的选项. 
    通过查找一些MFC代码,我发现有一个CDialog模块,里面调用了一引起字体方法,但该对话框不 
    是公用的,我相信它不会给我任何帮助.<br>
    </p>
    <p>答:1).就我所知,对话框的标题字体和其它的窗口标题一样,它可以通过系统--显示器--属性--外观 
    来设置,如果自己想这样做,我想你应该取得WM_NCPAINT句柄自己来画出非用户区域(包括标题在 
    内),我从未做这样做过,可能是个错误的方向.<br>
    2).如果你是在CView继承的,那你可以在构造函数中看见如下代码:<br>
    </p>
    <pre>
if( !my_CFont .CreatePointFont( 180,&quot;Helvetica&quot;,NULL ) )
        return false;
GetEditCtrl().SetFont( &amp;my_CFont ,true )
</pre>
    <p>接下来如果你想改变在对话框中的一个CEdit控件字体时,可以使用以下代码:<br>
    </p>
    <pre>
if( !my_CFont .CreatePointFont( 180,&quot;Helvetica&quot;,NULL ) )
        return false;
( GetDlgItem (ID_ANY_CEDIT) ) -&gt;SetFont( &amp;my_CFont );
</pre>
    <hr>
    <a href="cmfcv18.htm"><p align="center">前一期</a>|<a href="cmfcv16.htm">后一期</a><br>
    <a href="http://mfc2000.yeah.net" target="_top">玉海园</a>[http://mfc2000.yeah.net]友情提供! 
    </td>
  </tr>
</table>
</body>
</html>
