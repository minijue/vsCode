<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>利用C++ Builder 巧建WEB浏览器</title>
<link rel="stylesheet" href="../images/my.css">
</head>

<body style="font-size: 9pt" bgcolor="#FFFFFF">

<table border="0" cellspacing="2" cellpadding="0" bordercolor="#DED8CD" width="100%">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是：<a href="Vc_idx.htm">Visual C++/C++</a> 
    <b>&gt;</b> 利用C++ Builder 巧建WEB浏览器</span></td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>

<table border="0" width="100%" style="font-size: 9pt" bgcolor="#E8E8E8">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<table border="0" width="100%">
      <tr>
        <td width="100%"></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><span style="font-size: 9pt"><font color="#000000"><strong>利用C++ 
    Builder 巧建WEB浏览器</strong></font></span></td>
  </tr>
  <tr>
    <td width="100%"></td>
  </tr>
  <tr>
    <td style="font-size: 9pt">THTML控件是个现成的Web浏览器，只要将这些控件放在窗体上并调用Request 
    Doc()方法，也许这有些过份简化，但显示Internet上的Web文档也就这么简单。因此，下面显示了如何迅速编写Web浏览器应用程序。第一步如下：<br>
    1．开始新的主应用程序，将窗体的Name属性变成Web Main，将Caption属性变成EZ 
    Web Browser。<br>
    2．将Panel构件放在窗体上，将其Align属性变为al Top，Height属性变为60，清除Caption属性。<br>
    3．将Combo Box构件放在面板上，移到面板顶部并让它象面板一样宽，将Name属性变成URL 
    Combo Box，将Text属性变为所选URL（如http://www.microsoft.com）<br>
    4．将Status Bar构件放在窗体上，它自动放在窗体底部，将其Name属性变成Status 
    Bar，Simple Panel<br>
    属性变为true。<br>
    5．将HTML控件放在窗体中央，将Align属性变为a Client。HTML控件即填满屏幕。将Name属性变成HTML。<br>
    &nbsp;&nbsp; 
    这时窗体如果还不美观则可以稍作调整，也可以保持原样（有点个性也不是坏事）。<br>
    &nbsp;&nbsp; 这时应保存项目，将窗体存为Web BrwsU.cpp，项目成为Web 
    Brows.cpp。然后要加进让浏览器工作的功能。<br>
    6．单击URL组合框，产生On Click事件的处理器，在这个事件处理器中输入如下代码：<br>
    if (URL Combo Box &gt; Text! =&quot;&quot;)<br>
    HTML &gt; Request Doc (URL Combo Box &gt; Text);<br>
    7．产生On Key Press事件的事件处理器在这个事件处理器中输入如下代码：<br>
    if (Key = = VK_RETURN){<br>
    Key =0;<br>
    if (URL Combo Box &gt; Text = = &quot;&quot;)return;<br>
    URL Combo Box &gt; Items &gt; Insert(0,URL Combo Box &gt; Text);<br>
    URL Combo Box Click(Sender);<br>
    }<br>
    8．然后编译和运行程序。在组合框中输入URL并按Enter。如果输入有效URL，则页面装人HTML控件中。<br>
    &nbsp;&nbsp; 15分钟就建成了Web浏览器，这个浏览器已经很有样子了。只是还要加进不少功能。注意每次按Enter键时，输入的URL都会加进组合框的清单中。<br>
    第二步：最后修饰<br>
    首先在URL组合框下面加几个按钮。步骤如下：<br>
    1．在URL组合框下面加一个按钮，按Name属性为Go Btn，Caption变为GO！<br>
    2．产生新按钮的On Click事件处理器，在事件处理器中输入下列代码：<br>
    URL Combo Box Click(0)*<br>
    3．在URL组合框下面加另一个按钮，放在第一个按钮右边，将Name属性变为Stop 
    Btn，Caption变为Stop。<br>
    4．产生新按钮的On Click事件处理器，在事件处理器中输入下列代码：<br>
    HTML &gt; Cancel(0); Status Bar &gt; Simple Text =&quot;Done&quot;;<br>
    5．在前面两个按钮右边放第三个按钮，将Name属性变为Reload Btn，Caption变为Reload。<br>
    6．产生新按钮的On Click事件处理器，在事件处理器中输入下列代码：<br>
    URL Combo Box Click(0);<br>
    7．在面板上放最后一个按钮。将Name属性变为Source Btn，Caption变为View 
    Source。<br>
    8．产生新按钮的On Click事件处理器，在事件处理器中输入下列代码：<br>
    HTML &gt; View Source =!HTML<br>
    &gt; View Source; if<br>
    (HTML &gt; View Source) Source Btn &gt; Caption= &quot;<br>
    View Document&quot;; else Source Btn &gt; Caption= &quot;View<br>
    Source&quot;。</td>
  </tr>
  <tr>
    <td width="100%"><hr>
    </td>
  </tr>
  <tr>
    <td width="100%">中国程序员网站版权所有</td>
  </tr>
</table>

<p><br>
<br>
</p>
</body>
</html>
