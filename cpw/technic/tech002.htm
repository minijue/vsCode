<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style type="text/css">
<!--
.f{font-size: 12px;line-height: 15px;}
A:link {text-decoration: none; color: blue}
A:visited {text-decoration: none; color: "#54646D"}
A:active {text-decoration: none}
A:hover {text-decoration: underline; color: 000080} 
-->
</style>
<title>飞意软件工作室-程序员网站</title>
</head>

<body>
<div align="center"><center>

<table border="0" width="720" cellspacing="0" cellpadding="3">
  <tr>
    <td width="718" height="29" bgcolor="#E8FFFF"><table border="1" width="32%"
    bordercolor="#800000" cellspacing="0" cellpadding="2" height="30">
      <tr>
        <td width="100%" bgcolor="#4264B5" bordercolor="#FFFFFF"><font color="#FFFFFF"><span
        class="f"><p align="center">资料整理&middot;<a href="http://fasoft.yeah.net"
        target="_blank" style="color: rgb(255,255,255)">中国程序员网站</a></span></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%" valign="top" bgcolor="#E8FFFF"><br>
    <span class="f">NT4.0组网技术系列讲座(二)<br>
    第二讲<br>
    <br>
    <strong>NTS4.0服务器的安装和设置</strong><br>
    <br>
    　　本讲将介绍NTS4.0服务器的安装过程和方法，同时对安装中或安装后可能出现的故障原因也进行必要的分析，并提供对应的解决办法。另外，本讲所涉及到的大量内容，也适用于网络的日常维护。<br>
    <br>
    一、安装NTS4.0前的准备工作<br>
    <br>
    　　首先，安装NTS4.0服务器要符合上一讲所要求的硬件配置。有人认为，在机器的配置可满足NTS4.0安装和运行的条件下，只要能够使用DOS操作系统就能够成功安装NTS4.0，事实上这种认识是错误的。因为与NTS4.0相比较，DOS不能算是一个“真正的操作系统”，所以当机器存在较大的故障时，DOS可能会照常工作（看起来在正常工作），而NTS4.0则不行。NT4.0对硬件完好性的要求是很严格的,有时甚至是非常苛刻的。为此在安装NTS4.0前有必要对机器的主要硬件进行全面检测，这些硬件主要包括硬盘、网卡和光驱等。<br>
    在安装NTS4.0前，建议通过基于DOS的专门诊断工具对主要的硬件进行全面检测。例如，可通过SCANDISK.EXE对硬盘进行诊断；用MSD.EXE查看网卡或其他的组件在DOS环境下是否存在中断冲突；用MSCDEX.EXE测试光驱能否正常工作。只有当硬件测试通过后，才可安装NTS4.0，否则会浪费大量的时间和精力。<br>
    <br>
    二、NTS4.0的安装方法<br>
    <br>
    　　根据需要，可以选择从NT3.X、Windows95/98操作系统上直接升级，也可从DOS、Windows95/98上安装，并实现系统的多重启动。如果选择的是直接升级，因为NTS4.0的Registry数据库与Windows95/98的不同，所以系统无法将Windows95/98上的应用程序升级到NTS4.0中，这些应用程序只能在安装好NTS4.0后重新安装，并且NTS4.0必须安装在另一个新的目录下。因此，当要安装的是专用服务器时，可选择直接升级；如果你的服务器不是专用服务器，则可选择从DOS或Windows95/98上安装，实现系统的多重引导。<br>
    　　我们在安装其他软件时大都使用SETUP.EXE，而安装NTS4.0时，使用的安装文件为WINNT.EXE或WINNT32.EXE。其中WINNT.EXE可以在DOS、Windows95/98下执行，而WINNT32.EXE则是在NT真正的32位操作系统下执行。这两个安装文件都带有安装参数，参数可在NTS4.0光盘的目录下运行“WINNT/？”或“WINNT32/？”查看。为了满足不同的安装要求，表1列出了WINNT.EXE的主要参数和作用（WINNT32.EXE的参数与WINNT.EXE基本相同），供大家安装时参考。<br>
    <br>
    表1 WINNT.EXE的主要参数和作用<br>
    主要参数&nbsp;&nbsp;&nbsp; 参数的作用<br>
    /S:sorecepath&nbsp;&nbsp;&nbsp; 指定Windows NT程序文件的位置<br>
    /I:inf_file&nbsp;&nbsp;&nbsp; 指定安装信息文件，默认文件为DOSNET.INF<br>
    /t:drive_letter &nbsp;&nbsp;&nbsp; 
    指定安装过程中临时文件存放的驱动器盘符<br>
    /X&nbsp;&nbsp;&nbsp; 防止建立启动盘<br>
    /B&nbsp;&nbsp;&nbsp; 从硬盘直接安装,不需要启动盘<br>
    /OX&nbsp;&nbsp;&nbsp; 从Windows NT CD建立启动盘<br>
    /U&nbsp;&nbsp;&nbsp; 升级老版本的Windows NT<br>
    /U:script&nbsp;&nbsp;&nbsp; 利用设置文件升级老版本的Windows NT<br>
    /R:directory&nbsp;&nbsp;&nbsp; 设定安装目<br>
    <br>
    三、开始安装NTS4.0<br>
    <br>
    　　下面我们开始安装一台NTS4.0服务器。安装所用的计算机为普通PC机，选择从DOS6.22上安装。为了加快安装的速度，并方便安装结束后对系统进行必要的设置，建议将光盘上的源安装文件复制到硬盘上一个临时目录下（如：NTS_TEMP），直接从硬盘上安装。具体安装过程与安装Windows95时很相似，只要你对一些基本概念熟悉，在屏幕的提示信息下，安装过程是比较简单的。以下将列出安装过程中应注意的一些重要环节和解决方法。<br>
    　　1.启动计算机后，在DOS操作系统下改变当前目录至C:\NTS_TEMP，然后执行WINNT/B命令（表示从硬盘直接安装）。屏幕将显示源文件的路径（C:\NTS_TEMP），回车确认后，系统开始复制所需要的文件到硬盘的临时目录内（由系统自建）。复制完成后，按回车重新启动计算机，系统继续下一阶段的安装。如果你是在纯DOS7.0以上版本状态下安装NT，安装前要在C:的提示符下执行“LOCK 
    C:”后再重新执行WINNT/B命令安装。如果是在Windows的DOS窗口中安装NT，就不用执行LOCK命令了。<br>
    　　2.重新启动计算机后，屏幕将显示“Windows NT Server安装程序”的中文界面。这时，你可在屏幕信息的提示下，选择“开始安装Windows 
    NT”选项。接着逐页阅读有关协议内容，直至阅读完毕后按F8键同意接受有关“Windows 
    NT许可协议”。之后，安装程序自动检测当前计算机中已安装的硬件设备，经确认后系统安装对应的接口程序。<br>
    　　3.屏幕显示硬盘的分区信息，同时提供下列信息选项：<br>
    　　○如果您要将Windows NT安装在突出显示的磁盘分区，或未分区的磁盘空间，请按ENTER。<br>
    　　○如果您想在未分区的磁盘空间上建立新的分区，请按C。<br>
    　　○如果您想删除突出显示的磁盘分区，请按D。<br>
    　　一般情况下，用户在安装NTS4.0之前，已对硬盘进行了必要的分区，所以此时大家大可不必被屏幕上的这些提示信息所迷惑，只需用光标选择将系统文件安装在C盘或D盘即可。<br>
    　　4.在选择了安装路径后，系统询问是否将原有的FAT文件格式转换为NTFS格式。到底你选择哪一种文件系统好呢？如果你的服务器是专用服务器，为了使系统具有较高的安全性，建议选择NTFS格式；如果你的服务器有时还要运行DOS、Windows95/98等系统，则必须使用FAT格式。不过当服务器安装结束后，FAT格式可以转换成NTFS格式，而NTFS格式却无法转换成FAT格式。（有关FAT与NTFS的特点和功能比较，请参考文章后面的小知识。)<br>
    　　5.当计算机第二次重新启动后，你可以在安装向导的指引下，一步步地完成下列三方面的安装工作：○收集有关计算机的信息；○安装Windows 
    NT网络；○完成安装<br>
    　　首先进行第一阶段的安装。当选择了“收集有关计算机的信息”后，安装向导将提供以下四种安装类型:○典型安装(Typical);○便携式安装(Portable);○最小安装(Compact)；○定制安装(Custom)。其中，“典型安装”是最简便、最快速的安装方法，安装时系统将自动设置硬件的有关状态;“便携式安装”仅适用于便携式计算机的安装；“最小安装”方式适合于小容量硬盘的计算机；使用“定制安装”时，用户可以根据需要选择所要的安装组件。<br>
    　　如果你是系统安装“老手”，请选择“定制安装”；如果你是个初学者，请最好选择“典型安装”，不过采用“典型安装”后，系统的网络功能要重新进行设置(这将在本讲第六部分讲到)。下面是选择了“定制安装”后主要的安装步骤：<br>
    　　①在输入了“计算机”名称和“组织”信息后，系统要求你输入“CD 
    key”序列号。在确认序列号无误后，你可在下列两种许可协议中选择你需要的项目：○每服务器……；○每客户……。其中，“每服务器”方式适用于只有一个服务器的小型LAN;而“每客户”方式则用于多服务器的大型网络。我们选择“每服务器”方式，并输入需访问该服务器的用户数。<br>
    　　②在下列三种“服务器类型”中进行适合你的服务器身份的选择:○主域控制器(PDC);○备份域控制器（BDC）;○ 
    独立的服务器。如果你安装的是第一台域服务器，或你的网络中只有一个服务器时，请选择“主域控制器”;如果你所安装的域服务器是为了系统的安全需要，则选择“备份域控制器”，这样当主域控制器出故障后就可由备份域控制器接管主域控制器的工作，维持网络的正常运行；若你的网络不是设置成域的方式，而是设置成工作组（Workgroups），同时此台计算机也要成为工作组的成员时，应选择“独立的服务器”。我们现在的要求是建立小型LAN，所以选择“主域控制器”。<br>
    　　③输入Administrator管理员帐号的密码并确认。此密码一定要牢记，否则会带来许多麻烦。<br>
    　　④当系统询问“是否要制作紧急修复磁盘”时，请选择“是”这一选项。该紧急修复磁盘会在日后系统维护时发挥作用。<br>
    　　⑤选择需要安装的组件，如多媒体、游戏等。<br>
    <br>
    　　第二阶段是“安装Windows NT网络”，（这一过程在初安装时可忽略，但必须在安装结束后使用本文第六部分所讲的内容进行网络功能的设置）安装中的主要信息有：<br>
    　　①当系统询问是“以线路连接到网络”或是采用“远程访问网络”时，由于本讲座是建立LAN，因此，选择“用线路连接到网络”。同时，如果你使用的是ISDN连接方式时，也使用“用线路连接到网络”；当通过调制解调器连接网络时必须选择“远程访问网络”。当然，需要的话，两种连接方式可同时选择。<br>
    　　②询问是否要安装Internet信息服务器，如果你安装的服务器马上要接入Internet，就选择安装，否则可暂时不安装。<br>
    　　③在安装网络适配器(网卡)时，请选择“查找下一个”，此时安装系统将会自动找到你的机器中已安装的网卡，等你确认后系统便安装对应的驱动程序。如果系统在“查找下一个”时发生死机或测不到你的网卡，那么请你跳过此步的安装，等系统安装结束后再重新设置。<br>
    　　④在选择“网络协议”中，系统提供了以下三种可供安装的协议：○TCP/IP协议；○NWLink协议；○NetBEUI协议。<br>
    如果你要连接Internet或与Unix等非Microsoft的网络连接时，请选择TCP/IP协议；如果你所安装的服务器要与Netware网络连接，要选择NWLink协议；而NetBEUI协议非常适合于小型网络，它是我们建立NT网络时必选的一个协议。当然，你可以同时选择多个协议，且多选的协议不会影响系统的正常运行，但是，为了尽量节省系统的内存空间，请你仅选择适合你网络要求的协议部分。<br>
    　　⑤在“计算机名”后输入在网络上代表该服务器的名称，如：NTS01；在“域”名后面输入此网络的域名，如：C&amp;C。<br>
    最后进行的一项是“完成安装”，可在屏幕信息的提示下进行。<br>
    <br>
    四、测试你安装的NTS4.0服务器<br>
    <br>
    　　如果在安装NTS4.0时没有安装系统的网络功能，那么你可先阅读本文第六部分的内容。当NTS4.0服务器安装结束后，有必要对它进行系统的测试，看其是否能工作正常，一般可按如下步骤进行：<br>
    　　1.启动NTS4.0服务器，提示按“Ctrl+Alt+Del”三个功能键进行登录（而不是DOS下的热启动），当输入“密码”后，若正常，将出现图1所示的操作界面，是否与Windows95相似？很亲切吧！<br>
    　　2.选择“程序”项中的“管理工具（公用）”一项，如图2,用“事件查看器”检查安装中是否有错误发生。如图3所示，若哪一项上标有红色图示[stop]，表示该项有严重错误发生，须重新设置。<br>
    　　3.若能够正常启动并成功地登录，再转入“网上邻居”查看是否可以浏览到该服务器（如果已有工作站与该服务器相连，也可查看是否能够浏览到工作站的用户名），如图4。若能浏览到，表示安装过程基本正常，否则需要重新安装或设置服务器的网络功能。<br>
    若系统无法启动或在以上的测试中存在没有通过的项目，可采取下列的方法进行解决。<br>
    <br>
    五、系统故障排除<br>
    <br>
    　　如果事先做好各项工作，NTS4.0的安装是很简单的。不过几乎所有的初学者在第一次安装时，都不可能一次就成功，即使是安装成功了，也经常会出现一些系统故障。为此，下文将分类介绍NTS4.0服务器常见的故障和排除方法，这部分内容在平时的网络维护中也是非常重要的。<br>
    　　1.开机启动时的故障及其排除<br>
    　　如果你的计算机在开机后无法启动，在检查机器的CMOS设置正确、机器的其他硬件没有出错后，以下列出了常见的无法启动的显示信息以及相应的解决办法：<br>
    　　①显示出错信息:“BOOT:Couldn't find NTLDR ,Please insert another disk”<br>
    　　出错原因和解决办法:该信息表示C:盘根目录下的隐含文件NTLDR丢失，并且C:盘的文件格式为FAT格式。位于根目录下的隐含文件NTLDR是NTS4.0开始启动时必须先装入的一个程序,为解决以上问题，必须恢复NTLDR文件。最简单的办法是用DOS启动后，将源安装盘下的NTLDR文件复制到C:盘根目录下，并重新启动计算机。建议用户备份NTLDR文件，防止类似错误的再次发生。<br>
    　　②显示出错信息:“A kernel file is missing from the disk,insert a system 
    diskette and restart the system”<br>
    　　出错原因和解决办法:该出错信息表示C:盘根目录下的隐含文件NTLDR丢失，且C:盘的文件格式为NTFS格式。解决的办法是使用安装NTS4.0时所制作的紧急修复磁盘，将修复磁盘插入A:驱动器，重新启动系统，按系统的提示自动完成对NTLDR文件的修复。<br>
    　　③当启动到屏幕由黑色变成蓝色时，出现“Inaccessible bott device”<br>
    　　出错原因和解决办法:出错原因有两种可能，一种是C:盘的引导区感染了病毒，另一种可能是硬盘的类型（TYPE）设置不正确，例如在安装NTS4.0时选择的是LBA模式，但是安装结束后因故改为其他模式。解决的办法是：如果是引导区感染了病毒，则可使用杀毒软件对硬盘进行全面杀毒;如果是硬盘的类型设置不正确，请进入CMOS，将硬盘的类型还原到以前的与NTS4.0安装时相兼容的模式。<br>
    　　④笔者在写本文时，使用的一台安装样机在安装中第二次启动后，当出现“OS 
    loader V4.00，如果你想……”时，不管按哪个键，在近一刻钟的时间内都没有反应。接着重新安装，故障依旧。后来发现机器上所有的可执行文件几乎都感染了病毒。杀毒后，安装一切正常。<br>
    　　当然，在实际的安装和应用中出错信息还有很多，不过许多故障都可用紧急修复磁盘来解决，所以安装NTS4.0时，强烈要求大家一定要制作此磁盘。<br>
    　　2.使用未被支持的设备<br>
    　　在安装过程中，有些设备的确在机器中存在，但系统却无法检测到它;有些即使能够检测到，也无法安装对应的驱动程序。这时很有可能你使用了未被NTS4.0支持的设备，尤其是一些生产较早的网卡、声卡等。解决这一问题的办法是在选购网卡、声卡等设备时，一定要选支持NTS4.0的，而且设备附带相应的驱动程序。虽然NTS4.0自带了大量的设备驱动程序，但它毕竟不是“驱动程序大全”，而且现在同一计算机设备的品牌也是非常繁杂的。<br>
    　　3.网卡的中断(IRQ)冲突和输入/输出(I/O)地址冲突的解决办法<br>
    　　大多数人在Windows95下安装PCI或ISA类型的声卡或网卡时，基本不会发生中断冲突的问题，因为Windows95支持即插即用（PnP）的功能。但是NT不是一个支持即插即用的操作系统，同时它对可能发生的中断冲突或输入/输出地址的冲突非常敏感，这给许多板卡的使用和设置带来了不便，好象又回到了DOS时代。<br>
    　　①设置网卡中断。网卡是通过中断来通知CPU响应网络请求的，所以在服务器中,网卡必须有一个固定的中断值，且此中断值绝不能与其他设备的中断值相同，否则将发生中断冲突。PC机中总共支持16个IRQ，如表2，从表中可以看出，IRQ5、9、10、11、15都是可以被直接安全使用的。安装网卡时，IRQ5是最常用的中断值，建议其他设备一般不要使用此值。<br>
    　　②设置I/O地址。设置I/O地址时，唯一要注意的就是任何两种设备不要使用相同的I/O地址，以避免因为I/O地址冲突造成死机或运行不正常。I/O地址一般是三位数字，对网卡而言，典型的取值范围可从300H或310H开始。<br>
    <br>
    IRQ的一般设置<br>
    RQ&nbsp;&nbsp;&nbsp; 用途&nbsp;&nbsp;&nbsp; 说明<br>
    0&nbsp;&nbsp;&nbsp; 定时器 &nbsp;&nbsp;&nbsp; 
    已固定设计在主机板内，无法更改<br>
    1&nbsp;&nbsp;&nbsp; 键盘&nbsp;&nbsp;&nbsp; 已固定设计在主机板内，无法更改<br>
    2&nbsp;&nbsp;&nbsp; 利用其与第2个中断控 &nbsp;&nbsp;&nbsp; 
    为了避免死机或系统无法正常运行，<br>
    &nbsp;&nbsp;&nbsp; 制器（8259）串连&nbsp;&nbsp;&nbsp; 此值最好不要作为他用<br>
    3&nbsp;&nbsp;&nbsp; COM2或COM4 &nbsp;&nbsp;&nbsp; 
    第二或第四个串行接口（最好不用）<br>
    4&nbsp;&nbsp;&nbsp; COM1或COM3 &nbsp;&nbsp;&nbsp; 
    第一或第三个串行接口（最好不用）<br>
    5&nbsp;&nbsp;&nbsp; LPT2&nbsp;&nbsp;&nbsp; 第二台打印机，因很少使用第二台<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 打印机，固IRQ5可被拿来使用<br>
    6&nbsp;&nbsp;&nbsp; 软盘控制器&nbsp;&nbsp;&nbsp; <br>
    7&nbsp;&nbsp;&nbsp; LPT1&nbsp;&nbsp;&nbsp; 第一台打印机<br>
    8&nbsp;&nbsp;&nbsp; 实时时钟 &nbsp;&nbsp;&nbsp; 
    已固定设计在主机板内，无法更改<br>
    9&nbsp;&nbsp;&nbsp; 未用&nbsp;&nbsp;&nbsp; 可直接使用<br>
    10&nbsp;&nbsp;&nbsp; 未用&nbsp;&nbsp;&nbsp; 可直接使用<br>
    11&nbsp;&nbsp;&nbsp; 未用&nbsp;&nbsp;&nbsp; 可直接使用<br>
    12&nbsp;&nbsp;&nbsp; PS/2、Inport鼠标&nbsp;&nbsp;&nbsp; <br>
    13&nbsp;&nbsp;&nbsp; 数学协处理器 &nbsp;&nbsp;&nbsp; 
    用于处理数学协处理器错误<br>
    14&nbsp;&nbsp;&nbsp; 硬盘控制器&nbsp;&nbsp;&nbsp; <br>
    15&nbsp;&nbsp;&nbsp; 未用&nbsp;&nbsp;&nbsp; 可直接使用<br>
    <br>
    六、设置NTS4.0服务器的局域网功能<br>
    <br>
    　　NTS4.0服务器的网络功能一般在安装NTS4.0时就可完成。但是，如果你在安装NTS4.0时选择了“典型安装”或使用其他安装方式时没有安装系统的网络功能；或由于更换网卡，要求改变服务器的服务功能或协议等原因，都需要对服务器的网络功能进行重新的设置。有关网络功能的安装和设定，都在“控制面板”的“网络”选项内，以下将详细介绍其设置过程：<br>
    　　1.安装网卡及其驱动程序<br>
    　　① 
    将网卡安装在计算机中相应的扩展槽中，并记下该网卡的中断值、I/O地址及扩展槽的位置等必备的参数；<br>
    　　②选择“我的电脑\控制面板\网络”，在出现的“网络”窗口中选择“适配器”选项，出现图5所示的窗口，选择此窗口中的“添加”按钮，又出现图6所示的“选定网络适配器”窗口。这时，你可以在“网络适配器”下方的列表中选择与你机器中所安装的网卡相同的类型，系统将自动安装对应的驱动程序。如果你一时无法确认机器中网卡的类型或从显示的类型中找不到与你的网卡对应的项目时，可选择“从磁盘安装”，出现图7所示的窗口,这时你只需在驱动器中插入网卡附带的驱动程序盘，并输入驱动程序所在的路径，系统将从软盘安装所需的驱动程序。<br>
    　　③随后，系统要求你输入网络的总线“类型”和“编号”，如图8。总线“类型”可根据网卡的不同选择ISA或PCI，“编号”处输入网卡在主机板上扩展槽的位置。<br>
    　　④最后，输入网卡的中断值、I/O地址，按“确定”按钮后系统开始复制相关程序。<br>
    　　2.计算机名称的设定<br>
    　　NT网络用域来实现对网络的管理，在域上计算机名是一个非常重要的信息。在同一域下，为了区分不同的计算机，每个计算机的名称必须唯一。<br>
    　　选择“网络”窗口下的“标识”选项，可显示安装NTS4.0时已创建的“计算机名”和“域”名，如图9所示。当然，此时网络管理员可以对“计算机名”和“域”名进行修改，不过当网络安装好后，最好不要任意变更域名，以免影响网络上其他计算机登录该服务器。<br>
    　　3.设置服务功能<br>
    　　安装了NTS4.0服务器后，不仅作为域控制器来管理局域网中的所有计算机，同时还有其他许多功能和用途，将这些功能或用途称之为“服务”。譬如可作为DNS服务器、网络监视代理、远程访问服务等，这些服务在构建大型网络时是非常重要的。<br>
    　　安装时可选择“网络”窗口下的“服务”功能项，出现图10所示的窗口，在窗口的“网络服务”下方列表中显示出已有的服务项目，如果还要添加其他的服务选项，可按“添加”按钮，在图11所示的“选定网络服务”窗口中可以进行其他服务功能的添加。<br>
    　　4.设置网络通信协议<br>
    　　通信协议在网络中起着连接计算机的桥梁作用，为此，我们可根据实际的通信需要，在网络中随时增减有关的通信协议。<br>
    在“网络”窗口下，选择“协议”项，显示图12所示的窗口，在此窗口中，显示了已有的有关协议，当然也可对已有的协议进行删除。按“添加”按钮后，在图13所示的“选定网络协议”窗口中可添加新的通信协议。当选择了某一协议后，按“确定”按钮，系统将自动复制相关的程序。<br>
    　　以上所有设置，必须在重新启动NTS4.0服务器后才会生效。</span></td>
  </tr>
  <tr>
    <td width="100%" bgcolor="#E8FFFF" height="6"><hr size="1" color="#808080">
    </td>
  </tr>
  <tr>
    <td width="100%" bgcolor="#E8FFFF" height="14"><span class="f">中国程序员网站版权所有</span></td>
  </tr>
</table>
</center></div>
</body>
</html>
