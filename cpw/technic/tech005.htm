<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>远望资讯.微型计算机</title>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<style type="text/css">
<!--
td{font-size: 9pt;line-height: 15px;}
body{font-size: 9pt;line-height: 15px;}
A:link {text-decoration: none; color: blue}
A:visited {text-decoration: none; color: "#54646D"}
A:active {text-decoration: none}
A:hover {text-decoration: underline; color: 000080} 
-->
</style>
</head>

<body>
<div align="center"><center>

<table border="0" width="720" cellspacing="0" cellpadding="4" bgcolor="#E8FFFF">
  <tr>
    <td width="718" height="29"><table border="1" width="32%" bordercolor="#800000"
    cellspacing="0" cellpadding="2" height="30">
      <tr>
        <td width="100%" bgcolor="#4264B5" bordercolor="#FFFFFF"><span class="f"><font
        color="#FFFFFF"><p align="center">资料整理&middot;<a href="http://fasoft.yeah.net"
        target="_blank" style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%" valign="top" bgcolor="#E8FFFF"><br>
    NT4.0组网技术系列讲座(五)<br>
    <br>
    <strong>第五讲 NT网络的资源共享</strong><br>
    <br>
    　　建立网络的目的就是为了连接独立运行的计算机实现系统资源的共享，否则网络也就失去了存在的意义。本讲将介绍在单服务器的网络中设置资源共享的方法。在多服务器（多个域）组成的网络中，可通过设置域与域之间的信任和委托关系来实现不同域之间资源的共享，这部分内容在本讲中暂时不去涉及。<br>
    <br>
    一、 几个概念<br>
    <br>
    1.共享<br>
    　　NT网络中的共享是指将本地系统资源（如文件夹和打印机等）提供给其他网络用户使用。网络中所能访问的仅指那些已设置了共享属性的资源，未被设置共享属性的网上资源是不能被直接访问的。任何一种资源必须先设置一个共享名，才能被他人识别和使用。<br>
    2.共享资源<br>
    　　网络中的共享资源是指一切可供网络用户使用的资源，这些资源大致分为网络设备和网络数据两类。打印机是最常用的可被共享的网络设备，而网络数据主要包括文件、文件夹（目录）和应用程序等。虽然软驱、硬盘和光驱也是硬件设备，但Windows 
    NT在任何时候都将它们视为文件夹加以管理、使用。<br>
    3.权限<br>
    　　“权限”的定义和设置直接关系到网络安全。NT中权限涉及的内容较多，在此仅介绍常用的两种：用户权力(User 
    Rights)和共享权限(Share Permission)。用户权力指用户或组登录并访问NT服务器的权力。在单服务器系统中，用户权力使用较少，而在多服务器系统中，常常通过给用户或组设置不同的权力来限制其访问指定的服务器；共享权限与网络资源紧密联系，它规定了用户或组对共享资源存取的级别。单服务器网络中的权限，主要是指共享权限。合理分配用户的权限，可以达到安全、有效地管理、利用网络资源的目的。多服务器网络中用户权力和权限的使用，在本讲中暂且不涉及。<br>
    <br>
    二、 文件夹共享属性的设置<br>
    <br>
    　　NT只能将文件夹(目录)作为共享资源，而不能对单个文件进行共享设置。将一个文件夹设置为共享后，该文件夹下的所有文件及下层文件夹（子目录）也就同时拥有此属性，即共享文件夹下的所有数据都可以被网上用户访问。<br>
    1.在NTS4.0服务器上添加共享文件夹<br>
    　　设置过程如下:①以Administrator身份登录 NTS4.0服务器，打开资源管理器，选择要设置共享的文件夹名，按鼠标右键，选择快捷菜单中的“共享”选项，在出现的共享对话框中单击“共享”标签，如图1。如果服务器的内存少于16MB，将无法对文件夹设置共享属性。此时，可打开控制面板，双击“服务”图标，在图2所示对话框列表中选择“Server”并单击对话框中的“启动”按钮，强行启动“Server”功能即可设置共享。为此，建议NTS4.0服务器的内存不要少于32MB;②点选图1中“共享为”选项以确定该文件夹的共享名，缺省时共享名与原文件夹名相同，用户可任意更改。共享名最长可取12个字符，如网络中有DOS工作站，应尽量使共享名长度不超过8个字符，并遵循DOS文件的命名规则;③“备注”栏内可输入一些说明文字。如果想限制同时访问此文件夹的用户数，请选择“用户个数”下方的“允许...个用户”项，并输入最大个数，系统默认为“无限制”。此选项主要迎合某些软件的特殊要求，比如一些限制最大用户数的网络软件;④当选择“权限”按钮后，可设置共享文件夹的权限。设置完成后，该文件夹图标将变为被一只手托着的文件夹。设置了共享属性的文件夹也可随时停止共享，方法与设置共享的操作相似，只须在与图1相似的对话框（注意多出了几个按钮）中单击“不共享”即可。在对某个文件夹停止共享前，应确定已没有用户使用该文件夹下的数据，否则会导致用户数据的丢失。<br>
    另外，同一工作组内的用户可以互相访问工作站上的资源（当网络规划中没有使用工作组时，一个域名即为概念上的一个工作组），在Windows95/98/NT工作站上资源共享的设置方法与在NTS4.0服务器上的设置基本相同。<br>
    <br>
    2.设置共享文件夹的使用权限<br>
    　　执行与添加共享文件夹同样的步骤，直到出现与图1相同的窗口。单击窗口中的“权限”按钮，在随后出现的图3所示对话框中，可为不同的用户分别设置各种权限。新建立共享的文件夹，NTS4.0的默认设置是“Everyone”，即每个用户对该共享文件夹拥有“完全控制”的权限。这样的权限设置和网络安全的要求是不符的，通常应根据用户不同特征，给每一共享文件夹分别赋予不同的共享权限。因此，应先将“Everyone”从对话框列表中“删除”。然后单击“添加”按钮，进入图4所示的“添加用户及组”对话框，重新进行用户权限分配。这时有两种选择――为用户组授权或为单个用户授权。为组用户授权可使组中每一成员对该共享文件夹具有同等的使用权限。从对话框的“名称”列表中选择欲赋予使用权限的组名(如STU)，按“添加”按钮后该组将显示在“添加名称”列表中。然后从对话框下方的“访问类型”列表中选择该组的权限(共有四种文件权限，见图4下方弹出列表)，也可返回图3所示的对话框后再完成组用户权限的设置;出于建立更加完善的安全性的考虑，有时需要为同一个组中某个或某些用户赋予不同的权限。此时，可按如下步骤设置。首先在图4中点选组名，然后单击对话框中的“成员”按钮，将出现图5所示“全局组成员”对话框。从该对话框中罗列的组用户名单中选择用户名（一次可选多个），单击“添加”按钮后，回到图3或图4的对话框，都可对他们设置相应的权限。以上操作充分体现了组（用户组）在管理用户帐号中的重要性和灵活性。<br>
    　　当磁盘文件系统为NTFS时，借助NTFS更高级别的安全性设计，可以实现对共享文件夹更完整的安全性设置，见图6。这些设置包括对文件夹、甚至单个文件更详细的使用权限（Local 
    Permission），见图7;用户的对共享文件夹操作的审核（操作记录），见图8;文件夹、文件所有权的更改，见图9。这些高级的安全特性都是FAT文件系统无法实现的，因此，建议在安装NTS时选用这种先进的文件系统。<br>
    <br>
    3.设置共享文件和文件夹的属性<br>
    　　共享文件、文件夹和文件属性的含义与DOS、Win9x下的文件属性大致相同，除包括只读、归档（档案）、隐藏和系统四种属性外，NTFS文件系统中还多了一项“压缩”属性，见图10。设置文件属性的操作，与在Win9x中完全一样，这里不再赘述。有两点需要强调的是，第一，文件夹的属性和该文件夹下文件的属性是独立的，即当给文件夹设置了一种或几种属性后，它只对该文件夹起作用，而对文件夹下的文件不起作用；第二，当给某文件夹设置了“隐藏”属性后，在工作站上将无法查看到该文件夹名，但如果你确实知道被隐藏的文件夹名和文件名，在访问时可在共享文件夹名的后面加一个“$”符号，例如：\\NTS01\PROGRAM$。<br>
    <br>
    4.从工作站映射网络驱动器<br>
    　　远程工作站或服务器中已经设置共享属性的文件夹，必须在网络工作站上将其映射为网络驱动器，才能真正实现文件资源的共享。下面我们将详细介绍从Windows95、DOS和Windows 
    for Workgroups 3.11(以下简称为WFW)工作站上映射网络驱动器的方法。<br>
    　　①从Windows95工作站上映射网络驱动器。<br>
    　　打开“网上邻居”窗口，找到并双击远程共享文件夹所在的计算机名（如服务器名:NTS01）;在新弹出的窗口中点选该共享文件夹，然后在“文件”下拉菜单中选择“映射网络驱动器”功能项;此时将出现图11所示的对话框，在“驱动器”栏内选择映射后的网络驱动器名；如果每次进入网络后都要保持与该文件夹的映射关系，可选择“登录时重连接”一项;单击“确定”后完成网络驱动器映射操作。此时在资源管理器左边的文件夹窗口中，会增加一个驱动器图标（与普通硬盘驱动器图标不同的是，这个图标的下边会多出一根管道，令人联想到网络）。此外，在Windows98/NT上映射共享文件夹的方法与在Windows95中的方法基本相同。<br>
    　　②从DOS工作站上映射网络驱动器。<br>
    　　如果是DOS用户，在保证DOS工作站已成功登录到NT服务器的情况下，可利用“NET 
    USE”命令完成网络上共享文件夹的映射连接。例如，要将域中的NTS01服务器上的共享文件夹“Program”映射成网络驱动器“G:”时，可键入如下命令“NET 
    USE G: \\NTS01\PROGRAM”。这里，网络驱动器名与远程共享文件夹完整路径（由计算机名+共享文件夹名组成）之间必须用空格键分开，而且计算机名前面是两个左斜杠“\\”。另外，还可以直接在DOS提示符下输入NET命令，用它提供的一个人机交互的界面来完成共享文件夹的映射操作，具体内容请参看本讲座第四讲有关内容。需要记住的是，当DOS工作站关机之前，应先撤消对网络驱动器的映射，以免打开的远程共享文件数据丢失。这可以用Net 
    use G:/delete命令实现。<br>
    　　由于DOS系统只能识别8.3格式的文件名，Windows95/98/NT中长文件名的应用程序在DOS环境下无法运行。所以，当网络中存在DOS工作站时，在Windows95/98/NT系统中建立文件时，应尽量将其命名为DOS可识别的格式。<br>
    　　③从WFW工作站上映射网络驱动器<br>
    　　WFW工作站可通过主群组下的文件管理器来共享网络上的资源。选取“Main/File 
    Manager/Disk/Connect Network Drive”，将出现图12所示的对话框，在对话框的“Show 
    Shared Directories on”列表框中选择远程工作站或服务器，然后在下方的“Shared 
    Directories on \\...”列表框中选择该远程计算机上对应的共享文件夹；然后在“驱动器”(Drive)栏内选择一个映射驱动器名，单击“确定”(OK)后，这个驱动器名将会在文件管理器的窗口中出现，这时你可以象使用本地的文件或设备一样来共享网上资源了。如果要断开网络的映射,可利用“Disk/Disconnect 
    Network Drive”选项，在出现窗口的“驱动器”(Drive)列表中选择要断开的映射关系，单击“确定”(OK)按钮即可。<br>
    <br>
    三、 网络打印机的添加和管理<br>
    <br>
    1.什么是网络打印机<br>
    　　在网络中，不但可以将文件和文件夹提供给网上用户使用，而且还可以将打印设备提供给网上用户共享，这就是所谓的网络打印机。为了更加清楚地理解网络打印的概念，我们将网络打印机分为打印设备和打印机两类：其中打印设备专指物理打印机（确确实实能看得到的打印机），而打印机在这里被视为一个逻辑设备，它是程序与打印设备之间的软件接口(看不到实物)。同时，我们将连接打印设备的计算机叫做打印服务器。打印服务器可以是专用的，也可以由文件服务器或用户工作站兼任。<br>
    　　要实现打印机的共享，必须注意以下三点:一是连接打印机的计算机(打印服务器)必须能让其他用户访问(已登录到NT域);二是该打印机必须设置为共享状态;三是需要打印文件的用户必须指定文件由谁来打印。以下讲述的打印机的添加和管理也是从这三个方面来考虑的。将普通打印机作为网络打印机前，首先要将其连接到一台计算机(打印服务器)上。还有两种实现网络打印的解决方案，一是使用专用的打印服务器设备用于连接普通打印机，实现打印共享;另一种是购买自带网络接口的打印机，它不需要计算机作为中介，而是直接连接到网络上。这两种都是“货真价实”的网络打印机，一台打印机就是一个打印服务器。本文中使用的打印机为普通打印机。<br>
    2.选择打印服务器<br>
    　　首先要考虑将打印设备连接到网络上的哪一台计算机，即由哪一台计算机作为打印服务器。为了方便用户的访问，可以考虑将网络服务器兼做打印服务器，也可任选一台工作站来充当打印服务器。选择打印服务器时必须考虑的另一个问题是操作系统。理论上DOS、Windows 
    3.x和Windows for Workgroups 3.11工作站都可作为文件服务器，但在运行这些操作系统的计算机上设置网络打印机是一项极为繁琐的工作，且不利于发挥网络打印机的功能，也不利于网络的日常管理和维护。比较理想的是使用安装有Windows 
    95/98/NT的计算机作为打印服务器。选择好打印服务器后，将打印机连接到打印服务器的并行口(一般为LPT1)上。(下文实例中选用的是一台运行Windows 
    98的工作站兼做打印服务器，计算机名为LFJ，使用HP-5L激光打印机）。<br>
    3.在打印服务器上添加打印机<br>
    　　在打印服务器上，通过“添加打印机向导”来完成添加打印机。具体步骤如下:①选择“开始/设置/打印机”，在出现的窗口中双击“添加打印机”图标，出现“添加打印机向导”窗口后单击“下一步”。当出现图13所示的提示信息时，点选“本地打印机”一项（用于设置打印服务器连接的打印设备，只有通过这一项才能将打印设备设置为共享）;②单击“下一步”将出现图14所示的对话框，在对话框中选择正确的“生产商”和“打印机”。如列表中没有与你的打印设备相符合的选项时，可以利用打印机提供的驱动程序软盘，选择“从软盘安装”;②单击“下一步”后，在出现的窗口中给打印机分配一个端口，一般为LPT1。继续“下一步”并默认给出的打印机名（也可更改，但无意义）;④单击“下一步”后“安装向导”问你要不要测试打印机，最好测试一下，虽然要“浪费”一张纸，但也避免了设置上可能存在的错误。按“确定”后，添加结束。<br>
    4.将打印设备设置为共享状态<br>
    　　为了让添加的打印设备可被网上用户使用，必须将它设置为共享状态，该设置操作也是在打印服务器上完成。选取添加打印机后生成的打印机图标，选择“文件”下拉菜单中的“共享”功能项，在出现的对话框中选择“共享”标签，如图15所示。在对话框中选择“共享为”一项，并在“共享名”栏内输入正确的共享名。为了保证DOS工作站能够使用该网络打印机，共享名不要超过8个字符（如HP5L）。对网络打印机，同样可以设置用户权限，而且，为了限制未经授权的用户将数据资料打印带走，还可选择“密码”选项并输入密码。这样，当合法用户访问此打印机时也必须输入正确的密码，否则拒绝访问。<br>
    5.如何从工作站端使用网络打印机<br>
    　　这儿的工作站是相对于打印服务器而言的。要在工作站上使用网络打印机，必须设置网络打印机的网络路径，并指定打印机类型，完成将网络打印机映射成本地打印机的操作。结合第四讲内容，以下介绍在Windows95、DOS和Windows 
    for Workgroups 3.11工作站上使用网络打印机的方法:<br>
    ① 从中文Windows95工作站使用网络打印机<br>
    　　在使用网络打印机之前，必须先在工作站本地系统上添加网络打印机。在工作站上安装打印机时也使用“添加打印机向导”来完成，不过要保证打印服务器已经正常上网，且能与你的工作站连通。设置时前面的步骤与前文中添加打印机相同，只是到了图14所示的窗口时，选择“网络打印机”一项。单击“下一步”后，在图16所示的对话框的“网络路径或队列名”栏内，输入网络打印机的正确路径和名称（\\LFJ\HP5L）。也可单击“浏览”按钮，在出现的“浏览打印机”对话框中直接选取。如果还要从DOS应用程序中使用网络打印机，应该勾选下方“从基于MS-DOS的程序打印吗？”的“是”一项。单击“下一步”后，出现图17所示的对话框，在对话框的“打印机名称”下方输入打印机名。如选择了要从基于MS-DOS的程序打印选项，此处的打印机名也不能超过8个字符。如果需要，可将该网络打印机设置为默认打印机，这样，即使工作站有本地打印机，打印操作也是首选网络打印机来完成打印。单击“下一步”后，进行打印测试。测试正确后，单击“完成”结束设置。打印时使用网络打印机的方法与使用本地打印机没任何区别，只要选择正确的打印机名就可以了。从运行Windows95/NT的工作站上设置网络打印机的方法与Windows98基本相同。<br>
    ②从DOS工作站使用网络打印机<br>
    　　如果要从DOS工作站上使用NT网络中的打印机，必须先进行以下两项设置：第一项是在工作站上安装打印机驱动程序。如HP5L激光打印机随机器带有一张DOS下的打印驱动程序盘，只需运行安装文件（SETUP.BAT），在窗口信息的提示下进行安装即可；第二项是进行网络连接。网络连接时使用“NET 
    USE”命令，例如：你要连接LFJ计算机上名为HP5L的打印机时，需输入：“NET 
    USE LPT1: \\LFJ\HP5L”（请注意打印机端口名LPT1后面必须加“：”号）。连接前为了证实工作站是否已与打印服务器连接正常，可使用“NET 
    VIEW”命令先查看一下。经过以上两步的设置，就可以按照一般的方式进行网络打印了。如果你要中断已连接的网络打印机，则可使用“NET 
    USE LPT1: /DELETE”命令。<br>
    ③从WFW工作站上使用网络打印机<br>
    　　在基于DOS的操作系统中，WFW的网络功能是最完善的，所以许多网络用户对WFW都有一种特殊的偏爱。从WFW工作站使用网络打印机前也要进行以下两步的设置：第一步，安装打印机驱动程序。选择“主群组/控制面板/打印机（Main/Control 
    Panel/Printers）”，将出现图18所示的窗口，从“打印机列表”（List of 
    Printers）中选择打印机驱动程序，然后单击“安装”（Install）按钮，系统将从WFW的安装盘中安装对应的驱动程序。但因WFW推出较早，象HP5L这样的驱动程序在列表中可能找不到，这时应选择从磁盘安装。选择好打印驱动程序后，将进入图19所示的窗口，在此窗口中选择打印机端口，一般情况下选择LPT1。单击“确定”（OK）后，打印机设置结束；第二步，连接网络打印机。在图19中单击“网络”（Network）按钮，将出现图20所示的对话框，在“路径”（Path）栏内输入网络打印机正确的路径。不过最好先从对话框的“Show 
    Shared Printers on”列表中选择打印服务器的计算机名，此时该打印服务器的打印机名将会显示在“Shared 
    Printers on \\...”下方列表中。用鼠标选择共享打印机名，刚才的操作将自动输入“路径”（Path）栏内，而且避免了输入格式上的错误。单击“确定”（OK）后设置结束。也可以利用“主群组”（Main）下的“打印机管理器”（Printer 
    Manager）进行网络打印机的连接。当要断开已建立的网络打印连接时，也可在“打印管理器”窗口中完成。网络打印机连接完成后，其打印操作与使用一般打印机的方法完全相同，如在WORD 
    6.0、WRITE等软件下可以象使用本地打印机一样方便地进行网络打印。<br>
    　　最后指出一点，就是在基于DOS的工作站上安装网络打印机，必须要给出厂商的驱动程序而在Win9x及NT上则不一定。另外，如果在Win 
    9x及NT中映射网络打印机时，打印机列表中能找到对应的打印机型号，则不需打印驱动程序。否则，必须提供厂商的驱动程序，才能完成网络打印机在工作站上的安装设置工作。<br>
    <br>
    <br>
    编后语:<br>
    　　各位读者，我们的《NT 4.0组网技术系列讲座》到这一期，已完成了用Windows 
    NT Server 4.0组建局域网所必须的基本知识和具体操作的介绍。通过这五期讲座，我们希望各位对Windows 
    NT Server感兴趣的朋友，都能对这个强大的网络操作系统有一定的认识。如果情形确实如此的话，那我们将感到非常欣慰。但事实上，由于各位读者的网络知识参差不齐，可能我们的讲座对一些偏向更深层次的原理，以及对具体的Windows 
    NT Server组网解决方案实例感兴趣的朋友没有照顾到。在此，对前一类读者我们只能说:“非常对不起”。因为，我们是一本面向初、中级计算机用户、偏向指导读者实际动手解决问题的刊物。而对后一类读者，我们将在以后的几期杂志上，陆续刊登一些使用Windows 
    NT Server 4.0组建无盘工作站、Intranet以及本地小型局域网的实例。在这些后续文章中，我们将详细地介绍各种网络建设方案中，从产品选型、安装、设置到使用中的经验和技巧。我们期待着我们的杂志能给你们一个比较详细、完整的解决方案。各位网络爱好者们，敬请留意。另外，再次欢迎各位读者涌跃投稿，向我们道出您的组网“秘技”，让我们共同提高。 
    </td>
  </tr>
  <tr>
    <td width="100%" valign="top" bgcolor="#E8FFFF"></td>
  </tr>
  <tr>
    <td width="100%" height="6"><hr size="1" color="#808080">
    </td>
  </tr>
  <tr>
    <td width="100%" bgcolor="#E8FFFF" height="14"><span class="f">中国程序员网站版权所有</span></td>
  </tr>
</table>
</center></div>
</body>
</html>
