<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>用ASP编写一个简单的聊天室</title>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
</head>

<body bgcolor="#8080C0">
<div align="center"><center>

<table border="1" cellspacing="0" cellpadding="2" width="95%" style="font-size: 9pt"
bordercolor="#000000" bordercolordark="#FFFFFF">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">您现在的位置是： <b><a href="home_idx1.htm">主页制作</a> 
    --&gt; </b></span><font color="#000000">用ASP编写一个简单的聊天室</font></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#FFFFFF"
bordercolor="#000000" cellpadding="2" cellspacing="0" bordercolordark="#FFFFFF">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2" bgcolor="#FFFFFF" bordercolor="#000000"
    bordercolordark="#FFFFFF">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><span style="font-size: 9pt"><font
        color="#FFFFFF">资料整理&middot;<a href="http://chinaprog.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></span></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%">　<p align="center"><strong><font color="#000000">用ASP编写一个简单的聊天室</font></strong></p>
    <p>&lt;%@ Language=VBScript %&gt;<br>
    &lt;%<br>
    Response.Buffer=true ' 设 置 输 出 缓 存，用 于 显 示 不 同 页 面。<br>
    On error resume next ' 忽 略 程 序 出 错 部 分<br>
    If Request.ServerVariables(&quot;Request_Method&quot;)=&quot;GET&quot; then<br>
    ' 判 断 客 户 是 以 什 么 方 式 请 求 WEB 页 面<br>
    '------------------------<br>
    ' 客 户 登 陆 界 面 <br>
    '------------------------<br>
    %&gt;<br>
    <br>
    &lt;form method=&quot;POST&quot; 
    action=&quot;http://www.cs02.com/luo40.asp&quot;&gt;&lt;p&gt;&nbsp; <br>
    'http://www.cs02.com/luo40.asp为聊天室存放的路径<br>
    &lt;input type=&quot;text&quot; name=&quot;名字&quot; size=&quot;20&quot; 
    value=&quot;nick&quot; style=&quot;background-color: rgb(192,192,192)&quot;&gt;&lt;br&gt;<br>
    &lt;input type=&quot;submit&quot; value=&quot; 进 入 聊 天 室 &quot; 
    name=&quot;B1&quot; style=&quot;color: rgb(255,255,0); font-size: 9pt; background-color: 
    rgb(0,128,128)&quot;&gt;<br>
    &lt;p&gt;&lt;input type=&quot;hidden&quot; name=&quot;log&quot; size=&quot;20&quot; 
    value=&quot;1&quot;&gt;&lt;br&gt;&lt;/p&gt;<br>
    &lt;/form&gt;<br>
    <br>
    &lt;%<br>
    Response.End ' 结 束 程 序 的 处 理<br>
    Else<br>
    Response.clear ' 清 空 缓 存 中 的 内 容<br>
    dim talk<br>
    If Request.Form(&quot;nick&quot;)&lt;&gt;&quot;&quot; then<br>
    ' 判 断 客 户 是 是 否 在 聊 天 界 面 中 <br>
    Session(&quot;nick&quot;)=Request.Form(&quot;nick&quot;)<br>
    End If<br>
    '------------------------<br>
    '客 户 聊 天 界 面 <br>
    '------------------------<br>
    %&gt;<br>
    <br>
    &lt;form method=&quot;POST&quot; action=&quot;http://www.cs02.com/luo40.asp&quot; 
    name=form1&gt; &lt;p&gt;&lt;%=Session(&quot;nick&quot;)%&gt; 说 话：&lt;input 
    type=&quot;text&quot; name=&quot;talk&quot; size=&quot;50&quot;&gt;&lt;br&gt;<br>
    &lt;input type=&quot;submit&quot; value=&quot; 提 交 &quot; name=&quot;B1&quot;&gt;<br>
    &lt;input type=&quot;reset&quot; value=&quot; 取 消 &quot; 
    name=&quot;B2&quot;&gt;&lt;/p&gt;<br>
    &lt;/form&gt;<br>
    &lt;A HREF=&quot;http://www.cs02.com/luo40.asp&quot;&gt; 离 开 
    &lt;/a&gt;&lt;br&gt;&lt;br&gt;<br>
    <br>
    &lt;%<br>
    If Request.Form(&quot;log&quot;)&lt;&gt;1 then<br>
    If trim(Request.Form(&quot;talk&quot;))=&quot;&quot; then<br>
    ' 判 断 用 户 是 否 没 有 输 入 任 何 内 容 <br>
    talk=Session(&quot;nick&quot;)&amp;&quot; 沉 默 是 金。&quot;<br>
    Else<br>
    talk=trim(Request.Form(&quot;talk&quot;))<br>
    ' 去 掉 字 符 后 的 空 格 <br>
    End If<br>
    <br>
    Application.lock<br>
    Application(&quot;show&quot;)=&quot;&lt;table border='0' cellpadding='0' cellspacing='0' 
    width='85%'&gt;&lt;tr&gt;&lt;td width='100%' 
    bgcolor='#C0C0C0'&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width='100%'&gt;&lt;font 
    color='#0000FF'&gt; 来 自 
    &quot;&amp;Request.ServerVariables(&quot;remote_addr&quot;)&amp;&quot; 的 
    &quot;&amp;Session(&quot;nick&quot;)&amp;time&amp;&quot; 说：&lt;/font&gt;&quot;&amp;talk&amp;&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td 
    width='100%' 
    bgcolor='#C0C0C0'&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;&quot;&amp;Application(&quot;show&quot;)<br>
    Application.UnLock<br>
    <br>
    Response.Write Application(&quot;show&quot;)<br>
    End If<br>
    End If<br>
    %&gt;</p>
    <p>　<font color="#000000">这只是一个简单的例子，希望朋友们能举一反三，写出更好的程序。这点最大的缺点是没有自动刷新功能，要写出这样的功能，还须努力学习啊！！</font></td>
  </tr>
</table>
</center></div>

<p><font size="6" color="#FF0000"><strong>&nbsp;&nbsp; </strong></font></p>
</body>
</html>
