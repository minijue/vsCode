<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>用ASP发电子邮件</title>
</head>

<body>
<div align="center"><center>

<table border="0" cellspacing="2" cellpadding="0" width="95%" style="font-size: 9pt">
  <tr bgcolor="#CCFFCC">
    <td><span style="font-size: 9pt">现在的位置是： <b><a href="home_idx1.htm">主页制作</a>--&gt;</b> 
    </span>用ASP发电子邮件</td>
  </tr>
  <tr>
    <td></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="95%" style="font-size: 9pt" bgcolor="#E8E8E8"
bordercolor="#C48C59" cellpadding="2">
  <tr>
    <td width="100%"><table border="1" width="32%" style="font-size: 9pt" height="30"
    cellspacing="0" cellpadding="2">
      <tr>
        <td width="100%" bgcolor="#4264B5"><p align="center"><font color="#FFFFFF">资料整理<span
        class="f">&middot;</span><a href="http://fasoft.yeah.net" target="_blank"
        style="color: rgb(255,255,255)">中国程序员网站</a></font></td>
      </tr>
    </table>
    </td>
  </tr>
  <tr>
    <td width="100%"><p align="center"><strong>用ASP发电子邮件</strong></p>
    <p align="left"><br>
    ASP Source Code: 源代码:<br>
    <br>
    <br>
    --------------------------------------------------------------------------------<br>
    <br>
    &lt;%<br>
    Dim strTo, strSubject, strBody 'Strings for recipient, subject, boby<br>
    Dim objCDOMail 'The CDO object<br>
    <br>
    <br>
    'First we'll read in the values entered<br>
    strTo = Request.Form(&quot;to&quot;)<br>
    <br>
    'These would read the message subject and body if we let you enter it<br>
    'strSubject = Request.Form(&quot;subject&quot;)<br>
    'strBody = Request.Form(&quot;body&quot;)<br>
    <br>
    strSubject = &quot;Sample E-mail sent from ASP 101!&quot;<br>
    <br>
    ' This is multi-lined simply for readability<br>
    strBody = &quot;This message was sent from a sample at http://www.asp101.com. &quot;<br>
    strBody = strBody &amp; &quot;It is used to show people how to send e-mail from an &quot;<br>
    strBody = strBody &amp; &quot;Active Server Page. If you did not request this &quot;<br>
    strBody = strBody &amp; &quot;e-mail yourself, your address was entered by one of &quot;<br>
    strBody = strBody &amp; &quot;our visitors. We do not store these e-mail addresses.&quot;<br>
    strBody = strBody &amp; &quot; Please address all concerns to webmaster@asp101.com.&quot;<br>
    <br>
    'Ok we've got the values now on to the point of the script.<br>
    <br>
    'We just check to see if someone has entered anything into the to field.<br>
    'If it's equal to nothing we show the form, otherwise we send the message.<br>
    'If you were doing this for real you might want to check other fields too<br>
    'and do a little entry validation like checking for valid syntax etc.<br>
    If strTo = &quot;&quot; Then<br>
    &nbsp;&nbsp;&nbsp; %&gt;<br>
    &nbsp;&nbsp;&nbsp; &lt;FORM ACTION=&quot;./email_cdo.asp&quot; METHOD=&quot;post&quot;&gt;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Enter your e-mail address:&lt;BR&gt;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;INPUT TYPE=&quot;text&quot; 
    NAME=&quot;to&quot; SIZE=&quot;30&quot;&gt;&lt;/INPUT&gt;<br>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- These would be used if we decided to 
    let you edit them<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Subject:&amp;nbsp;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;INPUT TYPE=&quot;text&quot; 
    NAME=&quot;subject&quot; SIZE=&quot;30&quot;&gt;&lt;/INPUT&gt;&lt;BR&gt;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Message:&amp;nbsp;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TEXTAREA NAME=&quot;body&quot; 
    ROWS=&quot;10&quot; COLS=&quot;40&quot; 
    WRAP=&quot;virtual&quot;&gt;&lt;/TEXTAREA&gt;&lt;BR&gt;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&gt;<br>
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;INPUT TYPE=&quot;submit&quot; 
    VALUE=&quot;Send Mail!&quot;&gt;&lt;/INPUT&gt;<br>
    &nbsp;&nbsp;&nbsp; &lt;/FORM&gt;<br>
    &nbsp;&nbsp;&nbsp; &lt;%<br>
    Else<br>
    &nbsp;&nbsp;&nbsp; ' Create an instance of the NewMail object.<br>
    &nbsp;&nbsp;&nbsp; Set objCDOMail = Server.CreateObject(&quot;CDONTS.NewMail&quot;)<br>
    &nbsp;&nbsp;&nbsp; <br>
    &nbsp;&nbsp;&nbsp; ' Set the properties of the object<br>
    &nbsp;&nbsp;&nbsp; objCDOMail.From = &quot;webmaster@asp101.com&quot;<br>
    &nbsp;&nbsp;&nbsp; objCDOMail.To = strTo<br>
    &nbsp;&nbsp;&nbsp; objCDOMail.Subject = strSubject<br>
    &nbsp;&nbsp;&nbsp; objCDOMail.Body = strBody<br>
    <br>
    &nbsp;&nbsp;&nbsp; ' There are lots of other properties you can use.<br>
    &nbsp;&nbsp;&nbsp; ' You can send HTML e-mail, attachments, etc...<br>
    &nbsp;&nbsp;&nbsp; ' You can also modify most aspects of the message<br>
    &nbsp;&nbsp;&nbsp; ' like importance, custom headers, ...<br>
    &nbsp;&nbsp;&nbsp; ' Check the documentation for a full list as well<br>
    &nbsp;&nbsp;&nbsp; ' as the correct syntax.<br>
    <br>
    &nbsp;&nbsp;&nbsp; ' Some of the more useful ones I've included samples of here:<br>
    &nbsp;&nbsp;&nbsp; 'objCDOMail.Cc = &quot;john@asp101.com;gary@asp101.com&quot;<br>
    &nbsp;&nbsp;&nbsp; 'objCDOMail.Bcc = &quot;john@asp101.com;gary@asp101.com&quot;<br>
    &nbsp;&nbsp;&nbsp; 'objCDOMail.Importance = 1 '(0=Low, 1=Normal, 2=High)<br>
    &nbsp;&nbsp;&nbsp; 'objCDOMail.AttachFile &quot;c:\path\filename.txt&quot;, 
    &quot;filename.txt&quot;<br>
    <br>
    &nbsp;&nbsp;&nbsp; ' Send the message!<br>
    &nbsp;&nbsp;&nbsp; objCDOMail.Send<br>
    &nbsp;&nbsp;&nbsp; <br>
    &nbsp;&nbsp;&nbsp; ' Set the object to nothing because it immediately becomes<br>
    &nbsp;&nbsp;&nbsp; ' invalid after calling the Send method.<br>
    &nbsp;&nbsp;&nbsp; Set objCDOMail = Nothing<br>
    <br>
    &nbsp;&nbsp;&nbsp; Response.Write &quot;Message sent to &quot; &amp; strTo &amp; 
    &quot;!&quot;<br>
    End If<br>
    %&gt;<br>
    </td>
  </tr>
</table>
</center></div>

<p>　</p>
</body>
</html>
